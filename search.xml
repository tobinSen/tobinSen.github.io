<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Apache-codec</title>
    <url>/2021/05/11/Apache-codec/</url>
    <content><![CDATA[<p>简介：用于操作编码集工具类</p>
<img src="/2021/05/11/Apache-codec/Apache-codec.png" style="zoom: 50%;">

<a id="more"></a>

<h3 id="DigestUtils"><a href="#DigestUtils" class="headerlink" title="DigestUtils"></a>DigestUtils</h3><p>用于操作十六进制编码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">assertEquals(<span class="string">&quot;32ec01ec4a6dac72c0ab96fb34c0b5d1&quot;</span>, DigestUtils.md2Hex(<span class="string">&quot;a&quot;</span>));/</span><br></pre></td></tr></table></figure>

<h3 id="Base64"><a href="#Base64" class="headerlink" title="Base64"></a>Base64</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">final</span> String content = <span class="string">&quot;Hello World&quot;</span>;</span><br><span class="line">String encodedContent;</span><br><span class="line"><span class="keyword">byte</span>[] encodedBytes = Base64.encodeBase64(StringUtils.getBytesUtf8(content));</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>apache-common</category>
      </categories>
      <tags>
        <tag>apache-common-codec</tag>
      </tags>
  </entry>
  <entry>
    <title>Apache-io</title>
    <url>/2021/05/11/Apache-io/</url>
    <content><![CDATA[<p>简介：apache-common-io 提供了很多用于用于IO文件流方面的操作</p>
<img src="/2021/05/11/Apache-io/Apache-io.png" style="zoom: 50%;">

<a id="more"></a>

<h3 id="FilenameUtils"><a href="#FilenameUtils" class="headerlink" title="FilenameUtils"></a>FilenameUtils</h3><p>用于文件的操作</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">org.apache.commons.io.FilenameUtils#isSystemWindows() // 是否是window系统(根据分隔符进行判断的)</span><br><span class="line">org.apache.commons.io.FilenameUtils#normalize(java.lang.String) // 输出一个标准化路径</span><br><span class="line">org.apache.commons.io.FilenameUtils#normalizeNoEndSeparator(java.lang.String) // 输出一个标准化的路径，尾部的斜杠会被删除</span><br><span class="line">org.apache.commons.io.FilenameUtils#concat(String,String) // 将路径和文件名进行拼接</span><br><span class="line">org.apache.commons.io.FilenameUtils#directoryContains(String,String) // 父目录是否包含子目录</span><br><span class="line">org.apache.commons.io.FilenameUtils#separatorsToUnix(String)    // 将所有的分隔符转换为unix的</span><br><span class="line">org.apache.commons.io.FilenameUtils#separatorsToWindows(String) // 将所有的分隔符转换为window的</span><br><span class="line">org.apache.commons.io.FilenameUtils#separatorsToSystem(String)  // 分隔符自适应系统转换</span><br><span class="line">org.apache.commons.io.FilenameUtils#indexOfLastSeparator(String) // 返回文件最后一个分隔符的位置</span><br><span class="line">org.apache.commons.io.FilenameUtils#getPrefix(String)            // 获取文件的前缀路径，指的是最前面的路径</span><br><span class="line">org.apache.commons.io.FilenameUtils#getPath(String)              // 获取文件路径</span><br><span class="line">org.apache.commons.io.FilenameUtils#getFullPath(String)          // 获取文件全路径位置</span><br><span class="line">org.apache.commons.io.FilenameUtils#getFullPathNoEndSeparator(String)   // 获取文件全路径位置不带最后的分隔符</span><br><span class="line">org.apache.commons.io.FilenameUtils#getName()                    // 返回文件名</span><br><span class="line">org.apache.commons.io.FilenameUtils#getBaseName()                // 返回文件名不含后缀</span><br><span class="line">org.apache.commons.io.FilenameUtils#getExtension()               // 返回扩展名</span><br><span class="line">org.apache.commons.io.FilenameUtils#removeExtension()            // 删除后缀名</span><br><span class="line">org.apache.commons.io.FilenameUtils#equalsOnSystem(String,String) // 判断两个文件是否都在同一个系统里</span><br><span class="line">org.apache.commons.io.FilenameUtils#isExtension(java.lang.String, java.lang.String)   // 判断文件后缀</span><br><span class="line">org.apache.commons.io.FilenameUtils#wildcardMatch(java.lang.String, java.lang.String) // 文件通配符比较</span><br></pre></td></tr></table></figure>

<h3 id="FileUtils"><a href="#FileUtils" class="headerlink" title="FileUtils"></a>FileUtils</h3><p>用于文件间操作</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">org.apache.commons.io.FileUtils#byteCountToDisplaySize(java.math.BigInteger)    // 返回一个人类可读的大小</span><br><span class="line">org.apache.commons.io.FileUtils#checksumCRC32(String)       // 使用CRC32校验和例程计算文件的校验和返回校验码值</span><br><span class="line">org.apache.commons.io.FileUtils#cleanDirectory(String)      // 清理目录下的文件，但删除目录</span><br><span class="line">org.apache.commons.io.FileUtils#cleanDirectoryOnExit(String) // 在JVM退出时清空目录</span><br><span class="line">org.apache.commons.io.FileUtils#contentEquals(String,String) // 比较两个文件内容是否一致</span><br><span class="line">org.apache.commons.io.FileUtils#convertFileCollectionToFileArray(Collection) // 将多个文件转换为文件对象</span><br><span class="line">org.apache.commons.io.FileUtils#copyDirectory(java.io.File, java.io.File)    // 文件路径之间进行拷贝</span><br><span class="line">org.apache.commons.io.FileUtils#copyFile(java.io.File, java.io.File)    // 文件间拷贝</span><br><span class="line">org.apache.commons.io.FileUtils#copyFileToDirectory(java.io.File, java.io.File) // 文件拷贝到某个目录下</span><br><span class="line">org.apache.commons.io.FileUtils#copyInputStreamToFile(InputStream,File) // 流转为文件</span><br><span class="line">org.apache.commons.io.FileUtils#copyToFile(InputStream,File) // 流转为文件</span><br><span class="line"></span><br><span class="line">org.apache.commons.io.FileUtils#createParentDirectories(File)  // 创建文件包含父目录</span><br><span class="line">org.apache.commons.io.FileUtils#delete(File)                   // 删除文件</span><br><span class="line">org.apache.commons.io.FileUtils#deleteDirectory(File)          // 删除目录</span><br><span class="line">org.apache.commons.io.FileUtils#deleteQuietly(File)            // 静默删除</span><br><span class="line">org.apache.commons.io.FileUtils#directoryContains(File,File)   // 父目录包含子目录</span><br><span class="line"></span><br><span class="line">org.apache.commons.io.FileUtils#forceDelete(File)              // 强制删除文件</span><br><span class="line">org.apache.commons.io.FileUtils#forceMkdir(File)               // 强制创建目录</span><br><span class="line"></span><br><span class="line">org.apache.commons.io.FileUtils#getFile(java.lang.String...)   // 得到file对象</span><br><span class="line">org.apache.commons.io.FileUtils#isDirectory(File)              // 判断是否是目录</span><br><span class="line"></span><br><span class="line">org.apache.commons.io.FileUtils#iterateFiles(java.io.File, org.apache.commons.io.filefilter.IOFileFilter, org.apache.commons.io.filefilter.IOFileFilter) // 遍历文件</span><br><span class="line">org.apache.commons.io.FileUtils#lastModified(File)   // 获取文件最后修改时间 </span><br><span class="line">org.apache.commons.io.FileUtils#listFiles(java.io.File, java.io.FileFilter)  // 获取所有文件</span><br><span class="line"></span><br><span class="line">org.apache.commons.io.FileUtils#moveDirectory()                // 移动目录</span><br><span class="line">org.apache.commons.io.FileUtils#moveFile(java.io.File, java.io.File) // 移动文件</span><br><span class="line">org.apache.commons.io.FileUtils#readFileToByteArray(File)      // 将文件转换为二进制流</span><br><span class="line">org.apache.commons.io.FileUtils#writeLines(java.io.File, java.util.Collection&lt;?&gt;) // 向文件中进行写操作          </span><br><span class="line"> </span><br></pre></td></tr></table></figure>

<h3 id="IOUtils"><a href="#IOUtils" class="headerlink" title="IOUtils"></a>IOUtils</h3><p>io流之间操作</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">org.apache.commons.io.IOUtils#buffer(java.io.InputStream)     // 字节流转换为缓存流</span><br><span class="line">org.apache.commons.io.IOUtils#close(java.io.Closeable...)     // 关闭流</span><br><span class="line">org.apache.commons.io.IOUtils#closeQuietly(java.io.Closeable...) // 安静的关闭流，如果有异常不会抛出</span><br><span class="line">org.apache.commons.io.IOUtils#contentEquals(java.io.InputStream, java.io.InputStream) // 比较两个流的内容是否一致</span><br><span class="line">org.apache.commons.io.IOUtils#contentEqualsIgnoreEOL(String,String) // 忽略EOL结束符，比较两个文件内容是否一致</span><br><span class="line">org.apache.commons.io.IOUtils#copy(java.io.InputStream, java.io.OutputStream) // 文件流之间的拷贝</span><br><span class="line">org.apache.commons.io.IOUtils#copy(java.net.URL, java.io.File) // 将url链接拷贝到文件里</span><br><span class="line">org.apache.commons.io.IOUtils#lineIterator(java.io.InputStream, java.nio.charset.Charset) // 使用行迭代器</span><br><span class="line">org.apache.commons.io.IOUtils#read(java.io.InputStream, byte[])   // 用于读取文件</span><br><span class="line">org.apache.commons.io.IOUtils#readFully(java.io.InputStream, int) // 全部读完</span><br><span class="line">org.apache.commons.io.IOUtils#readLines(java.io.InputStream, java.nio.charset.Charset) // 一行一行的进行读取</span><br><span class="line">org.apache.commons.io.IOUtils#resourceToByteArray(java.lang.String) // 读取类路径的文件信息为一个二进制</span><br><span class="line">org.apache.commons.io.IOUtils#resourceToString(java.lang.String, java.nio.charset.Charset) // 将classpathc资源转换为字符串</span><br><span class="line"></span><br><span class="line">org.apache.commons.io.IOUtils#toBufferedInputStream(java.io.InputStream) // inputStream转换为 ByteArrayOutputStream</span><br><span class="line">org.apache.commons.io.IOUtils#toByteArray(java.io.InputStream)           // 流转为二进制流</span><br><span class="line">org.apache.commons.io.IOUtils#writeLines(java.util.Collection&lt;?&gt;, java.lang.String, java.io.OutputStream, java.nio.charset.Charset) // 写一行</span><br></pre></td></tr></table></figure>

<h3 id="PathUtils"><a href="#PathUtils" class="headerlink" title="PathUtils"></a>PathUtils</h3><p>用于操作path对象</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">org.apache.commons.io.file.PathUtils#cleanDirectory(java.nio.file.Path)      // 清理目录</span><br><span class="line">org.apache.commons.io.file.PathUtils#copyDirectory(Path,Path)                // 复制目录</span><br><span class="line">org.apache.commons.io.file.PathUtils#copyFile(File)                          // 复制文件</span><br><span class="line">org.apache.commons.io.file.PathUtils#setReadOnly()                           // 设置为只读</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>apache-common</category>
      </categories>
      <tags>
        <tag>apache-common-io</tag>
      </tags>
  </entry>
  <entry>
    <title>Apache-math</title>
    <url>/2021/05/11/Apache-math/</url>
    <content><![CDATA[<p>简介：apache-common-math是用来操作数字方面的工具类</p>
<img src="/2021/05/11/Apache-math/Apache-math.png" style="zoom: 50%;">

<a id="more"></a>

<h3 id="ArithmeticUtils"><a href="#ArithmeticUtils" class="headerlink" title="ArithmeticUtils"></a>ArithmeticUtils</h3><p>用于算术的运算</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">org.apache.commons.math3.util.ArithmeticUtils#addAndCheck(int, int)       // 检查并做加法</span><br><span class="line">org.apache.commons.math3.util.ArithmeticUtils#addAndCheck(long, long)     // 检查并做加法</span><br><span class="line">org.apache.commons.math3.util.ArithmeticUtils#gcd(int, int)               // 求两个数的最大公约数</span><br><span class="line">org.apache.commons.math3.util.ArithmeticUtils#lcm(int, int)               // 求两个数的最小公倍数</span><br><span class="line">org.apache.commons.math3.util.ArithmeticUtils#mulAndCheck(int, int)       // 两数向乘</span><br><span class="line">org.apache.commons.math3.util.ArithmeticUtils#subAndCheck(int, int)       // 两数向减</span><br><span class="line">org.apache.commons.math3.util.ArithmeticUtils#pow(int, int)               // 计算次幂</span><br><span class="line">org.apache.commons.math3.util.ArithmeticUtils#isPowerOfTwo(long)          // 是否是2的次幂</span><br></pre></td></tr></table></figure>

<h3 id="BigReal"><a href="#BigReal" class="headerlink" title="BigReal"></a>BigReal</h3><p>用于操作BigDecimal的工具</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">org.apache.commons.math3.util.BigReal#BigReal(java.math.BigDecimal)     // 构建bigReal</span><br><span class="line">org.apache.commons.math3.util.BigReal#add(BigReal)                      // 相加</span><br></pre></td></tr></table></figure>

<h3 id="MathUtils"><a href="#MathUtils" class="headerlink" title="MathUtils"></a>MathUtils</h3><p>用于操作数字</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">org.apache.commons.math3.util.MathUtils#hash(double)          // 计算hash值</span><br><span class="line">org.apache.commons.math3.util.MathUtils#max(int,int)          // 比较最大值</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>apache-common</category>
      </categories>
      <tags>
        <tag>apache-common-math</tag>
      </tags>
  </entry>
  <entry>
    <title>reflect</title>
    <url>/2021/09/04/Reflect/</url>
    <content><![CDATA[<h1 id="Reflect"><a href="#Reflect" class="headerlink" title="Reflect"></a>Reflect</h1><p>定义：反射就是Reflection，Java的反射是指程序在运行期可以拿到一个对象的所有信息。</p>
<img src="/2021/09/04/Reflect/Reflect.png" style="zoom: 50%;">

<a id="more"></a>

<h2 id="Class类"><a href="#Class类" class="headerlink" title="Class类"></a>Class类</h2><p>class是由JVM在执行过程中动态加载的。JVM在第一次读取到一种class类型时，将其加载进内存。每加载一种class，JVM就为其创建一个Class类型的实例，并关联起来。注意：这里的Class类型是一个名叫Class的class</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">Class</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Class</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>以String类为例，当JVM加载String类时，它首先读取String.class文件到内存，然后，为String类创建一个Class实例并关联起来</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Class cls = <span class="keyword">new</span> Class(String);</span><br></pre></td></tr></table></figure>

<p>这个Class实例是JVM内部创建的，如果我们查看JDK源码，可以发现Class类的构造方法是private，只有JVM能创建Class实例，我们自己的Java程序是无法创建Class实例的</p>
<p>由于JVM为每个加载的class创建了对应的Class实例，并在实例中保存了该class的所有信息，包括类名、包名、父类、实现的接口、所有方法、字段等，因此，如果获取了某个Class实例，我们就可以通过这个Class实例获取到该实例对应的class的所有信息.</p>
<p>这种通过Class实例获取class信息的方法称为反射（Reflection）</p>
<p>如何获取一个class的Class实例？有三个方法：</p>
<p>方法一：直接通过一个class的静态变量class获取：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Class cls = String.class;</span><br></pre></td></tr></table></figure>

<p>方法二：如果我们有一个实例变量，可以通过该实例变量提供的getClass()方法获取：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">String s = <span class="string">&quot;Hello&quot;</span>;</span><br><span class="line">Class cls = s.getClass();</span><br></pre></td></tr></table></figure>

<p>方法三：如果知道一个class的完整类名，可以通过静态方法Class.forName()获取：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Class cls = Class.forName(<span class="string">&quot;java.lang.String&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>因为Class实例在JVM中是<strong>唯一的</strong>，所以，上述方法获取的Class实例是同一个实例。可以用==比较两个Class实例</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Class cls1 = String.class;</span><br><span class="line"></span><br><span class="line">String s = <span class="string">&quot;Hello&quot;</span>;</span><br><span class="line">Class cls2 = s.getClass();</span><br><span class="line"></span><br><span class="line"><span class="keyword">boolean</span> sameClass = cls1 == cls2; <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<p>注意一下Class实例比较和instanceof的差别：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Integer n = <span class="keyword">new</span> Integer(<span class="number">123</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">boolean</span> b1 = n <span class="keyword">instanceof</span> Integer; <span class="comment">// true，因为n是Integer类型</span></span><br><span class="line"><span class="keyword">boolean</span> b2 = n <span class="keyword">instanceof</span> Number; <span class="comment">// true，因为n是Number类型的子类</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">boolean</span> b3 = n.getClass() == Integer.class; <span class="comment">// true，因为n.getClass()返回Integer.class</span></span><br><span class="line"><span class="keyword">boolean</span> b4 = n.getClass() == Number.class; <span class="comment">// false，因为Integer.class!=Number.class</span></span><br></pre></td></tr></table></figure>

<p>用instanceof不但匹配指定类型，还匹配指定类型的子类。而用==判断class实例可以精确地判断数据类型，但不能作子类型比较<br>判断class实例的使用使用 == 精确判断</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    printClassInfo(<span class="string">&quot;&quot;</span>.getClass());</span><br><span class="line">    printClassInfo(Runnable.class);</span><br><span class="line">    printClassInfo(java.time.Month.class);</span><br><span class="line">    printClassInfo(String[].class);            <span class="comment">// [Ljava.lang.String</span></span><br><span class="line">    printClassInfo(<span class="keyword">int</span>.class);                 <span class="comment">// int  (JVM为每一种基本类型如int也创建了Class)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="动态加载"><a href="#动态加载" class="headerlink" title="动态加载"></a>动态加载</h2><p>JVM在执行Java程序的时候，并不是一次性把所有用到的class全部加载到内存，而是第一次需要用到class时才加载。</p>
<p>JVM动态加载class的特性</p>
<p>动态加载class的特性对于Java程序非常重要。利用JVM动态加载class的特性，我们才能在运行期根据条件加载不同的实现类。例如，Commons Logging总是优先使用Log4j，只有当Log4j不存在时，才使用JDK的logging。利用JVM动态加载特性，大致的实现代码如下：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Commons Logging优先使用Log4j:</span></span><br><span class="line">LogFactory factory = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (isClassPresent(<span class="string">&quot;org.apache.logging.log4j.Logger&quot;</span>)) &#123;</span><br><span class="line">    factory = createLog4j();</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    factory = createJdkLog();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">isClassPresent</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        Class.forName(name);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这就是为什么我们只需要把Log4j的jar包放到classpath中，Commons Logging就会自动使用Log4j的原因.</p>
<h2 id="构造方法"><a href="#构造方法" class="headerlink" title="构造方法"></a>构造方法</h2><p>如果通过反射来创建新的实例，可以调用Class提供的newInstance()方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Person p = Person.class.newInstance();</span><br></pre></td></tr></table></figure>

<p>调用Class.newInstance()的局限是，它只能调用该类的public无参数构造方法。如果构造方法带有参数，或者不是public，就无法直接通过Class.newInstance()来调用</p>
<p>为了调用任意的构造方法，Java的反射API提供了Constructor对象，它包含一个构造方法的所有信息，可以创建一个实例</p>
<p>通过Class实例获取Constructor的方法如下：</p>
<ul>
<li><code>getConstructor(Class...)</code>：获取某个<code>public</code>的<code>Constructor</code>；</li>
<li><code>getDeclaredConstructor(Class...)</code>：获取某个<code>Constructor</code>；</li>
<li><code>getConstructors()</code>：获取所有<code>public</code>的<code>Constructor</code>；</li>
<li><code>getDeclaredConstructors()</code>：获取所有<code>Constructor</code>。</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 获取构造方法Integer(int):</span></span><br><span class="line">Constructor cons1 = Integer.class.getConstructor(<span class="keyword">int</span>.class);</span><br><span class="line"><span class="comment">// 调用构造方法:</span></span><br><span class="line">Integer n1 = (Integer) cons1.newInstance(<span class="number">123</span>);</span><br><span class="line">System.out.println(n1);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取构造方法Integer(String)</span></span><br><span class="line">Constructor cons2 = Integer.class.getConstructor(String.class);</span><br><span class="line">Integer n2 = (Integer) cons2.newInstance(<span class="string">&quot;456&quot;</span>);</span><br><span class="line">System.out.println(n2);</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Constructor&lt;?&gt;[] constructors = c.getConstructors();</span><br><span class="line">Constructor&lt;?&gt;[] declaredConstructors = c.getDeclaredConstructors();</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * javassist.ReflectDemo$Student</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">for</span> (Constructor&lt;?&gt; constructor : constructors) &#123;</span><br><span class="line">    System.out.println(constructor.getName());</span><br><span class="line">&#125;</span><br><span class="line">System.out.println(<span class="string">&quot;===================&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * javassist.ReflectDemo$Student</span></span><br><span class="line"><span class="comment"> * javassist.ReflectDemo$Student</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">for</span> (Constructor&lt;?&gt; constructor : declaredConstructors) &#123;</span><br><span class="line">    System.out.println(constructor.getName());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="访问字段"><a href="#访问字段" class="headerlink" title="访问字段"></a>访问字段</h2><p>对任意的一个Object实例，只要我们获取了它的Class，就可以获取它的一切信息</p>
<p>我们先看看如何通过<code>Class</code>实例获取字段信息。<code>Class</code>类提供了以下几个方法来获取字段：</p>
<ul>
<li>Field getField(name)：根据字段名获取某个public的field（包括父类）</li>
<li>Field getDeclaredField(name)：根据字段名获取当前类的某个field（不包括父类）</li>
<li>Field[] getFields()：获取所有public的field（包括父类）</li>
<li>Field[] getDeclaredFields()：获取当前类的所有field（不包括父类）</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">        Class&lt;Student&gt; c = Student.class;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * public_sub_score</span></span><br><span class="line"><span class="comment">         * public_parent_name</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">for</span> (Field field : c.getFields()) &#123;</span><br><span class="line">            System.out.println(field.getName());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;===================&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * private_sub_score</span></span><br><span class="line"><span class="comment">         * default_sub_score</span></span><br><span class="line"><span class="comment">         * protected_sub_score</span></span><br><span class="line"><span class="comment">         * public_sub_score</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">for</span> (Field field : c.getDeclaredFields()) &#123;</span><br><span class="line">            System.out.println(field.getName());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> String private_parent_name;</span><br><span class="line">        String default_parent_name;</span><br><span class="line">        <span class="keyword">protected</span> String protected_parent_naem;</span><br><span class="line">        <span class="keyword">public</span> String public_parent_name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> <span class="keyword">extends</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> private_sub_score;</span><br><span class="line">        <span class="keyword">int</span> default_sub_score;</span><br><span class="line">        <span class="keyword">protected</span> <span class="keyword">int</span> protected_sub_score;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">int</span> public_sub_score;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>Main类无法访问Person类的private字段。要修复错误，可以将private改为public，或者，在调用Object value = f.get(p);前，先写一句：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">f.setAccessible(<span class="keyword">true</span>);</span><br></pre></td></tr></table></figure>

<p>此外，setAccessible(true)可能会失败。如果JVM运行期存在SecurityManager，那么它会根据规则进行检查，有可能阻止setAccessible(true)。例如，某个SecurityManager可能不允许对java和javax开头的package的类调用setAccessible(true)，这样可以保证JVM核心库的安全。</p>
<p>修改非public字段，需要首先调用<code>setAccessible(true)</code></p>
<h2 id="调用方法"><a href="#调用方法" class="headerlink" title="调用方法"></a>调用方法</h2><p>我们已经能通过<code>Class</code>实例获取所有<code>Field</code>对象，同样的，可以通过<code>Class</code>实例获取所有<code>Method</code>信息。<code>Class</code>类提供了以下几个方法来获取<code>Method</code>：</p>
<ul>
<li><code>Method getMethod(name, Class...)</code>：获取某个<code>public</code>的<code>Method</code>（包括父类）</li>
<li><code>Method getDeclaredMethod(name, Class...)</code>：获取当前类的某个<code>Method</code>（不包括父类）</li>
<li><code>Method[] getMethods()</code>：获取所有<code>public</code>的<code>Method</code>（包括父类）</li>
<li><code>Method[] getDeclaredMethods()</code>：获取当前类的所有<code>Method</code>（不包括父类）</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Method[] methods = c.getMethods();</span><br><span class="line">Method[] declaredMethods = c.getDeclaredMethods();</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * getPublic_sub_score</span></span><br><span class="line"><span class="comment"> * getPublic_parent_name</span></span><br><span class="line"><span class="comment"> * wait</span></span><br><span class="line"><span class="comment"> * wait</span></span><br><span class="line"><span class="comment"> * wait</span></span><br><span class="line"><span class="comment"> * equals</span></span><br><span class="line"><span class="comment"> * toString</span></span><br><span class="line"><span class="comment"> * hashCode</span></span><br><span class="line"><span class="comment"> * getClass</span></span><br><span class="line"><span class="comment"> * notify</span></span><br><span class="line"><span class="comment"> * notifyAll</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">for</span> (Method method : methods) &#123;</span><br><span class="line">    System.out.println(method.getName());</span><br><span class="line">&#125;</span><br><span class="line">System.out.println(<span class="string">&quot;===================&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * getPrivate_sub_score</span></span><br><span class="line"><span class="comment"> * getProtected_sub_score</span></span><br><span class="line"><span class="comment"> * getPublic_sub_score</span></span><br><span class="line"><span class="comment"> * getDefault_sub_score</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">for</span> (Method method : declaredMethods) &#123;</span><br><span class="line">    System.out.println(method.getName());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>当我们获取到一个Method对象时，就可以对它进行调用</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// String对象:</span></span><br><span class="line">String s = <span class="string">&quot;Hello world&quot;</span>;</span><br><span class="line"><span class="comment">// 获取String substring(int)方法，参数为int:</span></span><br><span class="line">Method m = String.class.getMethod(<span class="string">&quot;substring&quot;</span>, <span class="keyword">int</span>.class);</span><br><span class="line"><span class="comment">// 在s对象上调用该方法并获取结果:</span></span><br><span class="line">String r = (String) m.invoke(s, <span class="number">6</span>);</span><br><span class="line"><span class="comment">// 打印调用结果:</span></span><br><span class="line">System.out.println(r);</span><br></pre></td></tr></table></figure>

<p>调用静态方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 获取Integer.parseInt(String)方法，参数为String:</span></span><br><span class="line">Method m = Integer.class.getMethod(<span class="string">&quot;parseInt&quot;</span>, String.class);</span><br><span class="line"><span class="comment">// 调用该静态方法并获取结果:</span></span><br><span class="line">Integer n = (Integer) m.invoke(<span class="keyword">null</span>, <span class="string">&quot;12345&quot;</span>);</span><br><span class="line"><span class="comment">// 打印调用结果:</span></span><br><span class="line">System.out.println(n);</span><br></pre></td></tr></table></figure>

<p>调用非public方法</p>
<p>和Field类似，对于非public方法，我们虽然可以通过Class.getDeclaredMethod()获取该方法实例，但直接对其调用将得到一个IllegalAccessException。为了调用非public方法，我们通过Method.setAccessible(true)允许其调用</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Person p = <span class="keyword">new</span> Person();</span><br><span class="line">Method m = p.getClass().getDeclaredMethod(<span class="string">&quot;setName&quot;</span>, String.class);</span><br><span class="line">m.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">m.invoke(p, <span class="string">&quot;Bob&quot;</span>);</span><br><span class="line">System.out.println(p.name);</span><br></pre></td></tr></table></figure>

<p>此外，setAccessible(true)可能会失败。如果JVM运行期存在SecurityManager，那么它会根据规则进行检查，有可能阻止setAccessible(true)。例如，某个SecurityManager可能不允许对java和javax开头的package的类调用setAccessible(true)，这样可以保证JVM核心库的安全</p>
<p>多态</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">// 获取Person的hello方法:</span></span><br><span class="line">        Method h = Person.class.getMethod(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">        <span class="comment">// 对Student实例调用hello方法:</span></span><br><span class="line">        h.invoke(<span class="keyword">new</span> Student());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">hello</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Person:hello&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> <span class="keyword">extends</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">hello</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Student:hello&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="继承关系"><a href="#继承关系" class="headerlink" title="继承关系"></a>继承关系</h2><p>获取父类的Class</p>
<p>有了Class实例，我们还可以获取它的父类的Class：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    Class i = Integer.class;</span><br><span class="line">    Class n = i.getSuperclass();</span><br><span class="line">    System.out.println(n);</span><br><span class="line">    Class o = n.getSuperclass();</span><br><span class="line">    System.out.println(o);</span><br><span class="line">    System.out.println(o.getSuperclass());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>获取interface</p>
<p>由于一个类可能实现一个或多个接口，通过Class我们就可以查询到实现的接口类型。例如，查询Integer实现的接口：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    Class s = Integer.class;</span><br><span class="line">    Class[] is = s.getInterfaces();</span><br><span class="line">    <span class="keyword">for</span> (Class i : is) &#123;</span><br><span class="line">        System.out.println(i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通过<code>Class</code>对象可以获取继承关系：</p>
<ul>
<li><code>Class getSuperclass()</code>：获取父类类型；</li>
<li><code>Class[] getInterfaces()</code>：获取当前类实现的所有接口。</li>
</ul>
<p>通过<code>Class</code>对象的<code>isAssignableFrom()</code>方法可以判断一个向上转型是否可以实现</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Integer i = ?</span></span><br><span class="line">Integer.class.isAssignableFrom(Integer.class); <span class="comment">// true，因为Integer可以赋值给Integer</span></span><br><span class="line"><span class="comment">// Number n = ?</span></span><br><span class="line">Number.class.isAssignableFrom(Integer.class); <span class="comment">// true，因为Integer可以赋值给Number</span></span><br><span class="line"><span class="comment">// Object o = ?</span></span><br><span class="line">Object.class.isAssignableFrom(Integer.class); <span class="comment">// true，因为Integer可以赋值给Object</span></span><br><span class="line"><span class="comment">// Integer i = ?</span></span><br><span class="line">Integer.class.isAssignableFrom(Number.class); <span class="comment">// false，因为Number不能赋值给Integer</span></span><br></pre></td></tr></table></figure>

<h2 id="class常用方法"><a href="#class常用方法" class="headerlink" title="class常用方法"></a>class常用方法</h2><h3 id="强制类型转换asSubclass和cast"><a href="#强制类型转换asSubclass和cast" class="headerlink" title="强制类型转换asSubclass和cast"></a>强制类型转换<code>asSubclass</code>和<code>cast</code></h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">B</span> <span class="keyword">extends</span> <span class="title">A</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">A a = <span class="keyword">new</span> A();</span><br><span class="line">B b = <span class="keyword">new</span> B();</span><br><span class="line">a = A.class.cast(b);         <span class="comment">// a = A.class.cast(b); 把a转化为了B类型</span></span><br><span class="line"></span><br><span class="line">Class&lt;? extends A&gt; asSubclass = b.getClass().asSubclass(A.class);    <span class="comment">// 将B作为A的子类</span></span><br></pre></td></tr></table></figure>

<h3 id="注解"><a href="#注解" class="headerlink" title="注解"></a>注解</h3><ul>
<li>getAnnotatedInterfaces()： 获取所有接口的注解</li>
<li>getAnnotatedSuperclass()：获取所有父类的注解</li>
<li>getAnnotation(Class<A> annotationClass)：获取指定的注解，该注解可以是自己声明的，也可以是继承的</A></li>
<li>getAnnotations()：获取所有的注解，包括自己声明的以及继承的</li>
<li>getAnnotationsByType(Class<A> annotationClass)：获取指定类型的注解，包括自己声明的以及继承的</A></li>
<li>getDeclaredAnnotation(Class<A> annotationClass)：获取<strong>自己声明</strong>的指定类型注解</A></li>
<li>getDeclaredAnnotations()：返回直接存在于该元素上的注释。</li>
<li>getDeclaredAnnotationsByType(Class<A> annotationClass)</A></li>
<li>getDeclaredClasses()</li>
</ul>
<h3 id="类型判断"><a href="#类型判断" class="headerlink" title="类型判断"></a>类型判断</h3><p>instanceof、isInstance、isAssignableFrom</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//instanceof</span></span><br><span class="line">String str = <span class="keyword">new</span> String(<span class="string">&quot;测试&quot;</span>);</span><br><span class="line">System.out.println(str <span class="keyword">instanceof</span> String);      <span class="comment">// 实例对象是否是这个类型或类型的子类</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//isIntance</span></span><br><span class="line">String str = <span class="keyword">new</span> String(<span class="string">&quot;测试&quot;</span>);</span><br><span class="line">System.out.println(String.class.isInstance(str));  <span class="comment">// str实例是否是String.class的类型或类型子类</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//isAssignableFrom</span></span><br><span class="line">System.out.println(Object.class.isAssignableFrom(String.class)); <span class="comment">// String.class是Object.class类型或类型的子类</span></span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>reflect</category>
      </categories>
      <tags>
        <tag>reflect</tag>
      </tags>
  </entry>
  <entry>
    <title>bytebuddy</title>
    <url>/2021/09/05/byteBuddy/</url>
    <content><![CDATA[<h1 id="ByteBuddy"><a href="#ByteBuddy" class="headerlink" title="ByteBuddy"></a>ByteBuddy</h1><p>简介：ByteBuddy是一个可以在运行时动态生成java class的类库</p>
<img src="/2021/09/05/byteBuddy/bytebuddy.png" style="zoom: 50%;">

<a id="more"></a>

<h2 id="引入依赖"><a href="#引入依赖" class="headerlink" title="引入依赖"></a>引入依赖</h2><figure class="highlight"><table><tr><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;net.bytebuddy&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;byte-buddy&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;1.7.1&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<h2 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Class&lt;?&gt; dynamicType &#x3D; new ByteBuddy()</span><br><span class="line">        &#x2F;&#x2F; 指定父类</span><br><span class="line">        .subclass(Object.class)</span><br><span class="line">        &#x2F;&#x2F; 根据名称来匹配需要拦截的方法</span><br><span class="line">        .method(ElementMatchers.named(&quot;toString&quot;))</span><br><span class="line">        &#x2F;&#x2F; 拦截方法调用，返回固定值</span><br><span class="line">        .intercept(FixedValue.value(&quot;Hello World!&quot;))</span><br><span class="line">        &#x2F;&#x2F; 产生字节码</span><br><span class="line">        .make()</span><br><span class="line">        &#x2F;&#x2F; 加载类</span><br><span class="line">        .load(BytebuddyDemo.class.getClassLoader())</span><br><span class="line">        &#x2F;&#x2F; 获得Class对象</span><br><span class="line">        .getLoaded();</span><br></pre></td></tr></table></figure>

<h2 id="核心方法"><a href="#核心方法" class="headerlink" title="核心方法"></a>核心方法</h2><h3 id="subclass"><a href="#subclass" class="headerlink" title="subclass"></a>subclass</h3><p>基于clazz来创建一个子类</p>
<h3 id="makeInterface"><a href="#makeInterface" class="headerlink" title="makeInterface"></a>makeInterface</h3><p>创建一个接口</p>
<h3 id="makePackage"><a href="#makePackage" class="headerlink" title="makePackage"></a>makePackage</h3><p>创建一个包路径</p>
<h3 id="makeAnnotation"><a href="#makeAnnotation" class="headerlink" title="makeAnnotation"></a>makeAnnotation</h3><p>创建一个注解</p>
<h3 id="makeEnumeration"><a href="#makeEnumeration" class="headerlink" title="makeEnumeration"></a>makeEnumeration</h3><p>创建一个枚举</p>
<h3 id="redefine"><a href="#redefine" class="headerlink" title="redefine"></a>redefine</h3><p>重新定义一个class类(修改目标类的区域，覆盖式，原先的类的区域会丢失)</p>
<h3 id="rebase"><a href="#rebase" class="headerlink" title="rebase"></a>rebase</h3><p>同redefine的作用。但是他会先将原先的父方法进行名称的修改。新的方法替换掉原先的方法，在内部对原先的方法进行一次调用</p>
<h3 id="with"><a href="#with" class="headerlink" title="with"></a>with</h3><p>所有的类文件都会应用到这个配置</p>
<h3 id="ignore"><a href="#ignore" class="headerlink" title="ignore"></a>ignore</h3><p>忽略掉一些方法匹配</p>
<h2 id="Builder常见方法"><a href="#Builder常见方法" class="headerlink" title="Builder常见方法"></a>Builder常见方法</h2><p>name：创建一个类名、接口名、枚举名、注解名</p>
<p>modifiers: 标识类、接口修饰符Opcodes.ACC_PUBLIC</p>
<p>annotateType：标识注解类型</p>
<p>implement：实现接口</p>
<p>typeVariable：定义一个类型变量</p>
<p>transform：进行类型变量的转换</p>
<p>defineField：定义一个字段</p>
<p>defineMethod：定义方法</p>
<p>defineConstructor：定义构造器</p>
<p>define：重新定义</p>
<p>method：方法匹配器</p>
<p>constructor：构造方法匹配器</p>
<p>invokable：方法和构造方法匹配器</p>
<p>make：创建这个类型</p>
<h3 id="ElementMatcher"><a href="#ElementMatcher" class="headerlink" title="ElementMatcher"></a>ElementMatcher</h3><p>匹配器</p>
<p>named：匹配元素名称</p>
<p>isMethod：匹配元素是否是方法</p>
<p>案例：</p>
<p>1、匹配类中所有public方法<br>.method(ElementMatchers.isPublic())</p>
<p>2、匹配名称为helloWorld且可见性为public的所有方法<br>.method(ElementMatchers.isPublic().and(ElementMatchers.named(“helloWorld”)))</p>
<p>3、匹配名称为helloWorld且可见性为public但返回值类型不为String的所有方法<br>.method(ElementMatchers.isPublic().and(ElementMatchers.named(“helloWorld”)).and(ElementMatchers.not(ElementMatchers.returns(String.class))))</p>
<p>4、匹配名称为helloWorld且第二个入参为String类型的所有方法<br>.method(ElementMatchers.isPublic().and(ElementMatchers.named(“helloWorld”)).and(ElementMatchers.takesArgument(1, String.class)))</p>
<h3 id="implement方法"><a href="#implement方法" class="headerlink" title="implement方法"></a>implement方法</h3><p>MethodDefinition.ImplementationDefinition.Optional的方法</p>
<p>intercept：拦截</p>
<p>Implementation方法</p>
<p>FixedValue：返回固定的值</p>
<p><strong>MethodDelegation</strong>：将方法委派由其他方法来执行（<strong>委派类中的方法必须和被委派类中的方法保持一致</strong>）</p>
<p>MethodCall：基于方法回调</p>
<p>InvokeDynamic：基于动态回调</p>
<p>DefaultMethodCall：基于默认方法回调</p>
<p>ExceptionMethod：基于异常方法调用</p>
<p>InvocationHandlerAdapter：调用自定义</p>
<p>withoutCode：接口方法为空代码抽象方法</p>
<p>defaultValue：返回一个注解返回值</p>
<p>注解                  说明<br>@Argument           绑定单个参数<br>@AllArguments       绑定所有参数的数组<br>@This               当前被拦截的、动态生成的那个对象<br>@Super              当前被拦截的、动态生成的那个对象的父类对象<br>@Origin             可以绑定到以下类型的参数：</p>
<pre><code>            Method              被调用的原始方法
            Constructor         被调用的原始构造器
            Class               当前动态创建的类
            MethodHandle
            MethodType
            String          动态类的toString()的返回值
            int             动态方法的修饰符</code></pre>
<p>@DefaultCall     调用默认方法而非super的方法<br>@SuperCall       用于调用父类版本的方法<br>@Super           注入父类型对象，可以是接口，从而调用它的任何方法<br>@RuntimeType     可以用在返回值、参数上，提示ByteBuddy禁用严格的类型检查<br>@Empty           注入参数的类型的默认值<br>@StubValue       注入一个存根值。对于返回引用、void的方法，注入null；对于返回原始类型的方法，注入0<br>@FieldValue      注入被拦截对象的一个字段的值<br>@Morph           类似于@SuperCall，但是允许指定调用参数</p>
<h3 id="委派类中使用的常见注解"><a href="#委派类中使用的常见注解" class="headerlink" title="委派类中使用的常见注解"></a>委派类中使用的常见注解</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// @Super 使用了@Super注解的委托类对象，此时这个被注解的入参在进行最似匹配时会被忽略，bytebuddy匹配到的依然是只有一个String入参的委托方法</span></span><br><span class="line"><span class="comment">// @Super 修饰被委派类的实例对象</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DelegateMooWithSuper</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">Moo1</span><span class="params">(String param1, <span class="meta">@Super</span> Moo zuper)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;invoke time:&quot;</span> + System.currentTimeMillis());</span><br><span class="line">        <span class="keyword">return</span> zuper.Moo1(param1);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果不需要修改入参，或者在被委托方法中调用超类其它方法，也可以使用@superCall注解</span></span><br><span class="line"><span class="comment">// 调用callable的call方法可以获取被委托方法的实现结果</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">Moo</span><span class="params">(String param1, Integer param2,</span></span></span><br><span class="line"><span class="function"><span class="params">                             <span class="meta">@SuperCall</span> Callable&lt;String&gt; superCall)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            String superCallResult = superCall.call();</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;wrapped by delegate:&#123;&quot;</span> + superCallResult + <span class="string">&quot;&#125;&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// @FieldValue</span></span><br><span class="line"><span class="comment">// 之后我们就可以通过反射给name注入值了，在后续方法的代理实现中也可以通过@FieldValue注解使用这个原本的类中不存在的属性</span></span><br><span class="line"><span class="comment">// 我们通过DelegateWithField代理原始类的Moo1方法，同时打印出传参和name属性的值</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DelegateWithField</span> </span>&#123;</span><br><span class="line">    String name;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">Moo1</span><span class="params">(String param1, <span class="meta">@FieldValue(value = &quot;name&quot;)</span> String name)</span> <span class="keyword">throws</span> Exception </span>&#123;<span class="keyword">return</span> <span class="string">&quot;parm1:&quot;</span> + param1 + <span class="string">&quot;;name:&quot;</span> + name;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>bytebuddy</category>
      </categories>
      <tags>
        <tag>bytebuddy</tag>
      </tags>
  </entry>
  <entry>
    <title>Guava-base</title>
    <url>/2021/05/13/common-base/</url>
    <content><![CDATA[<p>简介：Guava-base是base包下常用的工具</p>
<img src="/2021/05/13/common-base/common-base.png" style="zoom: 50%;">

<a id="more"></a>

<h3 id="CaseFormat"><a href="#CaseFormat" class="headerlink" title="CaseFormat"></a>CaseFormat</h3><p>用于大写转换</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">assertEquals(<span class="string">&quot;FooBar&quot;</span>, LOWER_HYPHEN.to(UPPER_CAMEL, <span class="string">&quot;foo-bar&quot;</span>));      <span class="comment">// 转换为小写并且字母间用-隔开</span></span><br><span class="line">assertEquals(<span class="string">&quot;FooBar&quot;</span>, LOWER_UNDERSCORE.to(UPPER_CAMEL, <span class="string">&quot;foo_bar&quot;</span>));  <span class="comment">// 转换为小写并且字母间用_隔开</span></span><br></pre></td></tr></table></figure>

<h3 id="CharMatcher"><a href="#CharMatcher" class="headerlink" title="CharMatcher"></a>CharMatcher</h3><p>字符匹配器</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">CharMatcher.DIGIT.retainFrom(str);                    <span class="comment">// 保留数字</span></span><br><span class="line">CharMatcher.JAVA_LETTER.retainFrom(str);              <span class="comment">// 保留字母</span></span><br><span class="line">CharMatcher.JAVA_LETTER_OR_DIGIT.retainFrom(str);     <span class="comment">// 保留数字和字母</span></span><br><span class="line">CharMatcher.whitespace().collapseFrom(tmpStr,<span class="string">&#x27;-&#x27;</span>)     <span class="comment">// 删除空白用-替换</span></span><br><span class="line">CharMatcher.inRange(<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;6&#x27;</span>).retainFrom(tmpStr)       <span class="comment">// 获取指定范围内的字符</span></span><br></pre></td></tr></table></figure>

<h3 id="Charsets"><a href="#Charsets" class="headerlink" title="Charsets"></a>Charsets</h3><p>字符集</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Charset UTF_8 = Charset.forName(<span class="string">&quot;UTF-8&quot;</span>);</span><br></pre></td></tr></table></figure>

<h3 id="Joiner"><a href="#Joiner" class="headerlink" title="Joiner"></a>Joiner</h3><p>用于字符串拼接</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">com.google.common.base.Joiner#on(java.lang.String)       // 基于分隔符构建Joiner</span><br><span class="line">com.google.common.base.Joiner#appendTo(A, java.lang.Iterable&lt;?&gt;)    // 拼接集合元素</span><br><span class="line">com.google.common.base.Joiner#join(java.lang.Iterable&lt;?&gt;) // 集合拼接</span><br><span class="line">com.google.common.base.Joiner#skipNulls(Iterable)         // 跳过为null</span><br><span class="line">com.google.common.base.Joiner#withKeyValueSeparator(char) // 用于拼接map</span><br></pre></td></tr></table></figure>

<h3 id="MoreObjects"><a href="#MoreObjects" class="headerlink" title="MoreObjects"></a>MoreObjects</h3><p>用于对象操作</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">com.google.common.base.MoreObjects#firstNonNull(Obj,Obj)       // 返回第一个不为null的值</span><br></pre></td></tr></table></figure>

<h3 id="Objects"><a href="#Objects" class="headerlink" title="Objects"></a>Objects</h3><p>对象操作</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">com.google.common.base.Objects#equal(T,T)        // 判断两个对象是否相等</span><br></pre></td></tr></table></figure>

<h3 id="Optional"><a href="#Optional" class="headerlink" title="Optional"></a>Optional</h3><p>用于null的操作</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">com.google.common.base.Optional#absent()         // 返回一个空的optional对象</span><br><span class="line">com.google.common.base.Optional#fromNullable(T)  // 构建optional对象</span><br><span class="line">com.google.common.base.Optional#fromJavaUtil(Optional) // 将java中的optional转换为guava包中</span><br><span class="line">com.google.common.base.Optional#toJavaUtil(com.google.common.base.Optional&lt;T&gt;) // 将guava包中的optional转换为java包optional</span><br><span class="line">com.google.common.base.Optional#isPresent()     // 是否为空</span><br><span class="line">com.google.common.base.Optional#get()           // 获取值</span><br><span class="line">com.google.common.base.Optional#or(T)           // 为空就返回默认值，否则返回原值</span><br><span class="line">com.google.common.base.Optional#or(com.google.common.base.Supplier&lt;? extends T&gt;) // 为空就执行supplier</span><br><span class="line">com.google.common.base.Optional#orNull()        // 为空就返回null</span><br><span class="line">com.google.common.base.Optional#asSet()         // 将值作为集合返回</span><br><span class="line">com.google.common.base.Optional#transform()     // 不为空就进行转换</span><br></pre></td></tr></table></figure>

<h3 id="Preconditions"><a href="#Preconditions" class="headerlink" title="Preconditions"></a>Preconditions</h3><p>断言类</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">com.google.common.base.Preconditions#checkArgument(boolean)     // 断言判断</span><br><span class="line">com.google.common.base.Preconditions#checkState(boolean)        // 状态判断</span><br><span class="line">com.google.common.base.Preconditions#checkNotNull(T)            // 值判断</span><br></pre></td></tr></table></figure>

<h3 id="Predicates"><a href="#Predicates" class="headerlink" title="Predicates"></a>Predicates</h3><p>断言类</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">com.google.common.base.Predicates#isNull()      // 是否是空</span><br><span class="line">com.google.common.base.Predicates#not()         // 不为空</span><br><span class="line">com.google.common.base.Predicates#and(java.lang.Iterable&lt;? extends com.google.common.base.Predicate&lt;? super T&gt;&gt;) // 多个断言的判断</span><br><span class="line">com.google.common.base.Predicates#or(java.lang.Iterable&lt;? extends com.google.common.base.Predicate&lt;? super T&gt;&gt;)  // 多个断言或的判断</span><br><span class="line">com.google.common.base.Predicates#equalTo(T)    // 基于equal的判断</span><br><span class="line">com.google.common.base.Predicates#instanceOf(T) // 基于instance实例的判断</span><br><span class="line">com.google.common.base.Predicates#subtypeOf(T)  // 基于子类的判断</span><br><span class="line">com.google.common.base.Predicates#in(Collection) // 是否是属于collection中判断</span><br><span class="line">com.google.common.base.Predicates#compose(P,F)   // 先funtion在predicate判断</span><br><span class="line">com.google.common.base.Predicates#containsPattern() // 正则匹配</span><br></pre></td></tr></table></figure>

<h3 id="Splitter"><a href="#Splitter" class="headerlink" title="Splitter"></a>Splitter</h3><p>字符串拆分</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">com.google.common.base.Splitter#on(char)         // 根据什么进行拆分</span><br><span class="line">com.google.common.base.Splitter#fixedLength(int) // 基于固定长度拆分</span><br><span class="line">com.google.common.base.Splitter#omitEmptyStrings() // 拆分时候忽略空的字符串</span><br><span class="line">com.google.common.base.Splitter#limit(int)       // 只拆分几项</span><br><span class="line">com.google.common.base.Splitter#trimResults()    // 拆分的时候去掉空白</span><br><span class="line">com.google.common.base.Splitter#split(String)    // 拆分字符串</span><br><span class="line">com.google.common.base.Splitter#splitToList()    // 拆分后转换为一个集合</span><br><span class="line">com.google.common.base.Splitter#splitToStream()  // 拆分后转换为stream</span><br><span class="line">  </span><br><span class="line">com.google.common.base.Splitter#withKeyValueSeparator(java.lang.String)  // 拆分map</span><br></pre></td></tr></table></figure>

<h3 id="Strings"><a href="#Strings" class="headerlink" title="Strings"></a>Strings</h3><p>字符串操作</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">com.google.common.base.Strings#nullToEmpty(String)       // 将null转换未空串</span><br><span class="line">com.google.common.base.Strings#emptyToNull(String)       // 将空串转换为null</span><br><span class="line">com.google.common.base.Strings#isNullOrEmpty(String)     // 判断是空或者是null</span><br><span class="line"></span><br><span class="line">com.google.common.base.Strings#padStart(String,int,char) // 填充字符从最侧开始</span><br><span class="line">com.google.common.base.Strings#padEnd(String,int,char)   // 向右侧进行填充</span><br><span class="line">com.google.common.base.Strings#repeat(String,int)        // 重复出现</span><br><span class="line"></span><br><span class="line">com.google.common.base.Strings#commonPrefix(String,String) // 是公共的前缀</span><br><span class="line">com.google.common.base.Strings#commonSuffix(String,String) // 是公共的后缀</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="Suppliers"><a href="#Suppliers" class="headerlink" title="Suppliers"></a>Suppliers</h3><p>操作Suppliers类</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">com.google.common.base.Suppliers#compose(Function,Supplier)     // 将funtion和supplier进行结合</span><br><span class="line">com.google.common.base.Suppliers#ofInstance()                   // 是否是该类的实例</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>Guava</category>
      </categories>
      <tags>
        <tag>Guava-common-base</tag>
      </tags>
  </entry>
  <entry>
    <title>Guava-cache</title>
    <url>/2021/05/13/common-cache/</url>
    <content><![CDATA[<p>简介：用于操作缓存的类</p>
<img src="/2021/05/13/common-cache/common-cache.png" style="zoom: 50%;">

<a id="more"></a>

<h3 id="Cache"><a href="#Cache" class="headerlink" title="Cache"></a>Cache</h3><p>用于操作缓存的数据</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 创建对象</span></span><br><span class="line">LoadingCache&lt;Key, Graph&gt; graphs = CacheBuilder.newBuilder()</span><br><span class="line">        .maximumSize(<span class="number">1000</span>)</span><br><span class="line">        .expireAfterWrite(<span class="number">10</span>, TimeUnit.MINUTES)</span><br><span class="line">        .removalListener(MY_LISTENER)</span><br><span class="line">        .build(</span><br><span class="line">            <span class="keyword">new</span> CacheLoader&lt;Key, Graph&gt;() &#123;</span><br><span class="line">                <span class="function"><span class="keyword">public</span> Graph <span class="title">load</span><span class="params">(Key key)</span> <span class="keyword">throws</span> AnyException </span>&#123;</span><br><span class="line">                    <span class="keyword">return</span> createExpensiveGraph(key);</span><br><span class="line">                &#125;</span><br><span class="line">     &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建方法</span></span><br><span class="line">com.google.common.cache.Cache#getIfPresent(Obj)        // 根据key返回值</span><br><span class="line">com.google.common.cache.Cache#get(Obj,Callable)        // 根据key返回值，如果不存在值就调用callable然后存储在cache中</span><br><span class="line">com.google.common.cache.Cache#getAllPresent(Iterable)  // 根据keys返回所有的值</span><br><span class="line">com.google.common.cache.Cache#put(K,V)                 // 添加</span><br><span class="line">com.google.common.cache.Cache#invalidate(K)            // 清理key</span><br><span class="line">com.google.common.cache.Cache#stats()                  // 获取这个cache的统计信息</span><br><span class="line">com.google.common.cache.Cache#asMap()                  // cache转换一个map</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>Guava</category>
      </categories>
      <tags>
        <tag>Guava-common-cache</tag>
      </tags>
  </entry>
  <entry>
    <title>Guava-collections</title>
    <url>/2021/05/13/common-collections/</url>
    <content><![CDATA[<p>简介：用于操作集合</p>
<img src="/2021/05/13/common-collections/common-collections.png" style="zoom: 50%;">

<a id="more"></a>

<h2 id="BiMap"><a href="#BiMap" class="headerlink" title="BiMap"></a>BiMap</h2><p>通过key找value，也可以使用value找key。其实现类:</p>
<p><code>ImmutableBiMap</code> 、<code>SingletonImmutableBiMap</code>  、<code>RegularImmutableBiMap</code> 、<code>RegularImmutableBiMap</code> 、<code>JdkBackedImmutableBiMap</code> </p>
<p><code>HashBiMap</code> </p>
<p><code>AbstractBiMap</code> 、<code>EnumHashBiMap</code> 、<code>EnumBiMap</code> </p>
<h3 id="ImmutableBiMap"><a href="#ImmutableBiMap" class="headerlink" title="ImmutableBiMap"></a>ImmutableBiMap</h3><p>用于操作不可变类的BiMap</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">com.google.common.collect.ImmutableBiMap#of(K, V)         // 插入k,v</span><br><span class="line">com.google.common.collect.ImmutableBiMap#of(K, V, K, V)   // 插入多个kv</span><br><span class="line">com.google.common.collect.ImmutableBiMap#copyOf(java.util.Map&lt;? extends K,? extends V&gt;) // 将一个map转换为Immutable类型</span><br><span class="line">com.google.common.collect.ImmutableBiMap#values()         // 获取所有value的值</span><br></pre></td></tr></table></figure>

<h3 id="SingletonImmutableBiMap"><a href="#SingletonImmutableBiMap" class="headerlink" title="SingletonImmutableBiMap"></a>SingletonImmutableBiMap</h3><p>只能存储单个key-value值</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;K, V&gt; <span class="function">ImmutableBiMap&lt;K, V&gt; <span class="title">of</span><span class="params">(K k1, V v1)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> SingletonImmutableBiMap&lt;&gt;(k1, v1);          <span class="comment">// 只能通过这个方法进行创建</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="RegularImmutableBiMap"><a href="#RegularImmutableBiMap" class="headerlink" title="RegularImmutableBiMap"></a>RegularImmutableBiMap</h3><p>常规的ImmutableBiMap的创建</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;K, V&gt; <span class="function">ImmutableBiMap&lt;K, V&gt; <span class="title">of</span><span class="params">(K k1, V v1, K k2, V v2)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> RegularImmutableBiMap.fromEntries(entryOf(k1, v1), entryOf(k2, v2));    <span class="comment">// 只能通过这个方法进行创建</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="HashBiMap"><a href="#HashBiMap" class="headerlink" title="HashBiMap"></a>HashBiMap</h3><p>基于hashMap的实现</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">com.google.common.collect.HashBiMap#create()        // 创建一个HashBiMap对象</span><br><span class="line">com.google.common.collect.HashBiMap#containsKey(K)  // 是否包含key</span><br><span class="line">com.google.common.collect.HashBiMap#containsValue(V) // 是否包含value</span><br><span class="line">com.google.common.collect.HashBiMap#get(K)          // 通过key获取value</span><br><span class="line">com.google.common.collect.HashBiMap#put(K, V)       // 插入值</span><br><span class="line">com.google.common.collect.HashBiMap#forcePut(K,V)   // 强制性插入</span><br><span class="line">com.google.common.collect.HashBiMap#putInverse(V,K) // 逆序插入，先插入value,在插入key</span><br><span class="line">com.google.common.collect.HashBiMap#remove(K)       // 删除Key</span><br><span class="line">com.google.common.collect.HashBiMap#inverse()       // 逆序显示</span><br></pre></td></tr></table></figure>

<h3 id="AbstractBiMap"><a href="#AbstractBiMap" class="headerlink" title="AbstractBiMap"></a>AbstractBiMap</h3><h3 id="EnumHashBiMap"><a href="#EnumHashBiMap" class="headerlink" title="EnumHashBiMap"></a>EnumHashBiMap</h3><p>用于操作枚举的BiMap</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">com.google.common.collect.EnumHashBiMap#create(java.lang.Class&lt;K&gt;)      // 基于枚举Key来创建</span><br><span class="line">com.google.common.collect.EnumHashBiMap#put(K,V)                        // 插入</span><br><span class="line">com.google.common.collect.EnumHashBiMap#forcePut(K,V)                   // 强制插入</span><br></pre></td></tr></table></figure>

<h3 id="EnumBiMap"><a href="#EnumBiMap" class="headerlink" title="EnumBiMap"></a>EnumBiMap</h3><p>用于操作枚举</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">com.google.common.collect.EnumBiMap#create(java.lang.Class&lt;K&gt;, java.lang.Class&lt;V&gt;)   // 基于枚举Key来创建</span><br><span class="line">com.google.common.collect.EnumBiMap#keyType()          // key类型</span><br><span class="line">com.google.common.collect.EnumBiMap#valueType()        // value类型</span><br></pre></td></tr></table></figure>

<h2 id="Multimap"><a href="#Multimap" class="headerlink" title="Multimap"></a>Multimap</h2><p>用操作多key的情况，其实现类。本质上就是List&lt;Key,Collection<Value>&gt; 类型存储</Value></p>
<p><code>ForwardingMultimap</code> 、<code>ForwardingListMultimap</code> 、<code>ForwardingSetMultimap</code> 、<code>ForwardingSortedSetMultimap</code></p>
<p><code>ListMultimap</code> 、<code>LinkedListMultimap</code> 、<code>AbstractListMultimap</code> 、<code>ArrayListMultimap</code> 、<code>FilteredKeyListMultimap</code>、<code>ForwardingListMultimap</code> 、<code>ImmutableListMultimap</code> </p>
<p><code>AbstractMultimap</code> 、<code>LinkedListMultimap</code>、<code>AbstractMapBasedMultimap</code> 、<code>LinkedHashMultimap</code> 、<code>HashMultimap</code> 、<code>TreeMultimap</code>、<code>FilteredEntrySetMultimap</code> 、<code>ImmutableMultimap</code> 、<code>FilteredKeyListMultimap</code> 、<code>FilteredKeySetMultimap</code> 、</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">com.google.common.collect.Multimap#containsKey()      // 包含key</span><br><span class="line">com.google.common.collect.Multimap#containsValue()    // 包含value</span><br><span class="line">com.google.common.collect.Multimap#put(K,V)           // 新增</span><br><span class="line">com.google.common.collect.Multimap#replaceValues()    // 替换</span><br><span class="line">com.google.common.collect.Multimap#get(K)             // 获取</span><br><span class="line">com.google.common.collect.Multimap#forEach()          // 遍历</span><br><span class="line">com.google.common.collect.Multimap#asMap()            // 视图</span><br></pre></td></tr></table></figure>

<h3 id="Multimaps"><a href="#Multimaps" class="headerlink" title="Multimaps"></a>Multimaps</h3><p>用于操作Multimap的工具</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">com.google.common.collect.Multimaps#toMultimap(Function,Function,Supplier)      // 创建一个Mulimap</span><br><span class="line"><span class="comment">// stream + mulitmap 的操作 </span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> ListMultimap&lt;Character, String&gt; FIRST_LETTER_MULTIMAP =</span><br><span class="line">   Stream.of(<span class="string">&quot;banana&quot;</span>, <span class="string">&quot;apple&quot;</span>, <span class="string">&quot;carrot&quot;</span>, <span class="string">&quot;asparagus&quot;</span>, <span class="string">&quot;cherry&quot;</span>)</span><br><span class="line">            .collect(</span><br><span class="line">                toMultimap(</span><br><span class="line">                     str -&gt; str.charAt(<span class="number">0</span>),</span><br><span class="line">                     str -&gt; str.substring(<span class="number">1</span>),</span><br><span class="line">                     MultimapBuilder.treeKeys().arrayListValues()::build));</span><br><span class="line"></span><br><span class="line">com.google.common.collect.Multimaps#flatteningToMultimap()                // 并行创建</span><br><span class="line">com.google.common.collect.Multimaps#newListMultimap(Map,Supplier)         // 创建MultiListMap</span><br><span class="line">com.google.common.collect.Multimaps#newSetMultimap(Map,Supplier)          // 创建MultiSetMap</span><br><span class="line">com.google.common.collect.Multimaps#newSortedSetMultimap(Map,Supplier)    // 创建MulitSortSetMap</span><br><span class="line"></span><br><span class="line">com.google.common.collect.Multimaps#invertFrom(src,dest)                  // 将值进行转换后返回</span><br><span class="line"></span><br><span class="line">com.google.common.collect.Multimaps#synchronizedMultimap()        </span><br><span class="line">com.google.common.collect.Multimaps#unmodifiableMultimap(com.google.common.collect.Multimap&lt;K,V&gt;) </span><br><span class="line">com.google.common.collect.Multimaps#asMap(com.google.common.collect.ListMultimap&lt;K,V&gt;)     // 返回视图</span><br><span class="line">com.google.common.collect.Multimaps#forMap(Map)                           // 将map转换为MulitiMap</span><br><span class="line">com.google.common.collect.Multimaps#transformValues(com.google.common.collect.ListMultimap&lt;K,V1&gt;, com.google.common.base.Function&lt;? super V1,V2&gt;)   // 对value进行转换</span><br><span class="line">com.google.common.collect.Multimaps#transformEntries(com.google.common.collect.Multimap&lt;K,V1&gt;, com.google.common.collect.Maps.EntryTransformer&lt;? super K,? super V1,V2&gt;) // 对key value进行转换</span><br><span class="line"></span><br><span class="line">com.google.common.collect.Multimaps#filterKeys(com.google.common.collect.ListMultimap&lt;K,V&gt;, com.google.common.base.Predicate&lt;? super K&gt;) // 过滤key</span><br><span class="line">com.google.common.collect.Multimaps#filterValues(com.google.common.collect.SetMultimap&lt;K,V&gt;, com.google.common.base.Predicate&lt;? super V&gt;) // 过滤value</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="MultimapBuilder"><a href="#MultimapBuilder" class="headerlink" title="MultimapBuilder"></a>MultimapBuilder</h3><p>用于构建MuliMap</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">com.google.common.collect.MultimapBuilder#hashKeys()       // 预定义key的数据类型为hash</span><br><span class="line">com.google.common.collect.MultimapBuilder#linkedHashKeys() // 预定义key的数据类型为LinkedHash</span><br><span class="line">com.google.common.collect.MultimapBuilder#treeKeys()       // 预定义key的数据类型为tree</span><br><span class="line">com.google.common.collect.MultimapBuilder#enumKeys()       // 定义枚举key</span><br><span class="line"></span><br><span class="line">com.google.common.collect.MultimapBuilder.MultimapBuilderWithKeys#arrayListValues() // 定义value的类型</span><br><span class="line">com.google.common.collect.MultimapBuilder.MultimapBuilderWithKeys#linkedListValues()</span><br></pre></td></tr></table></figure>

<h2 id="Multiset"><a href="#Multiset" class="headerlink" title="Multiset"></a>Multiset</h2><p>用于多个key存储在set集合中，其中实现类有</p>
<p><code>SortedMultiset</code> 、<code>TreeMultiset</code> 、<code>ImmutableMultiset</code> 、<code>ConcurrentHashMultiset</code> 、<code>HashMultiset</code> 、<code>LinkedHashMultiset</code></p>
<p> <code>EnumMultiset</code></p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">com.google.common.collect.Multiset#count(E)           // 统计元素在Set中的个数</span><br><span class="line">com.google.common.collect.Multiset#add(E, int)        // 添加几个元素</span><br><span class="line">com.google.common.collect.Multiset#remove(java.lang.Object) // 删除</span><br><span class="line">com.google.common.collect.Multiset#setCount(E, int)   // 新增或删除这个元素在set中的次数</span><br><span class="line">com.google.common.collect.Multiset#elementSet()       // 获取所有元素去重了的</span><br><span class="line">com.google.common.collect.Multiset#entrySet()         // 所有元素</span><br><span class="line">com.google.common.collect.Multiset#forEachEntry()     // 遍历</span><br></pre></td></tr></table></figure>

<h3 id="Multisets"><a href="#Multisets" class="headerlink" title="Multisets"></a>Multisets</h3><p>用于构建MuliSet</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">com.google.common.collect.Multisets#toMultiset()       // 创建MultiSet对象</span><br><span class="line">com.google.common.collect.Multisets#unmodifiableMultiset(com.google.common.collect.Multiset&lt;? extends E&gt;) // 不可变</span><br><span class="line">com.google.common.collect.Multisets#filter()           // set中元素进行过滤</span><br><span class="line">com.google.common.collect.Multisets#union()            // 合并</span><br><span class="line">com.google.common.collect.Multisets#intersection()     // 交接</span><br><span class="line">com.google.common.collect.Multisets#difference()       // 不同点</span><br><span class="line">com.google.common.collect.Multisets#removeOccurrences(com.google.common.collect.Multiset&lt;?&gt;, java.lang.Iterable&lt;?&gt;) // 移除</span><br></pre></td></tr></table></figure>

<h2 id="Range-amp-Cut-amp-ContiguousSet"><a href="#Range-amp-Cut-amp-ContiguousSet" class="headerlink" title="Range &amp; Cut &amp; ContiguousSet"></a>Range &amp; Cut &amp; ContiguousSet</h2><p>操作范围</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">com.google.common.collect.Range#create(Cut,Cut)      // 创建</span><br><span class="line">com.google.common.collect.Range#open()               // 创建</span><br><span class="line"></span><br><span class="line">com.google.common.collect.Cut#aboveValue()           // 以上的值</span><br><span class="line">com.google.common.collect.Cut#belowValue()           // 以下的值</span><br><span class="line"></span><br><span class="line">com.google.common.collect.Cut#belowAll()</span><br><span class="line">com.google.common.collect.Cut#aboveAll()</span><br><span class="line"></span><br><span class="line">ContiguousSet.create(Range.closed(<span class="number">5</span>, <span class="number">42</span>)</span><br></pre></td></tr></table></figure>

<h2 id="RangeMap"><a href="#RangeMap" class="headerlink" title="RangeMap"></a>RangeMap</h2><p>用于范围map存储，其实现类：<code>ImmutableRangeMap</code> 、<code>TreeRangeMap</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">com.google.common.collect.RangeMap#get(K)           // 通过key获取</span><br><span class="line">com.google.common.collect.RangeMap#getEntry()       // key的范围</span><br><span class="line">com.google.common.collect.RangeMap#span()           // 返回最小的范围</span><br><span class="line">com.google.common.collect.RangeMap#put(Range,V)     // 新增</span><br><span class="line">com.google.common.collect.RangeMap#putCoalescing()  // 具有相同值的进行范围合并</span><br><span class="line"></span><br><span class="line">com.google.common.collect.RangeMap#merge()          // range拆分</span><br><span class="line">rangeMap.put(Range.closedOpen(<span class="number">0</span>, <span class="number">3</span>), <span class="number">1</span>);</span><br><span class="line">rangeMap.merge(Range.closedOpen(<span class="number">1</span>, <span class="number">2</span>), <span class="number">2</span>, Integer::sum);</span><br></pre></td></tr></table></figure>

<h3 id="ImmutableRangeMap"><a href="#ImmutableRangeMap" class="headerlink" title="ImmutableRangeMap"></a>ImmutableRangeMap</h3><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">com.google.common.collect.ImmutableRangeMap#of() </span><br></pre></td></tr></table></figure>

<h3 id="TreeRangeMap"><a href="#TreeRangeMap" class="headerlink" title="TreeRangeMap"></a>TreeRangeMap</h3><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">com.google.common.collect.TreeRangeMap#create()      // 创建TreeRangeMap</span><br></pre></td></tr></table></figure>

<h2 id="RangeSet"><a href="#RangeSet" class="headerlink" title="RangeSet"></a>RangeSet</h2><p>用于存储范围，其实现类：<code>ImmutableRangeSet</code> 、 <code>TreeRangeSet</code> </p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">com.google.common.collect.RangeSet#add(Range)        // 新增</span><br><span class="line">com.google.common.collect.RangeSet#contains()        // 判断值是否存在</span><br><span class="line">com.google.common.collect.RangeSet#rangeContaining() // 返回包含这个值的Range</span><br><span class="line">com.google.common.collect.RangeSet#intersects()      // 交叉</span><br><span class="line">com.google.common.collect.RangeSet#encloses()        // 范围包含</span><br></pre></td></tr></table></figure>

<h3 id="ImmutableRangeSet"><a href="#ImmutableRangeSet" class="headerlink" title="ImmutableRangeSet"></a>ImmutableRangeSet</h3><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">com.google.common.collect.ImmutableRangeSet#toImmutableRangeSet()</span><br></pre></td></tr></table></figure>

<h3 id="TreeRangeSet"><a href="#TreeRangeSet" class="headerlink" title="TreeRangeSet"></a>TreeRangeSet</h3><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">com.google.common.collect.TreeRangeSet#create()</span><br></pre></td></tr></table></figure>

<h2 id="Table"><a href="#Table" class="headerlink" title="Table"></a>Table</h2><p>用于操作表格，实现类：<code>ArrayTable</code> 、<code>HashBasedTable</code> 、<code>ImmutableTable</code> 、<code>TreeBasedTable</code></p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">com.google.common.collect.Table#contains(R,C)        // 包含对应的行，列</span><br><span class="line">com.google.common.collect.Table#get(R,C)             // cell</span><br><span class="line">com.google.common.collect.Table#put(R,C,V)</span><br></pre></td></tr></table></figure>

<h3 id="Tables"><a href="#Tables" class="headerlink" title="Tables"></a>Tables</h3><figure class="highlight"><table><tr><td class="code"><pre><span class="line">com.google.common.collect.Tables#toTable(java.util.function.Function&lt;? super T,? extends R&gt;, java.util.function.Function&lt;? super T,? extends C&gt;, java.util.function.Function&lt;? super T,? extends V&gt;, java.util.function.Supplier&lt;I&gt;)</span><br></pre></td></tr></table></figure>

<h3 id="ArrayTable"><a href="#ArrayTable" class="headerlink" title="ArrayTable"></a>ArrayTable</h3><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">com.google.common.collect.ArrayTable#create(java.lang.Iterable&lt;? extends R&gt;, java.lang.Iterable&lt;? extends C&gt;) </span><br></pre></td></tr></table></figure>

<h3 id="HashBasedTable"><a href="#HashBasedTable" class="headerlink" title="HashBasedTable"></a>HashBasedTable</h3><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">com.google.common.collect.HashBasedTable#create()</span><br></pre></td></tr></table></figure>

<h3 id="TreeBasedTable"><a href="#TreeBasedTable" class="headerlink" title="TreeBasedTable"></a>TreeBasedTable</h3><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">com.google.common.collect.TreeBasedTable#create()</span><br></pre></td></tr></table></figure>

<h2 id="Ordering"><a href="#Ordering" class="headerlink" title="Ordering"></a>Ordering</h2><p>用于排序</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">com.google.common.collect.Ordering#natural()     // 自然排序</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Comparators"><a href="#Comparators" class="headerlink" title="Comparators"></a>Comparators</h2><p>用于排序</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">com.google.common.collect.Comparators#least() // 相对于指定key最小的值</span><br><span class="line"><span class="comment">// stream + comparators 运作</span></span><br><span class="line">Stream.of(<span class="string">&quot;foo&quot;</span>, <span class="string">&quot;quux&quot;</span>, <span class="string">&quot;banana&quot;</span>, <span class="string">&quot;elephant&quot;</span>)</span><br><span class="line">       .collect(least(<span class="number">2</span>, comparingInt(String::length)))</span><br><span class="line">   <span class="comment">// returns &#123;&quot;foo&quot;, &quot;quux&quot;&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="ComparisonChain"><a href="#ComparisonChain" class="headerlink" title="ComparisonChain"></a>ComparisonChain</h2><p>过滤器链</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">com.google.common.collect.ComparisonChain#start() </span><br><span class="line">com.google.common.collect.ComparisonChain#compare(int, int) // 比较</span><br></pre></td></tr></table></figure>

<h2 id="FluentIterable"><a href="#FluentIterable" class="headerlink" title="FluentIterable"></a>FluentIterable</h2><p>迭代器</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">ImmutableList&lt;String&gt; results =</span><br><span class="line">      FluentIterable.from(database.getClientList())</span><br><span class="line">          .filter(Client::isActiveInLastMonth)</span><br><span class="line">          .transform(Object::toString)</span><br><span class="line">          .limit(<span class="number">10</span>)</span><br><span class="line">          .toList();</span><br></pre></td></tr></table></figure>

<h2 id="Iterables-amp-Iterators"><a href="#Iterables-amp-Iterators" class="headerlink" title="Iterables &amp; Iterators"></a>Iterables &amp; Iterators</h2><p>迭代器</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">com.google.common.collect.Iterables#removeIf()</span><br><span class="line">com.google.common.collect.Iterables#getOnlyElement(java.lang.Iterable&lt;T&gt;)   // 获取一个元素</span><br></pre></td></tr></table></figure>

<h2 id="Lists"><a href="#Lists" class="headerlink" title="Lists"></a>Lists</h2><figure class="highlight"><table><tr><td class="code"><pre><span class="line">com.google.common.collect.Lists#newArrayList()</span><br></pre></td></tr></table></figure>

<h2 id="Maps"><a href="#Maps" class="headerlink" title="Maps"></a>Maps</h2><h2 id="Sets"><a href="#Sets" class="headerlink" title="Sets"></a>Sets</h2><h2 id="Queues"><a href="#Queues" class="headerlink" title="Queues"></a>Queues</h2><h2 id="Streams"><a href="#Streams" class="headerlink" title="Streams"></a>Streams</h2><h2 id="ObjectArrays"><a href="#ObjectArrays" class="headerlink" title="ObjectArrays"></a>ObjectArrays</h2><figure class="highlight"><table><tr><td class="code"><pre><span class="line">com.google.common.collect.ObjectArrays#newArray(java.lang.Class&lt;T&gt;, int) // 创建数组</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>Guava</category>
      </categories>
      <tags>
        <tag>Guava-common-collections</tag>
      </tags>
  </entry>
  <entry>
    <title>Guava-io</title>
    <url>/2021/05/13/common-io/</url>
    <content><![CDATA[<p>简介：用于操作IO流</p>
<img src="/2021/05/13/common-io/common-io.png" style="zoom: 50%;">

<a id="more"></a>

<h3 id="ByteStreams"><a href="#ByteStreams" class="headerlink" title="ByteStreams"></a>ByteStreams</h3><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">com.google.common.io.ByteStreams#copy(java.io.InputStream, java.io.OutputStream)   // 流复制</span><br></pre></td></tr></table></figure>

<h3 id="CharStreams"><a href="#CharStreams" class="headerlink" title="CharStreams"></a>CharStreams</h3><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">com.google.common.io.CharStreams#copy()</span><br></pre></td></tr></table></figure>

<h3 id="Closeables"><a href="#Closeables" class="headerlink" title="Closeables"></a>Closeables</h3><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法 </span></span><br><span class="line">com.google.common.io.Closeables#closeQuietly(java.io.InputStream)  // 安静关闭流</span><br></pre></td></tr></table></figure>

<h3 id="Closer"><a href="#Closer" class="headerlink" title="Closer"></a>Closer</h3><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">com.google.common.io.Closer#create()   // 创建</span><br><span class="line">com.google.common.io.Closer#register() // 注册</span><br><span class="line">com.google.common.io.Closer#close()    // 关闭</span><br></pre></td></tr></table></figure>

<h3 id="Files"><a href="#Files" class="headerlink" title="Files"></a>Files</h3><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">com.google.common.io.Files#newReader()</span><br><span class="line">com.google.common.io.Files#toByteArray()      // 转换为字节</span><br></pre></td></tr></table></figure>

<h3 id="MoreFiles"><a href="#MoreFiles" class="headerlink" title="MoreFiles"></a>MoreFiles</h3><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">com.google.common.io.MoreFiles#asByteSource() </span><br></pre></td></tr></table></figure>

<h3 id="Resources"><a href="#Resources" class="headerlink" title="Resources"></a>Resources</h3><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">com.google.common.io.Resources#copy()</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>Guava</category>
      </categories>
      <tags>
        <tag>Guava-common-io</tag>
      </tags>
  </entry>
  <entry>
    <title>idea多线程调试</title>
    <url>/2021/05/06/idea-debug/</url>
    <content><![CDATA[<p>简介：记录idea多线程调试</p>
<img src="/2021/05/06/idea-debug/debug.jpeg" style="zoom: 50%;">

<a id="more"></a>

<h3 id="设置方法断点"><a href="#设置方法断点" class="headerlink" title="设置方法断点"></a>设置方法断点</h3><p><img src="/2021/05/06/idea-debug/Untitled.png" alt="idea-debug/Untitled.png"></p>
<h3 id="代码编写"><a href="#代码编写" class="headerlink" title="代码编写"></a>代码编写</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 多线程调试</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        ExecutorService service = Executors.newFixedThreadPool(<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">        service.submit(<span class="keyword">new</span> Thread(<span class="keyword">new</span> TaskOne(), <span class="string">&quot;TaskOne&quot;</span>));</span><br><span class="line">        service.submit(<span class="keyword">new</span> Thread(<span class="keyword">new</span> TaskTwo(), <span class="string">&quot;TaskTwo&quot;</span>));</span><br><span class="line">        service.submit(<span class="keyword">new</span> Thread(<span class="keyword">new</span> TaskThree(), <span class="string">&quot;TaskThree&quot;</span>));</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;main thread is end ...&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">TaskOne</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;TaskOne is running...&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">TaskTwo</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;TaskTwo is running...&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">TaskThree</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;TaskThree is running...&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="栈帧切换调试线程"><a href="#栈帧切换调试线程" class="headerlink" title="栈帧切换调试线程"></a>栈帧切换调试线程</h3><p><img src="/2021/05/06/idea-debug/Untitled%201.png" alt="idea-debug/Untitled%201.png"></p>
]]></content>
      <categories>
        <category>IntelliJ IDEA</category>
      </categories>
      <tags>
        <tag>IntelliJ IDEA</tag>
      </tags>
  </entry>
  <entry>
    <title>javassist</title>
    <url>/2021/09/05/javassist/</url>
    <content><![CDATA[<h1 id="javassist"><a href="#javassist" class="headerlink" title="javassist"></a>javassist</h1><p>简介：Java字节码以二进制的形式存储在.class文件中，每一个.class文件包含一个Java类或接口。Javassist就是一个用来处理Java字节码的类库。它可以在一个<strong>已经编译好的类</strong>中添加新的方法，并且不需要对字节码方面有深入的了解。同时也可以去生成一个新的类对象，通过完全手动的方式</p>
<img src="/2021/09/05/javassist/javassist.png" style="zoom: 50%;">

<a id="more"></a>

<h2 id="1-引入依赖"><a href="#1-引入依赖" class="headerlink" title="1.引入依赖"></a>1.引入依赖</h2><figure class="highlight"><table><tr><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">  &lt;groupId&gt;org.javassist&lt;/groupId&gt;</span><br><span class="line">  &lt;artifactId&gt;javassist&lt;/artifactId&gt;</span><br><span class="line">  &lt;version&gt;3.25.0-GA&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<h2 id="2-初体验"><a href="#2-初体验" class="headerlink" title="2.初体验"></a>2.初体验</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">ClassPool pool = ClassPool.getDefault();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1.创建一个类</span></span><br><span class="line">CtClass ctClass = pool.makeClass(<span class="string">&quot;javassist.Person&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.新增一个字段 private String name</span></span><br><span class="line">CtField field = <span class="keyword">new</span> CtField(pool.get(<span class="string">&quot;java.lang.String&quot;</span>), <span class="string">&quot;name&quot;</span>, ctClass);</span><br><span class="line">field.setModifiers(Modifier.PRIVATE);</span><br><span class="line">ctClass.addField(field, CtField.Initializer.constant(<span class="string">&quot;tom&quot;</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. 生成 getter、setter 方法</span></span><br><span class="line">ctClass.addMethod(CtNewMethod.setter(<span class="string">&quot;setName&quot;</span>, field));</span><br><span class="line">ctClass.addMethod(CtNewMethod.getter(<span class="string">&quot;getName&quot;</span>, field));</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. 添加无参的构造函数</span></span><br><span class="line">CtConstructor cons = <span class="keyword">new</span> CtConstructor(<span class="keyword">new</span> CtClass[]&#123;&#125;, ctClass);</span><br><span class="line">cons.setBody(<span class="string">&quot;&#123;name = \&quot;tom\&quot;;&#125;&quot;</span>);</span><br><span class="line">ctClass.addConstructor(cons);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 5. 添加有参的构造函数</span></span><br><span class="line">cons = <span class="keyword">new</span> CtConstructor(<span class="keyword">new</span> CtClass[]&#123;pool.get(<span class="string">&quot;java.lang.String&quot;</span>)&#125;, ctClass);</span><br><span class="line"><span class="comment">// $0=this / $1,$2,$3... 代表方法参数</span></span><br><span class="line">cons.setBody(<span class="string">&quot;&#123;$0.name = $1;&#125;&quot;</span>);</span><br><span class="line">ctClass.addConstructor(cons);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 6. 创建一个名为printName方法，无参数，无返回值，输出name值</span></span><br><span class="line">CtMethod ctMethod = <span class="keyword">new</span> CtMethod(CtClass.voidType, <span class="string">&quot;printName&quot;</span>, <span class="keyword">new</span> CtClass[]&#123;&#125;, ctClass);</span><br><span class="line">ctMethod.setModifiers(Modifier.PUBLIC);</span><br><span class="line">ctMethod.setBody(<span class="string">&quot;&#123;System.out.println(name);&#125;&quot;</span>);</span><br><span class="line">ctClass.addMethod(ctMethod);</span><br><span class="line"></span><br><span class="line">ctClass.toClass();</span><br></pre></td></tr></table></figure>

<h2 id="核心对象"><a href="#核心对象" class="headerlink" title="核心对象"></a>核心对象</h2><h3 id="ClassPool"><a href="#ClassPool" class="headerlink" title="ClassPool"></a>ClassPool</h3><p>ClassPool需要关注的方法</p>
<p>1、getDefault：返回默认的ClassPool是一个单例模式的，一般通过该方法创建我们的ClassPool对象</p>
<p>2、appendClassPath、insertClassPath：将一个ClassPath加到类搜索路径的末尾位置。通常通过该方法写入额外的类搜索路径，以解决多个类加载器环境中找不到类的尴尬。</p>
<p>3、toClass: 将修改后的CtClass加载至当前线程的上下文类加载器中，CtClass的toClass方法是通过调用本方法实现。需要注意的是一旦调用该方法，则无法继续修改已经被加载的class。</p>
<p>4、importPackage：导入包路径</p>
<p>5、get、getCtClass：根据<strong>类路径名</strong>获取该类的CtClass对象，用于后续的编辑。</p>
<p>6、getMethod：通过类路径和方法名获取CtMethod</p>
<p>7、makeClass：创建一个类</p>
<pre><code>  makeNestedClass：创建一个内部类</code></pre>
<p>makeInterface：创建一个接口</p>
<h3 id="CtClass"><a href="#CtClass" class="headerlink" title="CtClass"></a>CtClass</h3><p>CtClass需要关注的方法</p>
<p>1、freeze：冻结一个类，使其不可修改</p>
<p>2、isFrozen : 判断一个类是否已被冻结</p>
<p>3、defrost : 解冻一个类，使其可以被修改。如果事先知道一个类会被defrost， 则禁止调用 prune 方法</p>
<p>4、prune : 删除类不必要的属性，以减少内存占用。调用该方法后，许多方法无法将无法正常使用，慎用</p>
<p>5、detach : 将该class从ClassPool中删除</p>
<p>6、writeFile : 根据CtClass生成 .class 文件</p>
<p>7、toClass : 通过类加载器加载该CtClass</p>
<h3 id="CtField"><a href="#CtField" class="headerlink" title="CtField"></a>CtField</h3><p>CtField需要关注的方法</p>
<p>1、setModifiers：设置字段的修饰符</p>
<p>2、hasAnnotation：判断是否有该注解</p>
<h3 id="CtMethod"><a href="#CtMethod" class="headerlink" title="CtMethod"></a>CtMethod</h3><p>CtMethod需要关注的方法(CtNewMethod的静态方法可以快速创建CtMethod对象)</p>
<p>1、insertBefore : 在方法的起始位置插入代码</p>
<p>2、insterAfter : 在方法的所有 return 语句前插入代码以确保语句能够被执行，除非遇到exception</p>
<p>3、insertAt : 在指定的位置插入代码</p>
<p>4、setBody : 将方法的内容设置为要写入的代码，当方法被 abstract修饰时，该修饰符被移除</p>
<p>5、make : 创建一个新的方法</p>
<p>注意到在上面代码中的：setBody()的时候我们使用了一些符号</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// $0=this / $1,$2,$3... 代表方法参数</span></span><br><span class="line">cons.setBody(<span class="string">&quot;&#123;$0.name = $1;&#125;&quot;</span>);</span><br></pre></td></tr></table></figure>



<p><code>$0</code>, <code>$1</code>, <code>$2</code>, …    <code>this</code> 和实际参数</p>
<p><code>$args</code>参数数组。的类型<code>$args</code>是<code>Object[]</code></p>
<p><code>$$</code>所有实际参数。例如，<code>m($$)</code>相当于 <code>m($1,$2,</code>…<code>)</code></p>
<p><code>$cflow(</code>…<code>) cflow</code> 多变的</p>
<p><code>$r</code>结果类型。它用于强制转换表达式。</p>
<p><code>$w</code>包装器类型。它用于强制转换表达式。</p>
<p><code>$_</code>结果值<code>$sigjava.lang.Class</code>表示形式参数类型的对象数组。</p>
<p><code>$type</code>甲<code>java.lang.Class</code>表示正式结果类型对象。</p>
<p><code>$classjava.lang.Class</code>表示当前编辑的类的对象。</p>
]]></content>
      <categories>
        <category>javassist</category>
      </categories>
      <tags>
        <tag>javassist</tag>
      </tags>
  </entry>
  <entry>
    <title>joda-time</title>
    <url>/2021/05/05/joda-time/</url>
    <content><![CDATA[<p>简介：Joda-Time这个专门处理日期时间的库。</p>
<img src="/2021/05/05/joda-time/joda-time.png" style="zoom: 50%;">

<a id="more"></a>

<h3 id="引入依赖"><a href="#引入依赖" class="headerlink" title="引入依赖"></a>引入依赖</h3><figure class="highlight"><table><tr><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;joda-time&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;joda-time&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;2.9.2&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<h3 id="核心类介绍"><a href="#核心类介绍" class="headerlink" title="核心类介绍"></a>核心类介绍</h3><p>下面介绍5个最常用的date-time类：</p>
<ul>
<li>Instant - 不可变的类，用来表示时间轴上一个瞬时的点</li>
<li>DateTime - 不可变的类，用于替换JDK的Calendar类</li>
<li>LocalDate - 不可变类，表示一个本地的日期，而不包含时间部分（没有时区信息）</li>
<li>LocalTime - 不可变类，表示一个本地的时间，而不包含日期部分（没有时区信息）</li>
<li>LocalDateTime - 不可变类，表示一个本地的日期-时间（没有时区信息）</li>
</ul>
<h3 id="Instant"><a href="#Instant" class="headerlink" title="Instant"></a>Instant</h3><figure class="highlight"><table><tr><td class="code"><pre><span class="line">org.joda.time.Instant#now()          // 获取当前时间</span><br></pre></td></tr></table></figure>

<h3 id="DateTime"><a href="#DateTime" class="headerlink" title="DateTime"></a>DateTime</h3><figure class="highlight"><table><tr><td class="code"><pre><span class="line">org.joda.time.DateTime#now()         // 获取当前时间</span><br><span class="line">org.joda.time.DateTime#DateTime(int, int, int, int, int, int)    // 自定义年、月、日、时、分、秒</span><br><span class="line">org.joda.time.DateTime#parse(java.lang.String)     // 字符串转换为时间</span><br><span class="line">org.joda.time.DateTime#withZone(org.joda.time.DateTimeZone)  // 直接修改时区</span><br><span class="line">org.joda.time.DateTime#withDate(int, int, int)               // 直接修改年、月、日</span><br><span class="line">org.joda.time.DateTime#withTime(int, int, int, int)          // 直接修改时、分、秒</span><br><span class="line">org.joda.time.DateTime#withTimeAtStartOfDay()                // 直接修改为当前的开始时间(2021-05-05T00:00:00.000Z)</span><br><span class="line"></span><br><span class="line">org.joda.time.DateTime#withField(org.joda.time.DateTimeFieldType,int)      // 指定那个枚举值为值</span><br><span class="line">org.joda.time.DateTime#withFieldAdded(org.joda.time.DateTimeFieldType,int) // 指定枚举增加多少</span><br><span class="line"></span><br><span class="line">org.joda.time.DateTime#plusYears(int)        // 增加年</span><br><span class="line">org.joda.time.DateTime#plusMonths(int)       // 增加月</span><br><span class="line">org.joda.time.DateTime#plusWeeks(int)        // 增加周</span><br><span class="line">org.joda.time.DateTime#plusDays(int)         // 增加天</span><br><span class="line">org.joda.time.DateTime#plusHours(int)        // 增加小时</span><br><span class="line">org.joda.time.DateTime#plusMinutes(int)      // 增加分钟</span><br><span class="line">org.joda.time.DateTime#plusSeconds(int)      // 增加秒</span><br><span class="line">org.joda.time.DateTime#plusMillis(int)       // 增加毫秒</span><br><span class="line"></span><br><span class="line">org.joda.time.DateTime#minusYears(int)        // 减少年</span><br><span class="line">org.joda.time.DateTime#minusMonths(int)       // 减少月</span><br><span class="line">org.joda.time.DateTime#minusWeeks(int)        // 减少周</span><br><span class="line">org.joda.time.DateTime#minusDays(int)         // 减少天</span><br><span class="line">org.joda.time.DateTime#minusHours(int)        // 减少小时</span><br><span class="line">org.joda.time.DateTime#minusMinutes(int)      // 减少分钟</span><br><span class="line">org.joda.time.DateTime#minusSeconds(int)      // 减少秒</span><br><span class="line">org.joda.time.DateTime#minusMillis(int)       // 减少毫秒</span><br><span class="line"></span><br><span class="line">org.joda.time.DateTime#toLocalDateTime()      // 将dateTime转化为locaDateTime</span><br><span class="line">org.joda.time.DateTime#toLocalDate()          // 将dateTime转化为localDate</span><br><span class="line">org.joda.time.DateTime#toLocalTime()          // 将dateTime转化为localTime</span><br><span class="line"></span><br><span class="line">org.joda.time.DateTime#withYear(int)          // 直接指定年</span><br><span class="line">org.joda.time.DateTime#withWeekyear(int)      // 直接指定周</span><br><span class="line">org.joda.time.DateTime#withMonthOfYear(int)   // 直接指定月</span><br><span class="line">org.joda.time.DateTime#withWeekOfWeekyear(int) // 直接指定周的第几周</span><br><span class="line">org.joda.time.DateTime#withDayOfYear(int)     // 直接指定天</span><br><span class="line">org.joda.time.DateTime#withDayOfMonth(int)    // 直接指定月的第几天</span><br><span class="line"></span><br><span class="line">org.joda.time.DateTime#year()                 // 获取一个property对于year的所有信息</span><br><span class="line">org.joda.time.DateTime#weekyear()</span><br><span class="line">org.joda.time.DateTime#hourOfDay()    </span><br></pre></td></tr></table></figure>

<h3 id="Years"><a href="#Years" class="headerlink" title="Years"></a>Years</h3><p>用于操作年</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">org.joda.time.Years#yearsBetween(org.joda.time.ReadableInstant, org.joda.time.ReadableInstant) // 比较时间相差几年</span><br></pre></td></tr></table></figure>

<h3 id="Months"><a href="#Months" class="headerlink" title="Months"></a>Months</h3><p>用于操作月</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">org.joda.time.Months#monthsBetween(org.joda.time.ReadableInstant, org.joda.time.ReadableInstant) // 比较两个时间相差几个月</span><br></pre></td></tr></table></figure>

<h3 id="Days"><a href="#Days" class="headerlink" title="Days"></a>Days</h3><p>用于对天的操作</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">org.joda.time.Days#daysBetween(org.joda.time.ReadableInstant, org.joda.time.ReadableInstant)   // 计算两个时间相差多少天</span><br><span class="line">org.joda.time.Days#standardDaysIn(org.joda.time.ReadablePeriod) // 获取标准的天</span><br><span class="line">org.joda.time.Days#toStandardWeeks()       // 天转换为周</span><br><span class="line">org.joda.time.Days#toStandardHours()       // 天转换为小时</span><br><span class="line">org.joda.time.Days#toStandardMinutes()     // 天转换为分钟</span><br><span class="line">org.joda.time.Days#toStandardSeconds()     // 天转换为秒</span><br><span class="line">org.joda.time.Days#toStandardDuration()    // 天转换为毫秒</span><br><span class="line"></span><br><span class="line">org.joda.time.Days#plus(int)               // 相加天</span><br><span class="line">org.joda.time.Days#minus(int)              // 减少天</span><br><span class="line">org.joda.time.Days#isGreaterThan(Day)      // 大于天</span><br><span class="line">org.joda.time.Days#isLessThan(Day)         // 小于天</span><br></pre></td></tr></table></figure>

<h3 id="Weeks"><a href="#Weeks" class="headerlink" title="Weeks"></a>Weeks</h3><p>用于周的操作</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">org.joda.time.Weeks#weeksBetween(org.joda.time.ReadableInstant, org.joda.time.ReadableInstant)  // 用于比较两个时间相差多少周</span><br></pre></td></tr></table></figure>

<h3 id="Hours"><a href="#Hours" class="headerlink" title="Hours"></a>Hours</h3><p>用于操作小时</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">org.joda.time.Hours#hoursBetween(org.joda.time.ReadableInstant, org.joda.time.ReadableInstant)  // 用于比较两个时间相差多少小时</span><br></pre></td></tr></table></figure>

<h3 id="Minutes"><a href="#Minutes" class="headerlink" title="Minutes"></a>Minutes</h3><p>用于操作分钟</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">org.joda.time.Minutes#minutesBetween(org.joda.time.ReadableInstant, org.joda.time.ReadableInstant)   // 用于比较两个时间相差多少分钟</span><br></pre></td></tr></table></figure>

<h3 id="Seconds"><a href="#Seconds" class="headerlink" title="Seconds"></a>Seconds</h3><p>用于操作秒</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">org.joda.time.Seconds#secondsBetween(org.joda.time.ReadableInstant, org.joda.time.ReadableInstant) // 用于比较两个时间相差多少秒</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>joda</category>
      </categories>
      <tags>
        <tag>joda-time</tag>
      </tags>
  </entry>
  <entry>
    <title>Apache-BeanUtils</title>
    <url>/2021/05/02/Apache-BeanUtils/</url>
    <content><![CDATA[<p>简介：Apache-common BeanUtil提供了很多的基于类、属性、方法之间的获取和设置的方式</p>
<img src="/2021/05/02/Apache-BeanUtils/propertyUtil.png" style="zoom: 50%;">

<a id="more"></a>

<h2 id="PropertyUtils"><a href="#PropertyUtils" class="headerlink" title="PropertyUtils"></a>PropertyUtils</h2><p><strong><em>本质上是调用PropertyUtilsBean类来实现功能</em></strong></p>
<ol>
<li><p>访问基本数据类型的Bean属性</p>
<ul>
<li><a href="http://commons.apache.org/proper/commons-beanutils/javadocs/v1.9.3/apidocs/org/apache/commons/beanutils/PropertyUtils.html#getSimpleProperty-java.lang.Object-java.lang.String-">PropertyUtils.getSimpleProperty(Object, String)</a></li>
<li><a href="http://commons.apache.org/proper/commons-beanutils/javadocs/v1.9.3/apidocs/org/apache/commons/beanutils/PropertyUtils.html#setSimpleProperty-java.lang.Object-java.lang.String-java.lang.Object-">PropertyUtils.setSimpleProperty(Object, String, Object)</a></li>
</ul>
<p>示例：</p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Employee employee = <span class="keyword">new</span> Employee();</span><br><span class="line">String firstName = (String) PropertyUtils.getSimpleProperty(employee, <span class="string">&quot;firstName&quot;</span>);   <span class="comment">// 获取基本类型属性的值</span></span><br><span class="line">String lastName = (String) PropertyUtils.getSimpleProperty(employee, <span class="string">&quot;lastName&quot;</span>);</span><br><span class="line"></span><br><span class="line">PropertyUtils.setSimpleProperty(employee, <span class="string">&quot;firstName&quot;</span>, firstName);                    <span class="comment">// 设置基本类型的属性值</span></span><br><span class="line">PropertyUtils.setSimpleProperty(employee, <span class="string">&quot;lastName&quot;</span>, lastName);</span><br></pre></td></tr></table></figure>



<ol start="2">
<li>访问索引类型的Bean属性</li>
</ol>
<p>获取bean中含有可索引的属性，如果ArrayList、数组等，可以通过下标索引来访问Bean属性的值，同理也可以设置值</p>
<ul>
<li><a href="http://commons.apache.org/proper/commons-beanutils/javadocs/v1.9.3/apidocs/org/apache/commons/beanutils/PropertyUtils.html#getIndexedProperty-java.lang.Object-java.lang.String-">PropertyUtils.getIndexedProperty(Object, String)</a></li>
<li><a href="http://commons.apache.org/proper/commons-beanutils/javadocs/v1.9.3/apidocs/org/apache/commons/beanutils/PropertyUtils.html#getIndexedProperty-java.lang.Object-java.lang.String-int-">PropertyUtils.getIndexedProperty(Object, String, int)</a></li>
<li><a href="http://commons.apache.org/proper/commons-beanutils/javadocs/v1.9.3/apidocs/org/apache/commons/beanutils/PropertyUtils.html#setIndexedProperty-java.lang.Object-java.lang.String-java.lang.Object-">PropertyUtils.setIndexedProperty(Object, String, Object)</a></li>
<li><a href="http://commons.apache.org/proper/commons-beanutils/javadocs/v1.9.3/apidocs/org/apache/commons/beanutils/PropertyUtils.html#setIndexedProperty-java.lang.Object-java.lang.String-int-java.lang.Object-">PropertyUtils.setIndexedProperty(Object, String, int, Object)</a></li>
</ul>
<p>示例：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Employee employee00 = (Employee) PropertyUtils.getIndexedProperty(indexedBean,<span class="string">&quot;employeeList&quot;</span>, <span class="number">0</span>);  <span class="comment">// 获取indexBean中employeeList中的index=0的元素</span></span><br><span class="line">Employee employee11 = (Employee) PropertyUtils.getIndexedProperty(indexedBean,<span class="string">&quot;employeeList&quot;</span>, <span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>访问Map映射类型的Bean属性</li>
</ol>
<p>获取bean中含有常见的HashMap，TreeMap等，可以通过key来访问Bean属性值，同理可设置value</p>
<ul>
<li><a href="http://commons.apache.org/proper/commons-beanutils/javadocs/v1.9.3/apidocs/org/apache/commons/beanutils/PropertyUtils.html#getMappedProperty-java.lang.Object-java.lang.String-">PropertyUtils.getMappedProperty(Object, String)</a></li>
<li><a href="http://commons.apache.org/proper/commons-beanutils/javadocs/v1.9.3/apidocs/org/apache/commons/beanutils/PropertyUtils.html#getMappedProperty-java.lang.Object-java.lang.String-java.lang.String-">PropertyUtils.getMappedProperty(Object, String, String)</a></li>
<li><a href="http://commons.apache.org/proper/commons-beanutils/javadocs/v1.9.3/apidocs/org/apache/commons/beanutils/PropertyUtils.html#setMappedProperty-java.lang.Object-java.lang.String-java.lang.Object-">PropertyUtils.setMappedProperty(Object, String, Object)</a></li>
<li><a href="http://commons.apache.org/proper/commons-beanutils/javadocs/v1.9.3/apidocs/org/apache/commons/beanutils/PropertyUtils.html#setMappedProperty-java.lang.Object-java.lang.String-java.lang.String-java.lang.Object-">PropertyUtils.setMappedProperty(Object, String, String, Object)</a></li>
</ul>
<p>示例：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">PropertyUtils.setMappedProperty(employee, <span class="string">&quot;mapProperty&quot;</span>, <span class="string">&quot;testKey1&quot;</span>, <span class="string">&quot;testValue1&quot;</span>);</span><br><span class="line">PropertyUtils.setMappedProperty(employee, <span class="string">&quot;mapProperty(testKey2)&quot;</span>, <span class="string">&quot;testValue2&quot;</span>);</span><br></pre></td></tr></table></figure>

<pre><code>4. 访问嵌套类型的Bean属性</code></pre>
<p>获取bean中含有指的是对象内嵌套对象</p>
<ul>
<li><a href="http://commons.apache.org/proper/commons-beanutils/javadocs/v1.9.3/apidocs/org/apache/commons/beanutils/PropertyUtils.html#getNestedProperty-java.lang.Object-java.lang.String-">PropertyUtils.getNestedProperty(Object, String)</a></li>
<li><a href="http://commons.apache.org/proper/commons-beanutils/javadocs/v1.9.3/apidocs/org/apache/commons/beanutils/PropertyUtils.html#setNestedProperty-java.lang.Object-java.lang.String-java.lang.Object-">PropertyUtils.setNestedProperty(Object, String, Object)</a></li>
</ul>
<p>示例：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">String lastName = (String) PropertyUtils.getNestedProperty(nestedBean,<span class="string">&quot;mapProperty(testKey).lastName&quot;</span>);</span><br><span class="line">String lastName2 = (String) PropertyUtils.getNestedProperty(nestedBean,<span class="string">&quot;listProperty[0].lastName&quot;</span>);</span><br></pre></td></tr></table></figure>

<pre><code>5. 访问所有类型的Bean属性</code></pre>
<p>通过以上API的使用，我们了解了各类bean属性的访问方法，其实还有一种通用的方法，适用于各类bean属性类型</p>
<ul>
<li><a href="http://commons.apache.org/proper/commons-beanutils/javadocs/v1.9.3/apidocs/org/apache/commons/beanutils/PropertyUtils.html#getProperty-java.lang.Object-java.lang.String-">PropertyUtils.getProperty(Object, String)</a></li>
<li><a href="http://commons.apache.org/proper/commons-beanutils/javadocs/v1.9.3/apidocs/org/apache/commons/beanutils/PropertyUtils.html#setProperty-java.lang.Object-java.lang.String-java.lang.Object-">PropertyUtils.setProperty(Object, String, Object)</a></li>
</ul>
<p>示例：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">PropertyUtils.setProperty(nestedBean, <span class="string">&quot;listProperty[0].lastName&quot;</span>, <span class="string">&quot;Hello World&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>PropertyUtils依赖于PropertyBeanUtils，其中PropertyBeanUtils中使用到了java.beans包下的 <code>PropertyDescriptor</code></p>
<h2 id="DynaClass-amp-DynaBean"><a href="#DynaClass-amp-DynaBean" class="headerlink" title="DynaClass &amp; DynaBean"></a>DynaClass &amp; DynaBean</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 定义动态属性和类型</span></span><br><span class="line">DynaProperty[] props = <span class="keyword">new</span> DynaProperty[]&#123;</span><br><span class="line">            <span class="keyword">new</span> DynaProperty(<span class="string">&quot;address&quot;</span>, java.util.Map.class),</span><br><span class="line">            <span class="keyword">new</span> DynaProperty(<span class="string">&quot;subordinate&quot;</span>, mypackage.Employee[].class),</span><br><span class="line">            <span class="keyword">new</span> DynaProperty(<span class="string">&quot;firstName&quot;</span>, String.class),</span><br><span class="line">            <span class="keyword">new</span> DynaProperty(<span class="string">&quot;lastName&quot;</span>,  String.class)</span><br><span class="line">          &#125;;</span><br><span class="line"><span class="comment">// 定义动态类，并注入动态属性</span></span><br><span class="line">BasicDynaClass dynaClass = <span class="keyword">new</span> BasicDynaClass(<span class="string">&quot;employee&quot;</span>, <span class="keyword">null</span>, props);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 动态类实例出动态实例对象</span></span><br><span class="line">DynaBean employee = dynaClass.newInstance();</span><br><span class="line"><span class="comment">// 动态实例设置属性值</span></span><br><span class="line">employee.set(<span class="string">&quot;address&quot;</span>, <span class="keyword">new</span> HashMap());</span><br><span class="line">employee.set(<span class="string">&quot;subordinate&quot;</span>, <span class="keyword">new</span> Employee[]&#123;...&#125;);</span><br><span class="line">employee.set(<span class="string">&quot;firstName&quot;</span>, <span class="string">&quot;Fred&quot;</span>);</span><br><span class="line">employee.set(<span class="string">&quot;lastName&quot;</span>, <span class="string">&quot;Flintstone&quot;</span>);</span><br><span class="line"><span class="comment">// 获取动态属性值</span></span><br><span class="line">String firstName = (String) employee.get(<span class="string">&quot;firstName&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>Class 对象 —&gt; class.newInstance 通过类对象实例化一个实例对象<br>constructor 对象 —&gt; constructor.newInstance 同样是实例化一个对象</p>
<h2 id="BasicDynaBean和BasicDynaClass"><a href="#BasicDynaBean和BasicDynaClass" class="headerlink" title="BasicDynaBean和BasicDynaClass"></a>BasicDynaBean和BasicDynaClass</h2><p>先了解下这两个重要的实现，这两个类为DynaBean和DynaClass接口的基础实现类</p>
<p>首先，我们可以这样创建一个<code>DynaClass</code>实例，其中类的成员属性是用<code>DynaProperty</code>类来描述的：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">DynaProperty[] props = <span class="keyword">new</span> DynaProperty[]</span><br><span class="line">        &#123; </span><br><span class="line">            <span class="keyword">new</span> DynaProperty(<span class="string">&quot;address&quot;</span>, java.util.Map.class),</span><br><span class="line">            <span class="keyword">new</span> DynaProperty(<span class="string">&quot;subordinate&quot;</span>, Employee[].class),</span><br><span class="line">            <span class="keyword">new</span> DynaProperty(<span class="string">&quot;firstName&quot;</span>, String.class),</span><br><span class="line">            <span class="keyword">new</span> DynaProperty(<span class="string">&quot;lastName&quot;</span>, String.class) </span><br><span class="line">        &#125;;</span><br><span class="line">BasicDynaClass dynaClass = <span class="keyword">new</span> BasicDynaClass(<span class="string">&quot;employee&quot;</span>, <span class="keyword">null</span>, props);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 注意这里的Class&lt;?&gt; **dynaBeanClass** 参数为空，看下源码就发现，如果为null的话，默认会使用 BasicDynaBean.class；</span></span><br><span class="line"><span class="comment">// 在BasicDyaBean 中保存了一个Hash&lt;String,Object&gt; 用于保存字段名和字段值</span></span><br></pre></td></tr></table></figure>

<h2 id="ResultSetDynaClass"><a href="#ResultSetDynaClass" class="headerlink" title="ResultSetDynaClass"></a>ResultSetDynaClass</h2><p><code>ResultSetDynaClass</code> 继承于 <code>JDBCDynaClass</code> 来处理JDBC的ResultSet结果集，而<code>JDBCDynaClass</code>实现了<code>DynaClass</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">String sql = <span class="string">&quot;SELECT id, name, address, state FROM user&quot;</span>;</span><br><span class="line">stmt = conn.prepareStatement(sql);</span><br><span class="line">ResultSet rs = stmt.executeQuery(sql);</span><br><span class="line"><span class="comment">// **将 ResultSet 结果集包装为 ResultSetDynaClass 类型**</span></span><br><span class="line">Iterator&lt;DynaBean&gt; rows = (<span class="keyword">new</span> ResultSetDynaClass(rs)).iterator();</span><br><span class="line"><span class="keyword">while</span> (rows.hasNext()) &#123;</span><br><span class="line">    DynaBean row = rows.next();</span><br><span class="line">    System.out.print(<span class="string">&quot;id: &quot;</span> + row.get(<span class="string">&quot;id&quot;</span>));</span><br><span class="line">    System.out.print(<span class="string">&quot;, name: &quot;</span> + row.get(<span class="string">&quot;name&quot;</span>));</span><br><span class="line">    System.out.print(<span class="string">&quot;, address: &quot;</span> + row.get(<span class="string">&quot;address&quot;</span>));</span><br><span class="line">    System.out.println(<span class="string">&quot;, state: &quot;</span> + row.get(<span class="string">&quot;state&quot;</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ResultSetDynaClass作为SQL查询结果集中的一个动态bean非常实用，但是仍然有一个严重的缺陷，就是使用ResultSetDynaClass的前提是要保证ResultSet一直处于打开状态，这对于分层结构的Web项目来说是非常不便的，因为我们经常需要将数据从dao层传到service层传到view层，而ResultSet在DAO层使用后往往会关闭掉；</p>
<p>为解决这个问题，引入了RowSetDynaClass实现类，与ResultSetDynaClass不同的是，它会自己在内存中拷贝一份数据，这样就保证了即使ResultSet关闭后，数据也能一直被访问到；不过同样也有缺点就是需要消耗性能用于拷贝数据以及占用堆内存空间；</p>
<h2 id="RowSetDynaClass"><a href="#RowSetDynaClass" class="headerlink" title="RowSetDynaClass"></a>RowSetDynaClass</h2><p><code>RowSetDynaClass</code> 继承于 <code>JDBCDynaClass</code> 来处理JDBC的ResultSet结果集，而<code>JDBCDynaClass</code>实现了<code>DynaClass</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Class.forName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line"></span><br><span class="line">conn = DriverManager.getConnection(DB_URL, USER, PASS);</span><br><span class="line"></span><br><span class="line">String sql = <span class="string">&quot;SELECT id, name, address, state FROM user&quot;</span>;</span><br><span class="line">stmt = conn.prepareStatement(sql);</span><br><span class="line"></span><br><span class="line">ResultSet rs = stmt.executeQuery(sql);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将结果集进行包装</span></span><br><span class="line">RowSetDynaClass rowSet = <span class="keyword">new</span> RowSetDynaClass(rs);</span><br><span class="line"></span><br><span class="line">rs.close();</span><br><span class="line">stmt.close();</span><br><span class="line">conn.close();</span><br><span class="line"></span><br><span class="line">List&lt;DynaBean&gt; rowlist = rowSet.getRows();</span><br><span class="line"><span class="keyword">for</span> (DynaBean row : rowlist) &#123;</span><br><span class="line">    System.out.print(<span class="string">&quot;id: &quot;</span> + row.get(<span class="string">&quot;id&quot;</span>));</span><br><span class="line">    System.out.print(<span class="string">&quot;, name: &quot;</span> + row.get(<span class="string">&quot;name&quot;</span>));</span><br><span class="line">    System.out.print(<span class="string">&quot;, address: &quot;</span> + row.get(<span class="string">&quot;address&quot;</span>));</span><br><span class="line">    System.out.println(<span class="string">&quot;, state: &quot;</span> + row.get(<span class="string">&quot;state&quot;</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="WrapDynaBean和WrapDynaClass"><a href="#WrapDynaBean和WrapDynaClass" class="headerlink" title="WrapDynaBean和WrapDynaClass"></a>WrapDynaBean和WrapDynaClass</h2><p>使用<code>WrapDynaBean</code>，我们可以将普通的<code>javabean</code>包装成<code>DynaBean</code>，并非常简便的使用DynaBean提供的API方法来访问bean成员属性</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Employee e = <span class="keyword">new</span> Employee();</span><br><span class="line">e.setFirstName(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line"></span><br><span class="line">DynaBean wrapper = <span class="keyword">new</span> WrapDynaBean(e);</span><br><span class="line">String firstName = (String) wrapper.get(<span class="string">&quot;firstName&quot;</span>);</span><br><span class="line">System.out.println(firstName);</span><br></pre></td></tr></table></figure>

<h2 id="Lazy-DynaBeans"><a href="#Lazy-DynaBeans" class="headerlink" title="Lazy DynaBeans"></a>Lazy DynaBeans</h2><p>Lazy DynaBeans有如下特性：</p>
<p>1、自动添加bean属性，当我们调用<code>set(name, value)方法时，如果属性不存在，会自动添加该属性；</code></p>
<p>2、List、Array属性自动扩容，</p>
<p>3、List、Array属性里的内部元素可以自动创建，实例化</p>
<p>4、Map属性也可以自动创建，实例化</p>
<p>简单的说，使用Lazy DynaBeans的话，你可以大胆调用DynaBean的set、get方法，而不必担心没有属性不存在，集合数组空间不够等问题，Lazy DynaBeans会帮我们自动处理</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">DynaBean dynaBean = <span class="keyword">new</span> LazyDynaBean();</span><br><span class="line"></span><br><span class="line">dynaBean.set(<span class="string">&quot;foo&quot;</span>, <span class="string">&quot;bar&quot;</span>);                   <span class="comment">// simple</span></span><br><span class="line"></span><br><span class="line">dynaBean.set(<span class="string">&quot;customer&quot;</span>, <span class="string">&quot;title&quot;</span>, <span class="string">&quot;Mr&quot;</span>);      <span class="comment">// mapped</span></span><br><span class="line">dynaBean.set(<span class="string">&quot;customer&quot;</span>, <span class="string">&quot;surname&quot;</span>, <span class="string">&quot;Smith&quot;</span>); <span class="comment">// mapped</span></span><br><span class="line"></span><br><span class="line">dynaBean.set(<span class="string">&quot;users&quot;</span>, <span class="number">0</span>, <span class="keyword">new</span> User());     <span class="comment">// indexed</span></span><br><span class="line">dynaBean.set(<span class="string">&quot;users&quot;</span>, <span class="number">1</span>, <span class="keyword">new</span> User());     <span class="comment">// indexed</span></span><br><span class="line">dynaBean.set(<span class="string">&quot;users&quot;</span>, <span class="number">2</span>, <span class="keyword">new</span> User());     <span class="comment">// indexed</span></span><br><span class="line"></span><br><span class="line">System.out.println(dynaBean.get(<span class="string">&quot;customer&quot;</span>, <span class="string">&quot;title&quot;</span>));</span><br></pre></td></tr></table></figure>

<h2 id="BeanComparator"><a href="#BeanComparator" class="headerlink" title="BeanComparator"></a>BeanComparator</h2><p>用于两个Bean之间指定字段的比较</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 1. 定义需要比较的字段</span></span><br><span class="line"><span class="keyword">final</span> BeanComparator&lt;AlphaBean, String&gt; beanComparator = <span class="keyword">new</span> BeanComparator&lt;&gt;(<span class="string">&quot;name&quot;</span>);</span><br><span class="line"><span class="comment">// 2. 两个bean之间进行比较 ，注意，**bean1和bean2 都不能为null**</span></span><br><span class="line"><span class="keyword">final</span> <span class="keyword">int</span> result = beanComparator.compare(alphaBean1, alphaBean2);</span><br></pre></td></tr></table></figure>

<h2 id="BeanMap"><a href="#BeanMap" class="headerlink" title="BeanMap"></a>BeanMap</h2><p>基于java.beans包下的 <code>Introspector</code>  内省来实现</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">BeanMap beanMap = <span class="keyword">new</span> BeanMap(student);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">org.apache.commons.beanutils2.BeanMap#containsKey(final Object name)    // 判断bean中是否有name属性</span><br><span class="line">org.apache.commons.beanutils2.BeanMap#containsValue(final Object value) // 判断bean中是否有value属性值</span><br><span class="line">org.apache.commons.beanutils2.BeanMap#get(final Object name)            // 获取bean中name属性的值</span><br><span class="line">org.apache.commons.beanutils2.BeanMap#put(final String name, final Object value) // 设置属性和属性值</span><br><span class="line"></span><br><span class="line"><span class="comment">// 原理分析</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">transient</span> HashMap&lt;String, Method&gt; readMethods = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">transient</span> HashMap&lt;String, Method&gt; writeMethods = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">transient</span> HashMap&lt;String, Class&lt;? extends Object&gt;&gt; types = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="comment">// BeanMap中会有三个Map分别用于保存字段的 setXX、getXX、字段类型的方法</span></span><br></pre></td></tr></table></figure>

<h2 id="BeanPredicate"><a href="#BeanPredicate" class="headerlink" title="BeanPredicate"></a>BeanPredicate</h2><p>用于比较bean中字段</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 1.定义比较断言</span></span><br><span class="line"><span class="keyword">final</span> Predicate&lt;String&gt; p = s -&gt; s.equals(<span class="string">&quot;foo&quot;</span>);</span><br><span class="line"><span class="comment">// 2.定义BeanPredicate断言，并指定比较**字段名**</span></span><br><span class="line"><span class="keyword">final</span> BeanPredicate&lt;String&gt; predicate = <span class="keyword">new</span> BeanPredicate&lt;&gt;(<span class="string">&quot;stringProperty&quot;</span>, p);</span><br><span class="line"><span class="comment">// 3.进行比较</span></span><br><span class="line">predicate.test(<span class="keyword">new</span> TestBean(<span class="string">&quot;foo&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="BeanPropertyValueChangeConsumer"><a href="#BeanPropertyValueChangeConsumer" class="headerlink" title="BeanPropertyValueChangeConsumer"></a>BeanPropertyValueChangeConsumer</h2><p>用于bean进行设置属性值</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 1.定义要设置的字段和字段值</span></span><br><span class="line">BeanPropertyValueChangeConsumer consumer = <span class="keyword">new</span> BeanPropertyValueChangeConsumer&lt;&gt;(<span class="string">&quot;floatProperty&quot;</span>, expectedFloatValue)</span><br><span class="line"><span class="comment">// 2.进行设置 --&gt; PropertyUtils.setProperty(object, propertyName, propertyValue);</span></span><br><span class="line">consumer.accept(testBean)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 基于数组的设置</span></span><br><span class="line"><span class="keyword">new</span> BeanPropertyValueChangeConsumer&lt;&gt;(<span class="string">&quot;intIndexed[0]&quot;</span>, expectedIntegerValue).accept(testBean);</span><br><span class="line"><span class="comment">// 基于map的设置</span></span><br><span class="line"><span class="keyword">new</span> BeanPropertyValueChangeConsumer&lt;&gt;(<span class="string">&quot;mappedProperty(fred)&quot;</span>, <span class="string">&quot;barney&quot;</span>).accept(testBean);</span><br><span class="line"><span class="comment">// 基于内嵌对象的设置</span></span><br><span class="line"><span class="keyword">new</span> BeanPropertyValueChangeConsumer&lt;&gt;(<span class="string">&quot;nested.stringProperty&quot;</span>, <span class="string">&quot;bar&quot;</span>).accept(testBean);</span><br></pre></td></tr></table></figure>

<h2 id="BeanPropertyValueEqualsPredicate"><a href="#BeanPropertyValueEqualsPredicate" class="headerlink" title="BeanPropertyValueEqualsPredicate"></a>BeanPropertyValueEqualsPredicate</h2><p>用于bean的属性值之间的比较，但与<code>BeanPredicate</code> 的区别是<code>BeanPropertyValueEqualsPredicate</code> 的比较是使用<code>Object.equal</code> 方法，没有<code>BeanPredicate</code> 的灵活</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 1.定义属性和属性值</span></span><br><span class="line">BeanPropertyValueEqualsPredicate&lt;TestBean, String&gt; predicate = <span class="keyword">new</span> BeanPropertyValueEqualsPredicate&lt;&gt;(<span class="string">&quot;stringProperty&quot;</span>,<span class="string">&quot;foo&quot;</span>);</span><br><span class="line"><span class="comment">// 2.进行比较</span></span><br><span class="line">predicate.test(<span class="keyword">new</span> TestBean(<span class="string">&quot;foo&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 基于数组比较</span></span><br><span class="line">BeanPropertyValueEqualsPredicate&lt;TestBean, Object&gt; predicate = <span class="keyword">new</span> BeanPropertyValueEqualsPredicate&lt;&gt;(<span class="string">&quot;intIndexed[0]&quot;</span>,expectedIntegerValue);</span><br><span class="line">predicate.test(testBean)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 基于map比较</span></span><br><span class="line">BeanPropertyValueEqualsPredicate&lt;TestBean, String&gt; predicate = <span class="keyword">new</span> BeanPropertyValueEqualsPredicate&lt;&gt;(<span class="string">&quot;mappedProperty(key)&quot;</span>, <span class="string">&quot;match&quot;</span>);</span><br><span class="line">predicate.test(testBean)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 基于内嵌对象比较</span></span><br><span class="line">BeanPropertyValueEqualsPredicate&lt;TestBean, String&gt; predicate = <span class="keyword">new</span> BeanPropertyValueEqualsPredicate&lt;&gt;(<span class="string">&quot;anotherNested.stringProperty&quot;</span>,<span class="string">&quot;foo&quot;</span>);</span><br><span class="line">predicate.test(testBean)</span><br></pre></td></tr></table></figure>

<h2 id="BeanToPropertyValueTransformer"><a href="#BeanToPropertyValueTransformer" class="headerlink" title="BeanToPropertyValueTransformer"></a>BeanToPropertyValueTransformer</h2><p>用于获取bean的属性对应的属性值</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 1.定义属性</span></span><br><span class="line">BeanToPropertyValueTransformer&lt;TestBean, String&gt; transformer = <span class="keyword">new</span> BeanToPropertyValueTransformer&lt;&gt;(<span class="string">&quot;stringProperty&quot;</span>);</span><br><span class="line"><span class="comment">// 2.获取属性值</span></span><br><span class="line">TestBean testBean = <span class="keyword">new</span> TestBean(<span class="string">&quot;foo&quot;</span>)</span><br><span class="line">transformer.apply(testBean)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取数组</span></span><br><span class="line">BeanToPropertyValueTransformer&lt;TestBean, Integer&gt; transformer = <span class="keyword">new</span> BeanToPropertyValueTransformer&lt;&gt;(<span class="string">&quot;intIndexed[0]&quot;</span>)</span><br><span class="line">transformer.apply(testBean)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取map</span></span><br><span class="line">BeanToPropertyValueTransformer&lt;TestBean, String&gt; transformer = <span class="keyword">new</span> BeanToPropertyValueTransformer&lt;&gt;(<span class="string">&quot;mappedProperty(key)&quot;</span>)</span><br><span class="line">transformer.apply(testBean)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取内嵌对象</span></span><br><span class="line">BeanToPropertyValueTransformer&lt;TestBean, String&gt; transformer = <span class="keyword">new</span> BeanToPropertyValueTransformer&lt;&gt;(<span class="string">&quot;anotherNested.stringProperty&quot;</span>)</span><br><span class="line">transformer.apply(testBean)</span><br></pre></td></tr></table></figure>

<h2 id="Resolver"><a href="#Resolver" class="headerlink" title="Resolver"></a>Resolver</h2><p>用于对bean中的属性进行解析，可以识别数组、map、内嵌对象。默认的实现是<code>DefaultResolver</code>  其中 <code>PropertyUtilsBean</code> 就是通过这个类来解析bean的属性表达式的</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 内嵌对象的识别  --&gt; name1.name2.name3</span></span><br><span class="line"><span class="comment">// 数组的识别     --&gt; name[index]</span></span><br><span class="line"><span class="comment">// map的识别     --&gt; name(key)</span></span><br><span class="line"></span><br><span class="line">Resolver resolver = <span class="keyword">new</span> DefaultResolver()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">org.apache.commons.beanutils2.expression.DefaultResolver#getIndex      // 获取指定索引下的值</span><br><span class="line">org.apache.commons.beanutils2.expression.DefaultResolver#getKey        // 获取map下的key</span><br><span class="line">org.apache.commons.beanutils2.expression.DefaultResolver#getProperty   // 获取属性</span><br><span class="line">org.apache.commons.beanutils2.expression.DefaultResolver#hasNested     // 判断是否是内嵌对象</span><br><span class="line">org.apache.commons.beanutils2.expression.DefaultResolver#isIndexed     // 判断是否是数组</span><br><span class="line">org.apache.commons.beanutils2.expression.DefaultResolver#isMapped      // 判断是否是map</span><br></pre></td></tr></table></figure>

<h2 id="BeanUtils和BeanUtilsBean"><a href="#BeanUtils和BeanUtilsBean" class="headerlink" title="BeanUtils和BeanUtilsBean"></a>BeanUtils和BeanUtilsBean</h2><p>BeanUtils中都是静态的方法，每个方法都是调用BeanUtilsBean中的方法并且BeanUtilsBean中定义为单例模式</p>
<p>BeanUtilsBean的单例模式是通过 (thread) context Classloader 来实现的<br>BeanUtilBean是依赖于 <code>ConvertUtilsBean</code> 和 <code>PropertyUtilsBean</code></p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">org.apache.commons.beanutils2.BeanUtilsBean#cloneBean       // 克隆一个新Bean</span><br><span class="line">org.apache.commons.beanutils2.BeanUtilsBean#copyProperties  // 源目对象复制</span><br><span class="line">org.apache.commons.beanutils2.BeanUtilsBean#copyProperty    // 仅复制对象的某个属性</span><br><span class="line">org.apache.commons.beanutils2.BeanUtilsBean#describe        // 将bean转换为一个Map&lt;属性名,属性值&gt;</span><br><span class="line">org.apache.commons.beanutils2.BeanUtilsBean#populate        // 填充bean</span><br></pre></td></tr></table></figure>

<h2 id="ConstructorUtils"><a href="#ConstructorUtils" class="headerlink" title="ConstructorUtils"></a>ConstructorUtils</h2><p>用于类对象利用反射方式实例化一个对象</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">final</span> Object obj = ConstructorUtils.invokeConstructor(TestBean.class,<span class="string">&quot;TEST&quot;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="ConvertUtils和ConvertUtilsBean"><a href="#ConvertUtils和ConvertUtilsBean" class="headerlink" title="ConvertUtils和ConvertUtilsBean"></a>ConvertUtils和ConvertUtilsBean</h2><p>用于数据类型之间的转换，<code>ConvertUtilsBean</code>的构造方法中 <code>deregister()</code>  方法会加载<code>**88**</code>个默认的类型转换器类</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 1.字符串数组转换为包装类型的数组</span></span><br><span class="line"><span class="keyword">final</span> String[] values1 = &#123; <span class="string">&quot;10&quot;</span>, <span class="string">&quot;20&quot;</span>, <span class="string">&quot;30&quot;</span> &#125;;</span><br><span class="line">Object value = ConvertUtils.convert(values1, Integer.TYPE);    <span class="comment">// &#123;10,20,30&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.包装类型转换为字符串数组类型</span></span><br><span class="line"><span class="keyword">final</span> <span class="keyword">int</span>[] intArray1 = <span class="keyword">new</span> <span class="keyword">int</span>[] &#123; <span class="number">0</span> &#125;;</span><br><span class="line">Object value = ConvertUtils.convert(intArray1, String[].class);  <span class="comment">// String[] 看做是一个类</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.字符串转换为时间类型</span></span><br><span class="line">String input = <span class="string">&quot;2002-03-17&quot;</span>;</span><br><span class="line">Object value = ConvertUtils.convert(input, Date.class);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4.自定义转换类型</span></span><br><span class="line"><span class="keyword">final</span> ConvertUtilsBean utils = <span class="keyword">new</span> ConvertUtilsBean();</span><br><span class="line">utils.register(dateConverter, java.util.Date.class);</span><br><span class="line">utils.convert(today, String.class)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 原理：ConvertUtilBean中有一个WeakFastHashMap对象用于保存数据类型和之间的转换映射关系</span></span><br></pre></td></tr></table></figure>

<h2 id="MethodUtils"><a href="#MethodUtils" class="headerlink" title="MethodUtils"></a>MethodUtils</h2><p>用于进行method的反射调用，MethodUtils中有一个<code>WeakHashMap</code> 类型的map来保存method的缓存</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">final</span> Method method = MethodUtils.getAccessibleMethod(TestBean.class, <span class="string">&quot;setStringProperty&quot;</span>, String.class);</span><br><span class="line"><span class="keyword">final</span> Object result = MethodUtils.invokeExactMethod(</span><br><span class="line">                <span class="keyword">new</span> AlphaBean(<span class="string">&quot;parent&quot;</span>),</span><br><span class="line">                <span class="string">&quot;getName&quot;</span>,</span><br><span class="line">                <span class="keyword">null</span>,</span><br><span class="line">                <span class="keyword">null</span>);</span><br></pre></td></tr></table></figure>

<h2 id="WeakFastHashMap"><a href="#WeakFastHashMap" class="headerlink" title="WeakFastHashMap"></a>WeakFastHashMap</h2><p>类似于 <code>CopyOnWriteArrayList</code> 的机制，其中通过fast字段来判断是否加锁，在读操作的时候不加锁，写操作的时候加锁</p>
]]></content>
      <categories>
        <category>apache-common</category>
      </categories>
      <tags>
        <tag>apache-common-beanutils</tag>
      </tags>
  </entry>
  <entry>
    <title>Apache-lang</title>
    <url>/2021/05/04/Apache-lang/</url>
    <content><![CDATA[<p>简介：Apache-common lang 提供了很多的Utils类，供于日常开发中进行使用</p>
<img src="/2021/05/04/Apache-lang/lang.png" style="zoom: 50%;">

<a id="more"></a>

<h2 id="AnnotationUtils"><a href="#AnnotationUtils" class="headerlink" title="AnnotationUtils"></a>AnnotationUtils</h2><p>用于操作注解类型</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 这里会判断注解的类型以及注解中的方法的值是否完全一致</span></span><br><span class="line">AnnotationUtils.equals(field1.getAnnotation(TestAnnotation.class), field2.getAnnotation(TestAnnotation.class))</span><br></pre></td></tr></table></figure>

<h2 id="ArraySorter"><a href="#ArraySorter" class="headerlink" title="ArraySorter"></a>ArraySorter</h2><p>用于数组进行排序，本质就是调用 <code>Arrays.sort(array)</code>; 方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="keyword">byte</span>[] array1 = &#123;<span class="number">2</span>, <span class="number">1</span>&#125;;</span><br><span class="line">ArraySorter.sort(array1)</span><br></pre></td></tr></table></figure>

<h2 id="ArrayUtils"><a href="#ArrayUtils" class="headerlink" title="ArrayUtils"></a>ArrayUtils</h2><p>用于操作数组</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">org.apache.commons.lang3.ArrayUtils#add(boolean[], boolean)       // 数组中新增元素</span><br><span class="line">org.apache.commons.lang3.ArrayUtils#addAll(boolean[], boolean...) // 将一个数组中的元素全部添加到另一个数组中</span><br><span class="line">org.apache.commons.lang3.ArrayUtils#addFirst(boolean[], boolean)  // 添加到数组开头</span><br><span class="line">org.apache.commons.lang3.ArrayUtils#contains(boolean[], boolean)  // 判断数组中是否包含这个元素</span><br><span class="line">org.apache.commons.lang3.ArrayUtils#get(T[], int, T)              // 获取指定index的数组元素</span><br><span class="line">org.apache.commons.lang3.ArrayUtils#indexesOf(boolean[], boolean) // 查询元素是否存在于数组中</span><br><span class="line">org.apache.commons.lang3.ArrayUtils#insert(int, byte[], byte...)  // 指定位置查询数组元素</span><br><span class="line">org.apache.commons.lang3.ArrayUtils#isArrayIndexValid(T[], int)   // 判断索引是否越界</span><br><span class="line">org.apache.commons.lang3.ArrayUtils#isEmpty(boolean[])            // 判断数组是否为空</span><br><span class="line">org.apache.commons.lang3.ArrayUtils#isSorted(boolean[])           // 判断数组是否自然排序</span><br><span class="line">org.apache.commons.lang3.ArrayUtils#remove(boolean[], int)        // 删除数组中指定索引的元素</span><br><span class="line">org.apache.commons.lang3.ArrayUtils#removeAll(double[], int...)   // 删除数组中指定多个索引的元素</span><br><span class="line">org.apache.commons.lang3.ArrayUtils#removeElement(boolean[], boolean)  // 删除指定元素</span><br><span class="line">org.apache.commons.lang3.ArrayUtils#reverse(boolean[])            // 数组逆序排序</span><br><span class="line">org.apache.commons.lang3.ArrayUtils#shuffle(boolean[])            // 打乱数组元素位置</span><br><span class="line">org.apache.commons.lang3.ArrayUtils#subarray(boolean[], int, int) // 截取数组</span><br><span class="line">org.apache.commons.lang3.ArrayUtils#swap(boolean[], int, int)     // 数组中元素位置进行交换</span><br><span class="line">org.apache.commons.lang3.ArrayUtils#toMap(Object[])               // 将二维数组或Map.entry转换为Map</span><br><span class="line">org.apache.commons.lang3.ArrayUtils#toPrimitive(java.lang.Boolean[]) // 将保证类型转换为基本类型</span><br></pre></td></tr></table></figure>

<h2 id="BooleanUtils"><a href="#BooleanUtils" class="headerlink" title="BooleanUtils"></a>BooleanUtils</h2><p>用于操作Boolean类型</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">org.apache.commons.lang3.BooleanUtils#and(boolean...)      // 聚合比较</span><br><span class="line">org.apache.commons.lang3.BooleanUtils#booleanValues()      // 获取boolean数组的所有取值</span><br><span class="line">org.apache.commons.lang3.BooleanUtils#isFalse(Boolean)     // 判断是否为false</span><br><span class="line">org.apache.commons.lang3.BooleanUtils#or(boolean...)       // 判断只要有一个true就是true</span><br><span class="line">org.apache.commons.lang3.BooleanUtils#toBoolean(java.lang.Boolean) // 将包装类型转换为基本数据类型</span><br><span class="line">org.apache.commons.lang3.BooleanUtils#toBoolean(java.lang.String)  // 将字符串转为boolean类型</span><br><span class="line">org.apache.commons.lang3.BooleanUtils#toInteger(boolean)   // 将boolean类型转换未integer类型(true: 1 false: 0)</span><br><span class="line">org.apache.commons.lang3.BooleanUtils#toInteger(boolean, int, int) // 转换指定的数值</span><br><span class="line">org.apache.commons.lang3.BooleanUtils#toString(boolean, java.lang.String, java.lang.String) // boolean类型转换为string类型</span><br></pre></td></tr></table></figure>

<h2 id="CharSequenceUtils"><a href="#CharSequenceUtils" class="headerlink" title="CharSequenceUtils"></a>CharSequenceUtils</h2><p>用于操作字符串或者字符类型</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">org.apache.commons.lang3.CharSequenceUtils#subSequence      // 进行字符串的截取等效于**String#substring(int)**</span><br><span class="line">org.apache.commons.lang3.CharSequenceUtils#indexOf(java.lang.CharSequence, int, int) // 查询字符串中是否存在这个字符</span><br><span class="line">org.apache.commons.lang3.CharSequenceUtils#toCharArray      // 字符串转数组</span><br></pre></td></tr></table></figure>

<h2 id="CharSetUtils"><a href="#CharSetUtils" class="headerlink" title="CharSetUtils"></a>CharSetUtils</h2><p>用于操作字符</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">org.apache.commons.lang3.CharSetUtils#containsAny(String,String...)   // 判断字符串中是否还有给定的字符范围</span><br><span class="line">org.apache.commons.lang3.CharSetUtils#count(String,String...)         // 统计字符串中含有给定字符范围的个数</span><br><span class="line">org.apache.commons.lang3.CharSetUtils#delete(String,String...)        // 删除字符串中含有的字符</span><br><span class="line">org.apache.commons.lang3.CharSetUtils#keep(String,String...)          // 只保留给定的字符</span><br></pre></td></tr></table></figure>

<h2 id="CharUtils"><a href="#CharUtils" class="headerlink" title="CharUtils"></a>CharUtils</h2><p>用于进行字符操作</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">org.apache.commons.lang3.CharUtils#isAscii        // 判断是否是ascii码</span><br></pre></td></tr></table></figure>

<h2 id="ClassPathUtils"><a href="#ClassPathUtils" class="headerlink" title="ClassPathUtils"></a>ClassPathUtils</h2><p>用于获取classpath的路径名</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 获取这个类的全限定类名</span></span><br><span class="line"><span class="comment">// ClassPathUtils.toFullyQualifiedName(StringUtils.class, &quot;StringUtils.properties&quot;) = &quot;org.apache.commons.lang3.StringUtils.properties&quot;</span></span><br><span class="line">org.apache.commons.lang3.ClassPathUtils#toFullyQualifiedName(java.lang.Class&lt;?&gt;, java.lang.String)  </span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取这个类的路径名</span></span><br><span class="line"><span class="comment">// ClassPathUtils.toFullyQualifiedPath(StringUtils.class, &quot;StringUtils.properties&quot;) = &quot;org/apache/commons/lang3/StringUtils.properties&quot;</span></span><br><span class="line">org.apache.commons.lang3.ClassPathUtils#toFullyQualifiedPath(java.lang.Class&lt;?&gt;, java.lang.String)</span><br></pre></td></tr></table></figure>

<h2 id="ClassUtils"><a href="#ClassUtils" class="headerlink" title="ClassUtils"></a>ClassUtils</h2><p>用于对class操作</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">org.apache.commons.lang3.ClassUtils#getShortClassName(java.lang.Class&lt;?&gt;)    // 获取短的类名</span><br><span class="line">org.apache.commons.lang3.ClassUtils#getSimpleName(java.lang.Class&lt;?&gt;)        // 获取简单类名</span><br><span class="line">org.apache.commons.lang3.ClassUtils#getName(java.lang.Class&lt;?&gt;)              // 获取类的全类名</span><br><span class="line">org.apache.commons.lang3.ClassUtils#getPackageName(java.lang.Class&lt;?&gt;)       // 获取类的包名</span><br><span class="line">org.apache.commons.lang3.ClassUtils#getAbbreviatedName(java.lang.Class&lt;?&gt;, int)   // 获取缩写的名字</span><br><span class="line">org.apache.commons.lang3.ClassUtils#getAllSuperclasses(java.lang.Class&lt;?&gt;)   // 获取指定类的所有父类</span><br><span class="line">org.apache.commons.lang3.ClassUtils#getAllInterfaces(java.lang.Class&lt;?&gt;)     // 获取当前类所有的接口</span><br><span class="line">org.apache.commons.lang3.ClassUtils#convertClassNamesToClasses(List&lt;String&gt;) // 将clasName转化为class类</span><br><span class="line">org.apache.commons.lang3.ClassUtils#convertClassesToClassNames(List&lt;Class&lt;?&gt;&gt;) //将class类转换为className名</span><br><span class="line">org.apache.commons.lang3.ClassUtils#isAssignable(java.lang.Class&lt;?&gt;[], java.lang.Class&lt;?&gt;...) // 一个类是否可以属于另一个了类增加了对保证类型的封装</span><br><span class="line">ClassUtils.isAssignable(Boolean.TYPE, Boolean.class, <span class="keyword">false</span>)    <span class="comment">// 关闭自动拆装箱</span></span><br><span class="line"></span><br><span class="line">org.apache.commons.lang3.ClassUtils#isPrimitiveOrWrapper(Class&lt;?&gt;)           // 判断是否是基本数据类型还是包装类型</span><br><span class="line">org.apache.commons.lang3.ClassUtils#primitiveToWrapper(Class&lt;?&gt;)             // 基本数据类型的class转换为包装类型的class</span><br><span class="line">org.apache.commons.lang3.ClassUtils#wrapperToPrimitive(Class&lt;?&gt;)             // 包装类型的class转换为基本数据类型的class</span><br><span class="line"></span><br><span class="line">org.apache.commons.lang3.ClassUtils#isInnerClass(Class&lt;?&gt;)                   // 判断是否是内部类</span><br><span class="line">org.apache.commons.lang3.ClassUtils#getPublicMethod(Class&lt;?&gt;, String, Class&lt;?&gt;...)  // 获取指定类中public的方法包含继承和实现的</span><br><span class="line"></span><br><span class="line">org.apache.commons.lang3.ClassUtils#getCanonicalName(java.lang.Class&lt;?&gt;)     //获取一个标准的类名</span><br><span class="line">ClassUtils.getCanonicalName(String[][][][].class, <span class="string">&quot;X&quot;</span>)     <span class="comment">// java.lang.String[][][][]</span></span><br><span class="line">ClassUtils.getCanonicalName(<span class="keyword">boolean</span>[].class)               <span class="comment">// boolean[]</span></span><br><span class="line"></span><br><span class="line">org.apache.commons.lang3.ClassUtils#getPackageCanonicalName(java.lang.Class&lt;?&gt;) // 返回一个标准的包名</span><br><span class="line">ClassUtils.getPackageCanonicalName(ClassUtils.class)                            <span class="comment">// org.apache.commons.lang3</span></span><br></pre></td></tr></table></figure>

<h2 id="EnumUtils"><a href="#EnumUtils" class="headerlink" title="EnumUtils"></a>EnumUtils</h2><p>用于对枚举的操作</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">org.apache.commons.lang3.EnumUtils#getEnum(java.lang.Class&lt;E&gt;, java.lang.String)  // 获取指定的枚举</span><br><span class="line">org.apache.commons.lang3.EnumUtils#getEnumIgnoreCase(java.lang.Class&lt;E&gt;, java.lang.String) // 忽略字母大小写获取枚举</span><br><span class="line">org.apache.commons.lang3.EnumUtils#getEnumList(java.lang.Class&lt;E&gt;)       // 获取枚举集合</span><br><span class="line">org.apache.commons.lang3.EnumUtils#getEnumMap(java.lang.Class&lt;E&gt;)        // 获取枚举Map</span><br><span class="line">org.apache.commons.lang3.EnumUtils#isValidEnum(java.lang.Class&lt;E&gt;)       // 验证是否存在此枚举项</span><br><span class="line">org.apache.commons.lang3.EnumUtils#isValidEnumIgnoreCase(java.lang.Class&lt;E&gt;) // 忽略大小写验证是否存在此枚举项</span><br></pre></td></tr></table></figure>

<p>Enum.valueOf(enumClass, enumName)<br>java.lang.Class#getEnumConstants        获取枚举常量</p>
<h2 id="ObjectUtils"><a href="#ObjectUtils" class="headerlink" title="ObjectUtils"></a>ObjectUtils</h2><p>对Object对象的操作</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">org.apache.commons.lang3.ObjectUtils#allNull(Object...)    // 判断所有的值都是null</span><br><span class="line">org.apache.commons.lang3.ObjectUtils#allNotNull(Object...) // 判断所有的值都不为null</span><br><span class="line">org.apache.commons.lang3.ObjectUtils#anyNull(Object...)    // 是否存在任意一个为null的值</span><br><span class="line">org.apache.commons.lang3.ObjectUtils#anyNotNull(Object...) // 是否存在任意一个不为null的</span><br><span class="line">org.apache.commons.lang3.ObjectUtils#compare(T, T)         // 比较两个Comparable的实现类</span><br><span class="line">org.apache.commons.lang3.ObjectUtils#defaultIfNull(T,T)    // 判断一个值是否为null,如果为null则返回defaultValue值</span><br><span class="line">org.apache.commons.lang3.ObjectUtils#firstNonNull(T...)    // 返回第一个不为null的值</span><br><span class="line">org.apache.commons.lang3.ObjectUtils#getIfNull(T,Supplier) // 如果值为null，则执行supplier</span><br><span class="line">org.apache.commons.lang3.ObjectUtils#identityToString(java.lang.Object) // 返回对象的hash值</span><br><span class="line">org.apache.commons.lang3.ObjectUtils#isEmpty(Object)       // 判断object是否是空</span><br><span class="line">org.apache.commons.lang3.ObjectUtils#isNotEmpty(Object)    // 判断object是否不是空</span><br><span class="line">org.apache.commons.lang3.ObjectUtils#max(T...)             // 找出数组中最大的</span><br><span class="line">org.apache.commons.lang3.ObjectUtils#median(java.util.Comparator&lt;T&gt;, T...)   // 找出中间的数字</span><br><span class="line">org.apache.commons.lang3.ObjectUtils#min(T...)             // 找出数组中最小值</span><br><span class="line">org.apache.commons.lang3.ObjectUtils#notEqual(T,T)         // 两个值不相等</span><br></pre></td></tr></table></figure>

<p><code>hashCode</code>和<code>identityHashCode</code>区别？<br>如果对象没有重写hashCode方法，则两者是一样的，如果重写了<code>hashCode</code>方法调用hashCode方法的时候会使用重写的，而<code>identityHashCode</code>则是一直不会改变的</p>
<h2 id="RandomStringUtils"><a href="#RandomStringUtils" class="headerlink" title="RandomStringUtils"></a>RandomStringUtils</h2><p>用于获取随机字符串</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">org.apache.commons.lang3.RandomStringUtils#random(int)          // 产生n位长度的随机字符串，中文环境下是乱码</span><br><span class="line">org.apache.commons.lang3.RandomStringUtils#randomNumeric(int)   // 获取n位的数字字符串</span><br><span class="line">org.apache.commons.lang3.RandomStringUtils#random(int, java.lang.String)   // 在string中获取返回n位的字符串</span><br><span class="line">org.apache.commons.lang3.RandomStringUtils#random(int, char...) // 在指定字符范围中获取n位的字符串</span><br><span class="line"></span><br><span class="line">RandomStringUtils.random(<span class="number">9</span>,<span class="string">&quot;abcdefg&quot;</span>)     <span class="comment">// fdfgfadbf</span></span><br><span class="line">RandomStringUtils.random(<span class="number">5</span>, <span class="keyword">new</span> <span class="keyword">char</span>[]&#123;<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;e&#x27;</span>,<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;3&#x27;</span>&#125;) </span><br></pre></td></tr></table></figure>

<h2 id="RandomUtils"><a href="#RandomUtils" class="headerlink" title="RandomUtils"></a>RandomUtils</h2><p>用于随机数的获取</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">org.apache.commons.lang3.RandomUtils#nextInt(int, int)      // 返回一个指定范围的随机数</span><br></pre></td></tr></table></figure>

<h2 id="Range"><a href="#Range" class="headerlink" title="Range"></a>Range</h2><p>用于范围的操作</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">org.apache.commons.lang3.Range#between(T, T)            // 返回一个范围内的对象，默认进行自然排序比较两个数谁是最小值或最大值</span><br><span class="line">org.apache.commons.lang3.Range#contains(T)              // 范围内是否包含这个值</span><br><span class="line">org.apache.commons.lang3.Range#containsRange(Range&lt;T&gt;)  // 范围内释放包含另一个范围</span><br><span class="line">org.apache.commons.lang3.Range#elementCompareTo(T)      // 判断指定元素在范围的左侧还是右侧</span><br><span class="line">org.apache.commons.lang3.Range#intersectionWith(Range&lt;T&gt;) // 两个范围内的交集</span><br><span class="line">org.apache.commons.lang3.Range#isAfter(T)               // 指定元素小于最小值</span><br><span class="line">org.apache.commons.lang3.Range#isBefore(T)              // 指定元素大于最大值</span><br><span class="line">org.apache.commons.lang3.Range#isEndedBy(T)             // 指定元素等于最大值</span><br><span class="line">org.apache.commons.lang3.Range#isStartedBy(T)           // 指定元素等于最小值</span><br><span class="line">org.apache.commons.lang3.Range#isOverlappedBy(Range&lt;T&gt;) // 判断两个Range是否有重叠部分</span><br><span class="line">org.apache.commons.lang3.Range#fit(T)                   // 返回当前元素、最小值、最大值</span><br></pre></td></tr></table></figure>

<h2 id="RegExUtils"><a href="#RegExUtils" class="headerlink" title="RegExUtils"></a>RegExUtils</h2><p>用于处理正则表达式</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">org.apache.commons.lang3.RegExUtils#removeAll(java.lang.String, java.util.regex.Pattern)  // 删除匹配到的所有</span><br><span class="line">org.apache.commons.lang3.RegExUtils#removeFirst(java.lang.String, java.util.regex.Pattern) // 删除匹配到的第一个</span><br><span class="line">org.apache.commons.lang3.RegExUtils#replaceAll(java.lang.String, java.util.regex.Pattern, java.lang.String) // 替换所有</span><br><span class="line">org.apache.commons.lang3.RegExUtils#replaceFirst(java.lang.String, java.util.regex.Pattern, java.lang.String) // 替换第一个</span><br></pre></td></tr></table></figure>

<h2 id="SerializationUtils"><a href="#SerializationUtils" class="headerlink" title="SerializationUtils"></a>SerializationUtils</h2><p>用于用对象流进行序列化与反序列化</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">org.apache.commons.lang3.SerializationUtils#serialize(java.io.Serializable) // 序列化</span><br><span class="line">org.apache.commons.lang3.SerializationUtils#deserialize(byte[])             // 反序列化</span><br></pre></td></tr></table></figure>

<h2 id="StringUtils"><a href="#StringUtils" class="headerlink" title="StringUtils"></a>StringUtils</h2><p>用于字符串之间的操作</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line"><span class="comment">// StringUtils.abbreviate(&quot;abcdefg&quot;, 6) = &quot;abc...&quot;</span></span><br><span class="line">org.apache.commons.lang3.StringUtils#abbreviate(java.lang.String, int)   // 缩写字符串</span><br><span class="line">org.apache.commons.lang3.StringUtils#appendIfMissingIgnoreCase(String,CharSequence,CharSequence...)  // 忽略大小写的拼接</span><br><span class="line">org.apache.commons.lang3.StringUtils#capitalize(String)                  // 首字母大写</span><br><span class="line">org.apache.commons.lang3.StringUtils#center(java.lang.String, int)       // 以string为中心，填充固定长度不够用空串表示</span><br><span class="line">org.apache.commons.lang3.StringUtils#chomp(java.lang.String)             // 移除转义符 \r \n \r\n</span><br><span class="line">org.apache.commons.lang3.StringUtils#chop(java.lang.String)              // 移除最后一个元素，如果是\r\n都会一起删除</span><br><span class="line">org.apache.commons.lang3.StringUtils#compare(java.lang.String, java.lang.String) // 字符串之间的比较</span><br><span class="line">org.apache.commons.lang3.StringUtils#compareIgnoreCase(java.lang.String, java.lang.String) // 忽略大小写比较</span><br><span class="line">org.apache.commons.lang3.StringUtils#contains(java.lang.CharSequence, java.lang.CharSequence) // 字符是否包含另一个字符</span><br><span class="line">org.apache.commons.lang3.StringUtils#containsAny(java.lang.CharSequence, char...)  // 字符是否包含其中任意一个</span><br><span class="line">org.apache.commons.lang3.StringUtils#containsNone(java.lang.CharSequence, char...) // 字符不包含任意一个</span><br><span class="line">org.apache.commons.lang3.StringUtils#containsWhitespace(java.lang.CharSequence)    // 检查是否包含空白字符</span><br><span class="line">org.apache.commons.lang3.StringUtils#countMatches(java.lang.CharSequence, char)    // 统计有几个字符匹配</span><br><span class="line">org.apache.commons.lang3.StringUtils#defaultIfBlank(T,T)                  // 为空置为defaultValue</span><br><span class="line">org.apache.commons.lang3.StringUtils#deleteWhitespace(String)             // 删除空白</span><br><span class="line">org.apache.commons.lang3.StringUtils#difference(String,String)            // 比较两个字符串不同的，返回str2不同的部分</span><br><span class="line">org.apache.commons.lang3.StringUtils#endsWith(java.lang.CharSequence, java.lang.CharSequence) // 以什么字符结尾</span><br><span class="line">org.apache.commons.lang3.StringUtils#endsWithAny(java.lang.CharSequence, java.lang.CharSequence) // 以任意字符结尾</span><br><span class="line">org.apache.commons.lang3.StringUtils#firstNonBlank(T...)                  // 返回一个不为null的值</span><br><span class="line">org.apache.commons.lang3.StringUtils#getCommonPrefix(T...)                // 获取字符串中公共的前缀</span><br><span class="line">org.apache.commons.lang3.StringUtils#getDigits(String)                    // 返回字符串中的数字</span><br><span class="line">org.apache.commons.lang3.StringUtils#getIfBlank(String,Supplier)          // 如果str是空，则执行supplier</span><br><span class="line">org.apache.commons.lang3.StringUtils#indexOf(java.lang.CharSequence, java.lang.CharSequence) // 返回指定字符所在的索引位置</span><br><span class="line">org.apache.commons.lang3.StringUtils#indexOfDifference(java.lang.CharSequence...)  // 字符串不同时候开始的索引位置</span><br><span class="line">org.apache.commons.lang3.StringUtils#isAllLowerCase(T...)                 // 全部是大写</span><br><span class="line">org.apache.commons.lang3.StringUtils#isNumeric(String)                    // 是否是数字</span><br><span class="line">org.apache.commons.lang3.StringUtils#join(boolean[], char)                // 将数组转换为字符串，通过分隔符隔开</span><br><span class="line">org.apache.commons.lang3.StringUtils#join(java.lang.Iterable&lt;?&gt;, char)    // 将集合转换为字符串，通过分隔符隔开</span><br><span class="line">org.apache.commons.lang3.StringUtils#join(T...)                           // 数组转为字符串</span><br><span class="line">org.apache.commons.lang3.StringUtils#left(String, int)                    // 从左开始只保留字符串的前几位长度</span><br><span class="line">org.apache.commons.lang3.StringUtils#leftPad(java.lang.String, int)       // 从左边开始，不够长度的用space进行填充</span><br><span class="line">org.apache.commons.lang3.StringUtils#overlay(String,String,int,int)       // 字符串中字符进行覆盖</span><br><span class="line">org.apache.commons.lang3.StringUtils#prependIfMissing(java.lang.String, java.lang.CharSequence, boolean, java.lang.CharSequence...) // 追加到前面</span><br><span class="line">org.apache.commons.lang3.StringUtils#remove(java.lang.String, char)       // 删除某个字符</span><br><span class="line">org.apache.commons.lang3.StringUtils#removeEnd(String,String)             // 删除指定结尾的字符</span><br><span class="line">org.apache.commons.lang3.StringUtils#removeStart(String,String)           // 删除指定开头的字符</span><br><span class="line">org.apache.commons.lang3.StringUtils#repeat(char, int)                    // 重复出现字符</span><br><span class="line">org.apache.commons.lang3.StringUtils#reverse(String)                      // 逆序字符串</span><br><span class="line">org.apache.commons.lang3.StringUtils#rightPad(java.lang.String, int)      // 从右边开始填充</span><br><span class="line">org.apache.commons.lang3.StringUtils#split(java.lang.String, char)        // 字符串拆分</span><br><span class="line">org.apache.commons.lang3.StringUtils#strip(java.lang.String)              // 删除字符串两侧的空白</span><br><span class="line">org.apache.commons.lang3.StringUtils#stripEnd(java.lang.String)           // 只删除末尾的字符空白</span><br><span class="line">org.apache.commons.lang3.StringUtils#substringAfter(java.lang.String, int) // 从哪个字符后开始裁剪</span><br><span class="line">org.apache.commons.lang3.StringUtils#substringBefore(java.lang.String, int) // 从哪个字符前开始裁剪</span><br><span class="line">org.apache.commons.lang3.StringUtils#substringBetween(java.lang.String, java.lang.String, java.lang.String) // 从两个字符间进行裁剪</span><br><span class="line">org.apache.commons.lang3.StringUtils#swapCase(java.lang.String)             // 字符串大小写切换</span><br><span class="line">org.apache.commons.lang3.StringUtils#wrap(java.lang.String, java.lang.String) // 前后包裹字符串</span><br></pre></td></tr></table></figure>

<h2 id="ThreadUtils"><a href="#ThreadUtils" class="headerlink" title="ThreadUtils"></a>ThreadUtils</h2><p>用于线程的操作</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 场景方法</span></span><br><span class="line">org.apache.commons.lang3.ThreadUtils#findThreadById(long, java.lang.ThreadGroup)    // 在线程组中查找指定的threadId对应的thread</span><br><span class="line">org.apache.commons.lang3.ThreadUtils#findThreadById(long)         // 获取线程</span><br><span class="line">org.apache.commons.lang3.ThreadUtils#getAllThreads()              // 获取所有线程</span><br></pre></td></tr></table></figure>

<h2 id="Validate"><a href="#Validate" class="headerlink" title="Validate"></a>Validate</h2><p>用于抛出异常的文案设置</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">isTrue</span><span class="params">(<span class="keyword">final</span> <span class="keyword">boolean</span> expression, <span class="keyword">final</span> String message, <span class="keyword">final</span> Object... values)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!expression) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(String.format(message, values));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h2 id="ToStringBuilder"><a href="#ToStringBuilder" class="headerlink" title="ToStringBuilder"></a>ToStringBuilder</h2><p>用于构造toString的样式输出</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TaxReturn</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> String ssn;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">int</span> year;</span><br><span class="line">  <span class="keyword">private</span> String lastName;</span><br><span class="line">  <span class="keyword">private</span> BigDecimal taxableIncome;</span><br><span class="line">  <span class="comment">// get/set方法省略</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">TaxReturn</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ToStringBuilder来构造toString方法</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ToStringBuilder(<span class="keyword">this</span>).append(<span class="string">&quot;ssn&quot;</span>, ssn).append(<span class="string">&quot;year&quot;</span>, year).append(<span class="string">&quot;lastName&quot;</span>,</span><br><span class="line">        lastName).toString();</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// HashCodeBuilder来构造hashCode方法 </span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> HashCodeBuilder(<span class="number">3</span>, <span class="number">7</span>).append(ssn).append(year).toHashCode();</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// EqualsBuilder来构造equals方法</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object pObject)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">boolean</span> equals = <span class="keyword">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (pObject <span class="keyword">instanceof</span> TaxReturn) &#123;</span><br><span class="line">      TaxReturn bean = (TaxReturn) pObject;</span><br><span class="line">      equals = (<span class="keyword">new</span> EqualsBuilder().append(ssn, bean.ssn).append(year, bean.year)).isEquals();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> equals;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// CompareToBuilder来构造compareTo方法</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compareTo</span><span class="params">(Object pObject)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> CompareToBuilder.reflectionCompare(<span class="keyword">this</span>, pObject);</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ComparableUtils"><a href="#ComparableUtils" class="headerlink" title="ComparableUtils"></a>ComparableUtils</h2><p>用于比较操作</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">ComparableUtils.is(<span class="number">2</span>).between(<span class="number">1</span>, <span class="number">10</span>)          <span class="comment">// 比较一个数是否在两数之间</span></span><br><span class="line">ComparableUtils.is(a).greaterThanOrEqualTo(b) <span class="comment">// a大于或等于b</span></span><br></pre></td></tr></table></figure>

<h2 id="ExceptionUtils"><a href="#ExceptionUtils" class="headerlink" title="ExceptionUtils"></a>ExceptionUtils</h2><p>用于异常类型包装</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">String[] stackTrace = ExceptionUtils.getRootCauseStackTrace(cause);   <span class="comment">// 打印异常堆栈信息</span></span><br></pre></td></tr></table></figure>

<h2 id="Fraction"><a href="#Fraction" class="headerlink" title="Fraction"></a>Fraction</h2><p>用于分数的操作</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">Fraction.ZERO.getNumerator()          <span class="comment">// 分子为0</span></span><br><span class="line">Fraction.ZERO.getDenominator())       <span class="comment">// 分母也为0</span></span><br><span class="line">Fraction f = Fraction.getFraction(-<span class="number">6</span>, <span class="number">10</span>)  <span class="comment">// 定义一个-6/10</span></span><br><span class="line">Fraction f = Fraction.getFraction(<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>) <span class="comment">// 定义一个 1 1/2</span></span><br><span class="line"><span class="comment">// 加法</span></span><br><span class="line">f1 = Fraction.getFraction(<span class="number">3</span>, <span class="number">5</span>);</span><br><span class="line">f2 = Fraction.getFraction(-<span class="number">4</span>, <span class="number">5</span>);</span><br><span class="line">f = f1.add(f2);</span><br><span class="line"><span class="comment">// 减法</span></span><br><span class="line">f1 = Fraction.getFraction(<span class="number">3</span>, <span class="number">5</span>);</span><br><span class="line">f2 = Fraction.getFraction(<span class="number">1</span>, <span class="number">5</span>);</span><br><span class="line">f = f1.subtract(f2);</span><br><span class="line"><span class="comment">// 乘法</span></span><br><span class="line">f1 = Fraction.getFraction(<span class="number">3</span>, <span class="number">5</span>);</span><br><span class="line">f2 = Fraction.getFraction(<span class="number">2</span>, <span class="number">5</span>);</span><br><span class="line">f = f1.multiplyBy(f2);</span><br><span class="line"><span class="comment">// 除法</span></span><br><span class="line">f1 = Fraction.getFraction(<span class="number">3</span>, <span class="number">5</span>);</span><br><span class="line">f2 = Fraction.getFraction(<span class="number">2</span>, <span class="number">5</span>);</span><br><span class="line">f = f1.divideBy(f2);</span><br><span class="line"></span><br><span class="line">Fraction f1;</span><br><span class="line">Fraction f2;</span><br><span class="line"></span><br><span class="line">f1 = Fraction.getFraction(<span class="number">3</span>, <span class="number">5</span>);</span><br><span class="line">f2 = Fraction.getFraction(<span class="number">3</span>, <span class="number">5</span>);</span><br><span class="line">f1.compareTo(f2)</span><br></pre></td></tr></table></figure>

<h2 id="IEEE754rUtils"><a href="#IEEE754rUtils" class="headerlink" title="IEEE754rUtils"></a>IEEE754rUtils</h2><p>用于获取数组中最大值或最小值</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">IEEE754rUtils.min(<span class="number">1.2</span>, <span class="number">2.5</span>, Double.NaN)    <span class="comment">// 获取最小值</span></span><br><span class="line">IEEE754rUtils.max(<span class="number">1.2</span>, <span class="number">2.5</span>, Double.NaN     <span class="comment">// 获取最大值</span></span><br></pre></td></tr></table></figure>

<h2 id="NumberUtils"><a href="#NumberUtils" class="headerlink" title="NumberUtils"></a>NumberUtils</h2><p>用于操作数值</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">org.apache.commons.lang3.math.NumberUtils#toInt(java.lang.String)          // 字符串转换为整型数值</span><br><span class="line">org.apache.commons.lang3.math.NumberUtils#toLong(java.lang.String)         // 字符串转换为长整型数值</span><br><span class="line">org.apache.commons.lang3.math.NumberUtils#toScaledBigDecimal(java.lang.String, int, java.math.RoundingMode)   // 设置BigDecimal的scale</span><br><span class="line">org.apache.commons.lang3.math.NumberUtils#createInteger(java.lang.String)  // 字符串转换为Integer类型</span><br><span class="line">org.apache.commons.lang3.math.NumberUtils#createLong(java.lang.String)     // 字符串转换为长整型类型</span><br><span class="line">org.apache.commons.lang3.math.NumberUtils#min(long...)                     // 数组中最小值</span><br><span class="line">org.apache.commons.lang3.math.NumberUtils#max(long...)                     // 数组中最大值</span><br><span class="line">org.apache.commons.lang3.math.NumberUtils#isDigits(java.lang.String)       // 验证是否是一个数字</span><br><span class="line">org.apache.commons.lang3.math.NumberUtils#compare(int, int)                // 两数字进行比较</span><br><span class="line"></span><br><span class="line">org.apache.commons.lang3.math.NumberUtils#INTEGER_ZERO                     // 有一些常量供使用</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Mutable"><a href="#Mutable" class="headerlink" title="Mutable"></a>Mutable</h2><p>可变的基本类型，实现类有<code>MutableBoolean</code>、<code>MutableByte</code>、<code>MutableDouble</code>、<code>MutableFloat</code>、<code>MutableInt</code>、<code>MutableLong</code>、<code>MutableObject</code>、<code>MutableShort</code>  为什么会存在这样的类(不是有Integer的包装类)? 因为Integer类是不能直接做基本类型的<strong>四则运算</strong>的且Integer是<strong>不可变了类型</strong>所以效率上没有<strong>可变类型</strong>的高。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Map&lt;String,MutableInteger&gt; map = <span class="keyword">new</span> HashMap();    <span class="comment">// 用于泛型中使用</span></span><br></pre></td></tr></table></figure>

<h2 id="ConstructorUtils"><a href="#ConstructorUtils" class="headerlink" title="ConstructorUtils"></a>ConstructorUtils</h2><figure class="highlight"><table><tr><td class="code"><pre><span class="line">org.apache.commons.lang3.reflect.ConstructorUtils#invokeConstructor(java.lang.Class&lt;T&gt;, java.lang.Object...)</span><br></pre></td></tr></table></figure>

<h2 id="FieldUtils"><a href="#FieldUtils" class="headerlink" title="FieldUtils"></a>FieldUtils</h2><p>用于反射字段对象的操作</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">org.apache.commons.lang3.reflect.FieldUtils#getField(java.lang.Class&lt;?&gt;, java.lang.String)    // 获取指定字段的Field对象</span><br><span class="line">org.apache.commons.lang3.reflect.FieldUtils#getDeclaredField(java.lang.Class&lt;?&gt;, java.lang.String) // 获取指定字段Field对象</span><br><span class="line">org.apache.commons.lang3.reflect.FieldUtils#getAllFields(java.lang.Class&lt;?&gt;)                  // 获取所有的字段以及父类的</span><br><span class="line">org.apache.commons.lang3.reflect.FieldUtils#getFieldsWithAnnotation(java.lang.Class&lt;?&gt;,Annotion) // 获取含有指定注解的字段</span><br><span class="line">org.apache.commons.lang3.reflect.FieldUtils#readStaticField(java.lang.reflect.Field)          // 获取静态字段的值</span><br><span class="line">org.apache.commons.lang3.reflect.FieldUtils#readField(java.lang.Object, java.lang.String)     // 读普通字段的值</span><br><span class="line">org.apache.commons.lang3.reflect.FieldUtils#writeStaticField(java.lang.reflect.Field, java.lang.Object) // 写静态字段的值</span><br></pre></td></tr></table></figure>

<h2 id="InheritanceUtils"><a href="#InheritanceUtils" class="headerlink" title="InheritanceUtils"></a>InheritanceUtils</h2><p>用于获取子类和父类之间的层级</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">assertEquals(<span class="number">1</span>, InheritanceUtils.distance(AnotherChild.class, AnotherParent.class));</span><br><span class="line">assertEquals(<span class="number">1</span>, InheritanceUtils.distance(Grandchild.class, AnotherChild.class));</span><br><span class="line">assertEquals(<span class="number">2</span>, InheritanceUtils.distance(Grandchild.class, AnotherParent.class));</span><br><span class="line">assertEquals(<span class="number">3</span>, InheritanceUtils.distance(Grandchild.class, Object.class));<span class="comment">//</span></span><br></pre></td></tr></table></figure>

<h2 id="MethodUtils"><a href="#MethodUtils" class="headerlink" title="MethodUtils"></a>MethodUtils</h2><p>用于反射方法的操作</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">org.apache.commons.lang3.reflect.MethodUtils#invokeMethod(java.lang.Object, java.lang.String)  // 执行方法</span><br><span class="line">org.apache.commons.lang3.reflect.MethodUtils#invokeMethod(java.lang.Object, java.lang.String, java.lang.Object...) // 执行含参数的方法</span><br><span class="line">org.apache.commons.lang3.reflect.MethodUtils#getMethodsWithAnnotation(java.lang.Class&lt;?&gt;, java.lang.Class&lt;? extends java.lang.annotation.Annotation&gt;) // 获取标记指定注解的方法</span><br></pre></td></tr></table></figure>

<h2 id="TypeUtils"><a href="#TypeUtils" class="headerlink" title="TypeUtils"></a>TypeUtils</h2><p>用于java类型的操作。<code>ParameterizedType</code>参数化类型、<code>TypeVariable</code>类型变量、<code>GenericArrayType</code>泛型数组、<code>WildcardType</code>通配符类型。</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">org.apache.commons.lang3.reflect.TypeUtils#containsTypeVariables(Type)       // 判断是否是type类型</span><br></pre></td></tr></table></figure>

<h2 id="DateFormatUtils-amp-DateUtils"><a href="#DateFormatUtils-amp-DateUtils" class="headerlink" title="DateFormatUtils &amp; DateUtils"></a>DateFormatUtils &amp; DateUtils</h2><p>用于时间操作</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">DateFormatUtils.format(c.getTime(), <span class="string">&quot;yyyyMdH&quot;</span>)      <span class="comment">// 格式化时间</span></span><br><span class="line">DateUtils.addHours(BASE_DATE, -<span class="number">1</span>)                   <span class="comment">// 减少一小时</span></span><br></pre></td></tr></table></figure>

<h2 id="Pair-amp-Triple"><a href="#Pair-amp-Triple" class="headerlink" title="Pair &amp; Triple"></a>Pair &amp; Triple</h2><p>用于操作二元组或三元组。Pair的子类有<code>MutablePair</code> 和 <code>ImmutablePair</code>  Triple的子类有 <code>MutableTriple</code> 和 <code>ImmutableTriple</code> </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Pair&lt;String, String&gt; pair = Pair.of(<span class="string">&quot;Key&quot;</span>, <span class="string">&quot;Value&quot;</span>)                       <span class="comment">// 二元组定义不可变类型</span></span><br><span class="line"><span class="keyword">final</span> Triple&lt;String, String, String&gt; triple1 = Triple.of(<span class="string">&quot;A&quot;</span>, <span class="string">&quot;D&quot;</span>, <span class="string">&quot;A&quot;</span>)   <span class="comment">// 三元组定义不可变类型</span></span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>apache-common</category>
      </categories>
      <tags>
        <tag>apache-common-lang</tag>
      </tags>
  </entry>
  <entry>
    <title>Apache-collections</title>
    <url>/2021/05/11/Apache-collections/</url>
    <content><![CDATA[<p>简介：Apache-common Collections提供了很多的基于集合间的操作</p>
<img src="/2021/05/11/Apache-collections/Apache-collections.png" style="zoom: 50%;">

<a id="more"></a>

<h2 id="Bag"><a href="#Bag" class="headerlink" title="Bag"></a>Bag</h2><p>用于操作袋，统计袋中元素</p>
<p>实现类：</p>
<ul>
<li><p>AbstractBagDecorator</p>
<p>  AbstractSortedBagDecorator</p>
<ul>
<li><p>CollectionSortedBag</p>
</li>
<li><p>UnmodifiableSortedBag</p>
<p>CollectionBag</p>
<p>UnmodifiableBag</p>
</li>
</ul>
</li>
<li><p>AbstractMapBag</p>
<p>  HashBag</p>
<p>  TreeBag</p>
</li>
<li><p>PredicatedBag</p>
<p>  PredicatedSortedBag</p>
</li>
<li><p>SortedBag</p>
<p>  AbstractSortedBagDecorator</p>
<pre><code>  CollectionSortedBag</code></pre>
<p>   UnmodifiableSortedBag</p>
</li>
<li><p>PredicatedSortedBag</p>
<p>   SynchronizedSortedBag</p>
<p>   TransformedSortedBag</p>
<p>   TreeBag</p>
</li>
<li><p>SynchronizedBag</p>
</li>
<li><p>SynchronizedSortedBag</p>
</li>
<li><p>TransformedBag</p>
<p>  TransformedSortedBag</p>
<p> 提供工具类：<code>BagUtils</code></p>
</li>
</ul>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// BagUtil常见方法 </span></span><br><span class="line">org.apache.commons.collections4.BagUtils#synchronizedBag(Bag)  // 将一个bag转换为一个同步的bag(线程安全)</span><br><span class="line">org.apache.commons.collections4.BagUtils#unmodifiableBag(Bag)  // 将一个bag转换为一个不可变的bag</span><br><span class="line">org.apache.commons.collections4.BagUtils#predicatedBag(Bag)    // 将断言应用到每个bag中，断言成立才会添加到bag中</span><br><span class="line">org.apache.commons.collections4.BagUtils#transformingBag(Bag)  // 将function应用到每个bag中进行转换后添加</span><br><span class="line">org.apache.commons.collections4.BagUtils#collectionBag(Bag)    // 返回一个bag集合</span><br><span class="line"></span><br><span class="line">org.apache.commons.collections4.BagUtils#synchronizedSortedBag(SortBag)  // 将一个sortBag转为同步的sortBag</span><br><span class="line">org.apache.commons.collections4.BagUtils#unmodifiableBag(SortBag)        // 将一个SortBag转换为一个不可变的SortBag</span><br><span class="line">org.apache.commons.collections4.BagUtils#predicatedBag(SortBag)          // 将断言应用到每个SortBag中，断言成立才会添加到SortBag中</span><br><span class="line">org.apache.commons.collections4.BagUtils#transformingBag(SortBag)        // 将function应用到每个SortBag中进行转换后添加</span><br><span class="line">org.apache.commons.collections4.BagUtils#collectionBag(SortBag)          // 返回一个bag集合</span><br><span class="line"></span><br><span class="line">org.apache.commons.collections4.BagUtils#emptyBag()             // 返回一个空bag</span><br><span class="line">org.apache.commons.collections4.BagUtils#emptySortedBag()       // 返回一个空sortBag</span><br></pre></td></tr></table></figure>

<h3 id="TreeBag-amp-TreeBag"><a href="#TreeBag-amp-TreeBag" class="headerlink" title="TreeBag &amp; TreeBag"></a>TreeBag &amp; TreeBag</h3><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">org.apache.commons.collections4.bag.AbstractMapBag#getCount(Object)     // 获取元素在Map中出现的个数</span><br><span class="line">org.apache.commons.collections4.bag.AbstractMapBag#add(E)               // 在HashBag中添加，含有欺骗性只会存储一个元素用count统计存储量</span><br><span class="line">org.apache.commons.collections4.bag.AbstractMapBag#remove(java.lang.Object) // 删除元素</span><br><span class="line">org.apache.commons.collections4.bag.AbstractMapBag#uniqueSet()          // 返回map中的keyset</span><br></pre></td></tr></table></figure>

<h3 id="CollectionBag-amp-CollectionSortedBag"><a href="#CollectionBag-amp-CollectionSortedBag" class="headerlink" title="CollectionBag &amp; CollectionSortedBag"></a>CollectionBag &amp; CollectionSortedBag</h3><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">org.apache.commons.collections4.bag.CollectionBag#containsAll(Collection)      // 判断bag是否包含collection中所有元素</span><br><span class="line">org.apache.commons.collections4.bag.CollectionBag#add(E)                       // 集合bag中添加元素</span><br><span class="line">org.apache.commons.collections4.bag.CollectionBag#addAll(Collection)           // 集合bag中添加一个集合</span><br><span class="line">org.apache.commons.collections4.bag.CollectionBag#remove(E)                    // 集合bag中删除一个元素</span><br><span class="line">org.apache.commons.collections4.bag.CollectionBag#removeAll(Collection)        // 删除元素在bag集合中的所有</span><br><span class="line">org.apache.commons.collections4.bag.CollectionBag#retainAll(Collection)        // 求交集</span><br><span class="line">org.apache.commons.collections4.bag.CollectionBag#add(E, int)                  // 添加几个元素</span><br></pre></td></tr></table></figure>

<h3 id="SynchronizedBag-amp-SynchronizedSortedBag"><a href="#SynchronizedBag-amp-SynchronizedSortedBag" class="headerlink" title="SynchronizedBag &amp; SynchronizedSortedBag"></a>SynchronizedBag &amp; SynchronizedSortedBag</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 添加方法</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">add</span><span class="params">(<span class="keyword">final</span> E object, <span class="keyword">final</span> <span class="keyword">int</span> count)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">synchronized</span> (lock) &#123;</span><br><span class="line">        <span class="keyword">return</span> getBag().add(object, count);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 删除方法</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">remove</span><span class="params">(<span class="keyword">final</span> Object object, <span class="keyword">final</span> <span class="keyword">int</span> count)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">synchronized</span> (lock) &#123;</span><br><span class="line">        <span class="keyword">return</span> getBag().remove(object, count);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="UnmodifiableBag-amp-UnmodifiableSortedBag"><a href="#UnmodifiableBag-amp-UnmodifiableSortedBag" class="headerlink" title="UnmodifiableBag &amp; UnmodifiableSortedBag"></a>UnmodifiableBag &amp; UnmodifiableSortedBag</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">add</span><span class="params">(<span class="keyword">final</span> E object, <span class="keyword">final</span> <span class="keyword">int</span> count)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="PredicatedBag-amp-PredicatedSortedBag"><a href="#PredicatedBag-amp-PredicatedSortedBag" class="headerlink" title="PredicatedBag &amp; PredicatedSortedBag"></a>PredicatedBag &amp; PredicatedSortedBag</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 添加方法</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">add</span><span class="params">(<span class="keyword">final</span> E object, <span class="keyword">final</span> <span class="keyword">int</span> count)</span> </span>&#123;</span><br><span class="line">    validate(object);         <span class="comment">// 只有验证成功后，才能添加进去</span></span><br><span class="line">    <span class="keyword">return</span> decorated().add(object, count);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="TransformedBag-amp-TransformedSortedBag"><a href="#TransformedBag-amp-TransformedSortedBag" class="headerlink" title="TransformedBag &amp; TransformedSortedBag"></a>TransformedBag &amp; TransformedSortedBag</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 添加方法</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">add</span><span class="params">(<span class="keyword">final</span> E object, <span class="keyword">final</span> <span class="keyword">int</span> nCopies)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> getBag().add(transform(object), nCopies);       <span class="comment">// 每天一个元素都要经过transform进行转换</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="BidiMap"><a href="#BidiMap" class="headerlink" title="BidiMap"></a>BidiMap</h2><p> 用于通过key查询value，通过value也能查询到key的场景。<code>BidiMap</code> 通过key列唯一、value列唯一来保证。</p>
<p> 常见实现类：<code>DualHashBidiMap</code>、<code>DualLinkedHashBidiMap</code>、<code>DualTreeBidiMap</code>、<code>TreeBidiMap</code></p>
<h3 id="DualHashBidiMap-amp-DualLinkedHashBidiMap-amp-DualTreeBidiMap"><a href="#DualHashBidiMap-amp-DualLinkedHashBidiMap-amp-DualTreeBidiMap" class="headerlink" title="DualHashBidiMap &amp; DualLinkedHashBidiMap &amp; DualTreeBidiMap"></a>DualHashBidiMap &amp; DualLinkedHashBidiMap &amp; DualTreeBidiMap</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 三个map对应三种不同的实现类，其中BidiMap中通过两个map存储key与value的映射</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Normal delegate map.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">transient</span> Map&lt;K, V&gt; normalMap;         <span class="comment">// 存储key和value的映射</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Reverse delegate map.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">transient</span> Map&lt;V, K&gt; reverseMap;        <span class="comment">// 存储value和key的映射</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 公共的添加逻辑</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> V <span class="title">put</span><span class="params">(<span class="keyword">final</span> K key, <span class="keyword">final</span> V value)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (normalMap.containsKey(key)) &#123;            <span class="comment">// 判断是否存在key，存在的话就删除value对应的key,保证key列和value列唯一</span></span><br><span class="line">        reverseMap.remove(normalMap.get(key));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (reverseMap.containsKey(value)) &#123;</span><br><span class="line">        normalMap.remove(reverseMap.get(value));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">final</span> V obj = normalMap.put(key, value);</span><br><span class="line">    reverseMap.put(value, key);</span><br><span class="line">    <span class="keyword">return</span> obj;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>UnmodifiableBidiMap</code> 、<code>UnmodifiableOrderedBidiMap</code>、<code>UnmodifiableSortedBidiMap</code> 是三种不可变的类型<br><code>TreeBidiMap</code> 基于红黑树来实现的bidiMap</p>
<h2 id="BloomFilter"><a href="#BloomFilter" class="headerlink" title="BloomFilter"></a>BloomFilter</h2><p>布隆过滤器。 核心实现类 </p>
<p>  <code>AbstractBloomFilter</code> </p>
<p> <code>ArrayCountingBloomFilter</code></p>
<p> <code>BitSetBloomFilter</code></p>
<p> <code>HasherBloomFilter</code></p>
<p>  <code>CountingBloomFilter</code></p>
<p><code>ArrayCountingBloomFilter</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 核心方法</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 获取此筛选器的形状</span></span><br><span class="line"><span class="comment"> * Gets the shape of this filter.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> the shape of this filter 这个过滤器的形状</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function">Shape <span class="title">getShape</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 获取表示此筛选器位的小端长值数组。</span></span><br><span class="line"><span class="comment"> * Gets an array of little-endian long values representing the bits of this filter.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * 返回的数组将有长度&#123;<span class="doctag">@code</span> ceil(m / 64)&#125;，其中&#123;<span class="doctag">@code</span> m&#125;是在过滤器和&#123;<span class="doctag">@code</span> ceil&#125;是ceiling函数的位数。</span></span><br><span class="line"><span class="comment"> * 第一个长为0-63位。位位置的值为1表示该位索引已启用。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">long</span>[] getBits();</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 创建一个包含在过滤器中的位的索引的StaticHasher</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> a StaticHasher for that produces this Bloom filter</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function">StaticHasher <span class="title">getHasher</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 如果该筛选器包含指定的筛选器返回true</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">contains</span><span class="params">(BloomFilter other)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 如果该筛选器包含指定的分解后的Bloom筛选器</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">contains</span><span class="params">(Hasher hasher)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Modification Operations</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 将指定的Bloom过滤器合并到此Bloom过滤器中</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">merge</span><span class="params">(BloomFilter other)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 将指定的分解后的Bloom过滤器合并到此Bloom过滤器中特别是所有</span></span><br><span class="line"><span class="comment"> * 由&#123;<span class="doctag">@code</span> hasher&#125;标识的位索引将在这个过滤器中启用。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">merge</span><span class="params">(Hasher hasher)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Counting Operations</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Gets the cardinality (number of enabled bits) of this Bloom filter.</span></span><br><span class="line"><span class="comment"> * 获取此Bloom过滤器的基数(启用的位数)。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">cardinality</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 使用另一个Bloom过滤器执行逻辑“与”，并返回基数(启用的位数)的结果</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">andCardinality</span><span class="params">(BloomFilter other)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 使用另一个Bloom过滤器执行逻辑“或”，并返回基数(启用的位数)的结果</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">orCardinality</span><span class="params">(BloomFilter other)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 使用另一个Bloom过滤器执行逻辑“异或”，并返回基数(启用的位数)的结果</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">xorCardinality</span><span class="params">(BloomFilter other)</span></span>;</span><br></pre></td></tr></table></figure>

<h2 id="BoundedCollection"><a href="#BoundedCollection" class="headerlink" title="BoundedCollection"></a>BoundedCollection</h2><p>创建一个固定容量的集合,其实现类有<code>CircularFifoQueue</code> 、<code>FixedSizeList</code>、<code>UnmodifiableBoundedCollection</code></p>
<h3 id="CircularFifoQueue"><a href="#CircularFifoQueue" class="headerlink" title="CircularFifoQueue"></a>CircularFifoQueue</h3><p>一个基于FIFO先进先出的固定容量的队列，如果容量满则会删除旧的数据</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">org.apache.commons.collections4.queue.CircularFifoQueue#isAtFullCapacity()    // 判断容器是否已满</span><br><span class="line">org.apache.commons.collections4.queue.CircularFifoQueue#add(E)                // 添加元素，如果队列满了则会进行循环覆盖</span><br><span class="line">org.apache.commons.collections4.queue.CircularFifoQueue#get(int)              // 根据索引获取元素</span><br><span class="line">org.apache.commons.collections4.queue.CircularFifoQueue#offer(E)              // 添加元素</span><br><span class="line">org.apache.commons.collections4.queue.CircularFifoQueue#poll()                // 移除一个元素</span><br><span class="line">org.apache.commons.collections4.queue.CircularFifoQueue#element()             // 返回一个元素</span><br><span class="line">org.apache.commons.collections4.queue.CircularFifoQueue#peek()                // 返回一个元素</span><br><span class="line">org.apache.commons.collections4.queue.CircularFifoQueue#remove()              // 移除一个元素</span><br><span class="line">org.apache.commons.collections4.queue.CircularFifoQueue#iterator()            // 获取一个迭代器</span><br></pre></td></tr></table></figure>

<h3 id="FixedSizeList"><a href="#FixedSizeList" class="headerlink" title="FixedSizeList"></a>FixedSizeList</h3><p>用于操作固定容器的集合，不知道write操作</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 新增操作</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">final</span> <span class="keyword">int</span> index, <span class="keyword">final</span> E object)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">throw</span> unsupportedOperationException();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 获取操作</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">get</span><span class="params">(<span class="keyword">final</span> <span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> decorated().get(index);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="UnmodifiableBoundedCollection"><a href="#UnmodifiableBoundedCollection" class="headerlink" title="UnmodifiableBoundedCollection"></a>UnmodifiableBoundedCollection</h3><p>操作不可变集合</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 新增操作</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">final</span> <span class="keyword">int</span> index, <span class="keyword">final</span> E object)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">throw</span> unsupportedOperationException();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="BoundedMap"><a href="#BoundedMap" class="headerlink" title="BoundedMap"></a>BoundedMap</h2><p>用于定义一个固定容量的map，其实现类有<code>FixedSizeMap</code> 、<code>FixedSizeSortedMap</code>、<code>LRUMap</code>、<code>SingletonMap</code></p>
<h3 id="FixedSizeMap"><a href="#FixedSizeMap" class="headerlink" title="FixedSizeMap"></a>FixedSizeMap</h3><p>只能新增已经存在的key-value</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 新增方法</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> V <span class="title">put</span><span class="params">(<span class="keyword">final</span> K key, <span class="keyword">final</span> V value)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (map.containsKey(key) == <span class="keyword">false</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">&quot;Cannot put new key/value pair - Map is fixed size&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> map.put(key, value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="FixedSizeSortedMap"><a href="#FixedSizeSortedMap" class="headerlink" title="FixedSizeSortedMap"></a>FixedSizeSortedMap</h3><p>基于sortedMap的实现，只能添加已经存在的key-value</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 新增方法</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> V <span class="title">put</span><span class="params">(<span class="keyword">final</span> K key, <span class="keyword">final</span> V value)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (map.containsKey(key) == <span class="keyword">false</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">&quot;Cannot put new key/value pair - Map is fixed size&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> map.put(key, value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="SingletonMap"><a href="#SingletonMap" class="headerlink" title="SingletonMap"></a>SingletonMap</h3><p>只有一个key-value</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 新增方法</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> V <span class="title">put</span><span class="params">(<span class="keyword">final</span> K key, <span class="keyword">final</span> V value)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (isEqualKey(key)) &#123;</span><br><span class="line">        <span class="keyword">return</span> setValue(value);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">&quot;Cannot put new key/value pair - Map is fixed size singleton&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取方法</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> V <span class="title">get</span><span class="params">(<span class="keyword">final</span> Object key)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (isEqualKey(key)) &#123;</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ClosureUtils"><a href="#ClosureUtils" class="headerlink" title="ClosureUtils"></a>ClosureUtils</h2><p>用于封装函数式接口，用于多样的使用</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">org.apache.commons.collections4.ClosureUtils#exceptionClosure()     // 返回一个exceptionClosure的函数接口总是抛出异常</span><br><span class="line">org.apache.commons.collections4.ClosureUtils#nopClosure()           // 返回一个nopClosure不做任务处理</span><br><span class="line">org.apache.commons.collections4.ClosureUtils#asClosure(Transformer) // 返回一个封装了Transformer接口的closure</span><br><span class="line">org.apache.commons.collections4.ClosureUtils#forClosure(int,Closure)// 返回一个closure执行count次数</span><br><span class="line">org.apache.commons.collections4.ClosureUtils#whileClosure(Predicate,Closure) // 返回只有Predicate成立就一直执行closure</span><br><span class="line">org.apache.commons.collections4.ClosureUtils#doWhileClosure(Predicate,Closure) // 返回一个至少执行一次的closure</span><br><span class="line">org.apache.commons.collections4.ClosureUtils#invokerClosure(java.lang.String) // 传入methodName然后在Transformer中反射调用这个方法</span><br><span class="line">org.apache.commons.collections4.ClosureUtils#invokerClosure(java.lang.String, java.lang.Class&lt;?&gt;[], java.lang.Object[]) // 传入methodName然后在Transformer中反射调用这个方法</span><br><span class="line">org.apache.commons.collections4.ClosureUtils#chainedClosure(org.apache.commons.collections4.Closure&lt;? super E&gt;...) // 循环执行这些closure接口</span><br><span class="line">org.apache.commons.collections4.ClosureUtils#ifClosure(org.apache.commons.collections4.Predicate&lt;? super E&gt;, org.apache.commons.collections4.Closure&lt;? super E&gt;) // 只有Predicate成立才会执行CLosure</span><br><span class="line">org.apache.commons.collections4.ClosureUtils#ifClosure(org.apache.commons.collections4.Predicate&lt;? super E&gt;, org.apache.commons.collections4.Closure&lt;? super E&gt;, org.apache.commons.collections4.Closure&lt;? super E&gt;) // 成立就执行trueClosure否则falseClosure</span><br><span class="line">org.apache.commons.collections4.ClosureUtils#switchClosure(org.apache.commons.collections4.Predicate&lt;? super E&gt;[], org.apache.commons.collections4.Closure&lt;? super E&gt;[])  // 每个predicate执行一个Closure     </span><br></pre></td></tr></table></figure>

<h3 id="CatchAndRethrowClosure"><a href="#CatchAndRethrowClosure" class="headerlink" title="CatchAndRethrowClosure"></a>CatchAndRethrowClosure</h3><p>用于抛出异常</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">CatchAndRethrowClosure</span>&lt;<span class="title">E</span>&gt; <span class="keyword">implements</span> <span class="title">Closure</span>&lt;<span class="title">E</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Execute this closure on the specified input object.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> input the input to execute on</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> FunctorException (runtime) if the closure execution resulted in a</span></span><br><span class="line"><span class="comment">     *             checked exception.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(<span class="keyword">final</span> E input)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            executeAndThrow(input);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (<span class="keyword">final</span> RuntimeException ex) &#123;</span><br><span class="line">            <span class="keyword">throw</span> ex;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (<span class="keyword">final</span> Throwable t) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> FunctorException(t);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Execute this closure on the specified input object.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> input the input to execute on</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Throwable if the closure execution resulted in a checked</span></span><br><span class="line"><span class="comment">     *             exception.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">executeAndThrow</span><span class="params">(E input)</span> <span class="keyword">throws</span> Throwable</span>;      <span class="comment">// 自行实现抛出异常</span></span><br></pre></td></tr></table></figure>

<h3 id="ChainedClosure"><a href="#ChainedClosure" class="headerlink" title="ChainedClosure"></a>ChainedClosure</h3><p>用于将多个closure进行执行</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 创建</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;E&gt; <span class="function">Closure&lt;E&gt; <span class="title">chainedClosure</span><span class="params">(<span class="keyword">final</span> Closure&lt;? <span class="keyword">super</span> E&gt;... closures)</span> </span>&#123;</span><br><span class="line">        FunctorUtils.validate(closures);</span><br><span class="line">        <span class="keyword">if</span> (closures.length == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> NOPClosure.&lt;E&gt;nopClosure();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ChainedClosure&lt;&gt;(closures);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 调用</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(<span class="keyword">final</span> E input)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">final</span> Closure&lt;? <span class="keyword">super</span> E&gt; iClosure : iClosures) &#123;</span><br><span class="line">        iClosure.execute(input);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ForClosure"><a href="#ForClosure" class="headerlink" title="ForClosure"></a>ForClosure</h3><p>循环执行closure</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 创建</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;E&gt; <span class="function">Closure&lt;E&gt; <span class="title">forClosure</span><span class="params">(<span class="keyword">final</span> <span class="keyword">int</span> count, <span class="keyword">final</span> Closure&lt;? <span class="keyword">super</span> E&gt; closure)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (count &lt;= <span class="number">0</span> || closure == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> NOPClosure.&lt;E&gt;nopClosure();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (count == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> (Closure&lt;E&gt;) closure;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ForClosure&lt;&gt;(count, closure);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 调用</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(<span class="keyword">final</span> E input)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; iCount; i++) &#123;</span><br><span class="line">        iClosure.execute(input);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="IfClosure"><a href="#IfClosure" class="headerlink" title="IfClosure"></a>IfClosure</h3><p>基于if…else的方式执行closure</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 创建</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;E&gt; <span class="function">Closure&lt;E&gt; <span class="title">ifClosure</span><span class="params">(<span class="keyword">final</span> Predicate&lt;? <span class="keyword">super</span> E&gt; predicate, <span class="keyword">final</span> Closure&lt;? <span class="keyword">super</span> E&gt; trueClosure)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> IfClosure.&lt;E&gt;ifClosure(predicate, trueClosure, NOPClosure.&lt;E&gt;nopClosure());</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 调用</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(<span class="keyword">final</span> E input)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (iPredicate.evaluate(input)) &#123;</span><br><span class="line">        iTrueClosure.execute(input);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        iFalseClosure.execute(input);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="CollectionUtils"><a href="#CollectionUtils" class="headerlink" title="CollectionUtils"></a>CollectionUtils</h2><p>用于操作集合</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">org.apache.commons.collections4.CollectionUtils#emptyCollection()        // 返回一个空集合</span><br><span class="line">org.apache.commons.collections4.CollectionUtils#emptyIfNull(Collection)  // 如果是空就返回空集合，否则直接返回</span><br><span class="line">org.apache.commons.collections4.CollectionUtils#union(Iterable,Iterable) // 合并两个集合内容</span><br><span class="line">org.apache.commons.collections4.CollectionUtils#intersection(Iterable,Iterable) // 返回这两个集合</span><br><span class="line">org.apache.commons.collections4.CollectionUtils#subtract(java.lang.Iterable&lt;? extends O&gt;, java.lang.Iterable&lt;? extends O&gt;)  // 两集合相减返回剩余的部分</span><br><span class="line">org.apache.commons.collections4.CollectionUtils#containsAll(Collectin,Collectin) // 一个集合包含另一个集合</span><br><span class="line">org.apache.commons.collections4.CollectionUtils#containsAny(java.util.Collection&lt;?&gt;, java.util.Collection&lt;?&gt;)  // 一个集合包含另一个集合部分</span><br><span class="line">org.apache.commons.collections4.CollectionUtils#getCardinalityMap(Iterable)    // 将集合转换为map,并返回Map&lt;Obje,count&gt; 出现的次数</span><br><span class="line">org.apache.commons.collections4.CollectionUtils#filter(Collection,Filter)      // 进行集合过滤</span><br><span class="line">org.apache.commons.collections4.CollectionUtils#transform(Collection,Transform) // 对集合中的每个元素进行过滤</span><br><span class="line">org.apache.commons.collections4.CollectionUtils#select(java.lang.Iterable&lt;? extends O&gt;, org.apache.commons.collections4.Predicate&lt;? super O&gt;) // 返回符合条件的集合</span><br><span class="line">org.apache.commons.collections4.CollectionUtils#selectRejected(java.lang.Iterable&lt;? extends O&gt;, org.apache.commons.collections4.Predicate&lt;? super O&gt;) // 返回没有符合条件的集合</span><br><span class="line">org.apache.commons.collections4.CollectionUtils#collect(java.lang.Iterable&lt;I&gt;, org.apache.commons.collections4.Transformer&lt;? super I,? extends O&gt;) // 返回每个元素被转换后的集合</span><br><span class="line">org.apache.commons.collections4.CollectionUtils#addIgnoreNull(T)      // 添加不为null的元素</span><br><span class="line">org.apache.commons.collections4.CollectionUtils#reverseArray(T[])     // 数组逆序</span><br><span class="line">org.apache.commons.collections4.CollectionUtils#collate(java.lang.Iterable&lt;? extends O&gt;, java.lang.Iterable&lt;? extends O&gt;)  // 将两个集合合并</span><br></pre></td></tr></table></figure>

<h3 id="PredicatedList"><a href="#PredicatedList" class="headerlink" title="PredicatedList"></a>PredicatedList</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 断言为true的才会添加</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="title">PredicatedList</span><span class="params">(<span class="keyword">final</span> List&lt;E&gt; list, <span class="keyword">final</span> Predicate&lt;? <span class="keyword">super</span> E&gt; predicate)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(list, predicate);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="SetUniqueList"><a href="#SetUniqueList" class="headerlink" title="SetUniqueList"></a>SetUniqueList</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 添加唯一元素</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;E&gt; <span class="function">SetUniqueList&lt;E&gt; <span class="title">setUniqueList</span><span class="params">(<span class="keyword">final</span> List&lt;E&gt; list)</span> </span>&#123;</span><br><span class="line">        Objects.requireNonNull(list, <span class="string">&quot;list&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (list.isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> SetUniqueList&lt;&gt;(list, <span class="keyword">new</span> HashSet&lt;E&gt;());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">final</span> List&lt;E&gt; temp = <span class="keyword">new</span> ArrayList&lt;&gt;(list);</span><br><span class="line">        list.clear();</span><br><span class="line">        <span class="keyword">final</span> SetUniqueList&lt;E&gt; sl = <span class="keyword">new</span> SetUniqueList&lt;&gt;(list, <span class="keyword">new</span> HashSet&lt;E&gt;());</span><br><span class="line">        sl.addAll(temp);</span><br><span class="line">        <span class="keyword">return</span> sl;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="TransformedList"><a href="#TransformedList" class="headerlink" title="TransformedList"></a>TransformedList</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 用于转换</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;E&gt; <span class="function">TransformedList&lt;E&gt; <span class="title">transformedList</span><span class="params">(<span class="keyword">final</span> List&lt;E&gt; list,</span></span></span><br><span class="line"><span class="function"><span class="params">     <span class="keyword">final</span> Transformer&lt;? <span class="keyword">super</span> E, ? extends E&gt; transformer)</span></span></span><br></pre></td></tr></table></figure>

<h2 id="ComparatorUtils"><a href="#ComparatorUtils" class="headerlink" title="ComparatorUtils"></a>ComparatorUtils</h2><p>用于比较操作</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">org.apache.commons.collections4.ComparatorUtils#naturalComparator()     // 获取自然排序</span><br><span class="line">org.apache.commons.collections4.ComparatorUtils#chainedComparator(java.util.Comparator&lt;E&gt;...)  // 排序链</span><br><span class="line">org.apache.commons.collections4.ComparatorUtils#reversedComparator(Comparator)  // 逆序</span><br><span class="line">org.apache.commons.collections4.ComparatorUtils#booleanComparator(trueFirst)    // 排序boolean类型。true则表示true的值排序到最前面</span><br><span class="line">org.apache.commons.collections4.ComparatorUtils#nullLowComparator(Comparator)   // 用于比较含有null值的数据</span><br><span class="line">org.apache.commons.collections4.ComparatorUtils#transformedComparator(Comparator,Transform) // 将元素transform转换后再进行比较</span><br><span class="line">org.apache.commons.collections4.ComparatorUtils#max(int,int,Comparator)      // 求两个元素中最大值</span><br><span class="line">org.apache.commons.collections4.ComparatorUtils#min(int,int,Comparator)      // 求两个元素中最小值</span><br></pre></td></tr></table></figure>

<h3 id="BooleanComparator"><a href="#BooleanComparator" class="headerlink" title="BooleanComparator"></a>BooleanComparator</h3><p>用于比较boolean类型比较器</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(<span class="keyword">final</span> Boolean b1, <span class="keyword">final</span> Boolean b2)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">boolean</span> v1 = b1.booleanValue();</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">boolean</span> v2 = b2.booleanValue();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (v1 ^ v2) ? ( (v1 ^ trueFirst) ? <span class="number">1</span> : -<span class="number">1</span> ) : <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="FixedOrderComparator"><a href="#FixedOrderComparator" class="headerlink" title="FixedOrderComparator"></a>FixedOrderComparator</h3><p>可以用来还原排序，记录一个排序的快照</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">String[] planets = &#123;<span class="string">&quot;Mercury&quot;</span>, <span class="string">&quot;Venus&quot;</span>, <span class="string">&quot;Earth&quot;</span>, <span class="string">&quot;Mars&quot;</span>&#125;;</span><br><span class="line">FixedOrderComparator distanceFromSun = <span class="keyword">new</span> FixedOrderComparator(planets);    <span class="comment">// 记录每个元素的位置，其实有一个全局的map记录</span></span><br><span class="line">Arrays.sort(planets);   <span class="comment">// 自然排序</span></span><br><span class="line">Arrays.sort(planets, distanceFromSun);  <span class="comment">// 恢复排序</span></span><br></pre></td></tr></table></figure>

<h3 id="NullComparator"><a href="#NullComparator" class="headerlink" title="NullComparator"></a>NullComparator</h3><p>值存在为null时候的排序</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(<span class="keyword">final</span> E o1, <span class="keyword">final</span> E o2)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (o1 == o2) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (o1 == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.nullsAreHigh ? <span class="number">1</span> : -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (o2 == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.nullsAreHigh ? -<span class="number">1</span> : <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.nonNullComparator.compare(o1, o2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ReverseComparator"><a href="#ReverseComparator" class="headerlink" title="ReverseComparator"></a>ReverseComparator</h3><p>逆序排序</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(<span class="keyword">final</span> E obj1, <span class="keyword">final</span> E obj2)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> comparator.compare(obj2, obj1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="TransformingComparator"><a href="#TransformingComparator" class="headerlink" title="TransformingComparator"></a>TransformingComparator</h3><p>对比较对象转换后再比较</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(<span class="keyword">final</span> I obj1, <span class="keyword">final</span> I obj2)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> O value1 = <span class="keyword">this</span>.transformer.transform(obj1);</span><br><span class="line">    <span class="keyword">final</span> O value2 = <span class="keyword">this</span>.transformer.transform(obj2);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.decorated.compare(value1, value2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="EnumerationUtils"><a href="#EnumerationUtils" class="headerlink" title="EnumerationUtils"></a>EnumerationUtils</h2><p>用于操作枚举</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">org.apache.commons.collections4.EnumerationUtils#asIterable(Enumeration)     // 枚举转为迭代器</span><br><span class="line">org.apache.commons.collections4.EnumerationUtils#get(Enumeration,int)        // 枚举中获取第几个元素</span><br><span class="line">org.apache.commons.collections4.EnumerationUtils#toList(java.util.Enumeration&lt;? extends E&gt;) // 枚举转换为集合</span><br><span class="line">org.apache.commons.collections4.EnumerationUtils#toList(java.util.StringTokenizer) // 使用stringTokenizer转换为集合</span><br></pre></td></tr></table></figure>

<h2 id="FactoryUtils"><a href="#FactoryUtils" class="headerlink" title="FactoryUtils"></a>FactoryUtils</h2><p>用于获取工厂接口</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">org.apache.commons.collections4.FactoryUtils#exceptionFactory()    // 返回一个异常的工厂</span><br><span class="line">org.apache.commons.collections4.FactoryUtils#constantFactory(T)    // 返回一个返回常量的工厂</span><br><span class="line">org.apache.commons.collections4.FactoryUtils#prototypeFactory()    // 返回一个调用属性的工厂</span><br><span class="line">org.apache.commons.collections4.FactoryUtils#instantiateFactory(java.lang.Class&lt;T&gt;) // 返回一个实例化的工厂</span><br></pre></td></tr></table></figure>

<h2 id="FluentIterable"><a href="#FluentIterable" class="headerlink" title="FluentIterable"></a>FluentIterable</h2><p>用于操作迭代器</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">org.apache.commons.collections4.FluentIterable#append(E...)     // 追加元素</span><br><span class="line">org.apache.commons.collections4.FluentIterable#collate(java.lang.Iterable&lt;? extends E&gt;) // 添加元素到迭代器中并会进行自然排序</span><br><span class="line">org.apache.commons.collections4.FluentIterable#collate(java.lang.Iterable&lt;? extends E&gt;, java.util.Comparator&lt;? super E&gt;) // 追加元素指定排序规则</span><br><span class="line">org.apache.commons.collections4.FluentIterable#eval()   // 返回新的FluentIterable内容与之前一致</span><br><span class="line">org.apache.commons.collections4.FluentIterable#filter(Predicate) // 返回Predicate为true的元素</span><br><span class="line">org.apache.commons.collections4.FluentIterable#limit(int)  // 只返回几个值</span><br><span class="line">org.apache.commons.collections4.FluentIterable#loop()      // 返回一个无限循环的迭代器</span><br><span class="line">org.apache.commons.collections4.FluentIterable#reverse()   // 迭代器将逆序遍历元素</span><br><span class="line">org.apache.commons.collections4.FluentIterable#skip(int)   // 迭代器跳过第几个元素的遍历</span><br><span class="line">org.apache.commons.collections4.FluentIterable#transform(Transform) // 对迭代器中的元素进行遍历转换</span><br><span class="line">org.apache.commons.collections4.FluentIterable#unique()    // 返回一个唯一元素的视图</span><br><span class="line">org.apache.commons.collections4.FluentIterable#unmodifiable() // 返回一个不可变视图</span><br><span class="line">org.apache.commons.collections4.FluentIterable#zip(java.lang.Iterable&lt;? extends E&gt;...) // 返回一个交替遍历的迭代器</span><br><span class="line">org.apache.commons.collections4.FluentIterable#allMatch(Predicate)  // 返回是否全部匹配</span><br></pre></td></tr></table></figure>

<h2 id="IterableUtils"><a href="#IterableUtils" class="headerlink" title="IterableUtils"></a>IterableUtils</h2><p>迭代器工具类</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">org.apache.commons.collections4.IterableUtils#emptyIterable()   // 返回一个空的迭代器</span><br><span class="line">org.apache.commons.collections4.IterableUtils#chainedIterable(java.lang.Iterable&lt;? extends E&gt;, java.lang.Iterable&lt;? extends E&gt;)  // 结合两个迭代器为一个迭代器</span><br><span class="line">org.apache.commons.collections4.IterableUtils#collatedIterable(java.util.Comparator&lt;? super E&gt;, java.lang.Iterable&lt;? extends E&gt;, java.lang.Iterable&lt;? extends E&gt;) // 结合迭代器的时候进行排序</span><br><span class="line">org.apache.commons.collections4.IterableUtils#filteredIterable(Iterable,Predicate) // 过滤迭代器元素</span><br><span class="line">org.apache.commons.collections4.IterableUtils#boundedIterable(Iterable,int)  // 返回之给定指定数量元素的视图</span><br><span class="line">org.apache.commons.collections4.IterableUtils#forEachButLast(Iterable,Closure) // 就最后一个元素不执行closure，其它元素都执行</span><br><span class="line">org.apache.commons.collections4.IterableUtils#frequency(Iterable,T)    // 返回元素在迭代器中出现的频率</span><br><span class="line">org.apache.commons.collections4.IterableUtils#first()     // 获取第一个元素</span><br></pre></td></tr></table></figure>

<h3 id="ArrayIterator"><a href="#ArrayIterator" class="headerlink" title="ArrayIterator"></a>ArrayIterator</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 创建</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ArrayIterator</span><span class="params">(<span class="keyword">final</span> Object array)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>(array, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 调用</span></span><br></pre></td></tr></table></figure>

<h3 id="ArrayListIterator"><a href="#ArrayListIterator" class="headerlink" title="ArrayListIterator"></a>ArrayListIterator</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ArrayListIterator</span><span class="params">(<span class="keyword">final</span> Object array)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(array);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="FilterIterator"><a href="#FilterIterator" class="headerlink" title="FilterIterator"></a>FilterIterator</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 创建</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">FilterIterator</span><span class="params">(<span class="keyword">final</span> Iterator&lt;? extends E&gt; iterator, <span class="keyword">final</span> Predicate&lt;? <span class="keyword">super</span> E&gt; predicate)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.iterator = iterator;</span><br><span class="line">        <span class="keyword">this</span>.predicate = predicate;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 调用</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">next</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!nextObjectSet &amp;&amp; !setNextObject()) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException();</span><br><span class="line">    &#125;</span><br><span class="line">    nextObjectSet = <span class="keyword">false</span>;</span><br><span class="line">    <span class="keyword">return</span> nextObject;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">setNextObject</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">while</span> (iterator.hasNext()) &#123;</span><br><span class="line">      <span class="keyword">final</span> E object = iterator.next();</span><br><span class="line">      <span class="keyword">if</span> (predicate.evaluate(object)) &#123;</span><br><span class="line">          nextObject = object;</span><br><span class="line">          nextObjectSet = <span class="keyword">true</span>;</span><br><span class="line">          <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ListUtils"><a href="#ListUtils" class="headerlink" title="ListUtils"></a>ListUtils</h2><p>用于操作list工具类</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">org.apache.commons.collections4.ListUtils#intersection(List,List)    // 包含两个集合</span><br><span class="line">org.apache.commons.collections4.ListUtils#subtract(List,List)        // 第一个集合减去第二个集合</span><br><span class="line">org.apache.commons.collections4.ListUtils#lazyList(java.util.List&lt;E&gt;, org.apache.commons.collections4.Factory&lt;? extends E&gt;) // 返回一个惰性的集合，需要的时候在创建</span><br><span class="line">org.apache.commons.collections4.ListUtils#longestCommonSubsequence(java.util.List&lt;E&gt;, java.util.List&lt;E&gt;) // 返回最长的公共子序号</span><br></pre></td></tr></table></figure>

<h2 id="SetUtils"><a href="#SetUtils" class="headerlink" title="SetUtils"></a>SetUtils</h2><p>用于操作set工具类</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">org.apache.commons.collections4.SetUtils#difference(S,S)    // 方法两个Set不同的部分</span><br></pre></td></tr></table></figure>

<h2 id="QueueUtils"><a href="#QueueUtils" class="headerlink" title="QueueUtils"></a>QueueUtils</h2><p>用于操作队列的工具类</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">org.apache.commons.collections4.QueueUtils#unmodifiableQueue(T) // 返回不可变的队列</span><br><span class="line">org.apache.commons.collections4.QueueUtils#predicatedQueue(Q,P) // 返回满足条件的队列</span><br><span class="line">org.apache.commons.collections4.QueueUtils#transformingQueue(Q,T) // 返回进行转换的队列</span><br></pre></td></tr></table></figure>

<h2 id="MapUtils"><a href="#MapUtils" class="headerlink" title="MapUtils"></a>MapUtils</h2><p>用于操作map工具类</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">org.apache.commons.collections4.MapUtils#applyDefaultFunction(java.util.Map&lt;? super K,?&gt;, K, java.util.function.BiFunction&lt;java.util.Map&lt;? super K,?&gt;,K,R&gt;, java.util.function.Function&lt;K,R&gt;)  // 用于获取value时候值为空时候的回调方法</span><br><span class="line">org.apache.commons.collections4.MapUtils#fixedSizeMap(Map)    // 返回一个固定的map</span><br><span class="line">org.apache.commons.collections4.MapUtils#getInteger(java.util.Map&lt;? super K,?&gt;, K) // 获取map值</span><br><span class="line">org.apache.commons.collections4.MapUtils#invertMap()   // 调换key-value的位置</span><br><span class="line">org.apache.commons.collections4.MapUtils#populateMap(java.util.Map&lt;K,V&gt;, java.lang.Iterable&lt;? extends E&gt;, org.apache.commons.collections4.Transformer&lt;E,K&gt;, org.apache.commons.collections4.Transformer&lt;E,V&gt;) // 填充元素</span><br><span class="line"></span><br><span class="line">org.apache.commons.collections4.MapUtils#toMap(ResourceBundle)  // 将ResourceBundle转化为map</span><br><span class="line">org.apache.commons.collections4.MapUtils#toProperties(Map)      // 将map转化为properties</span><br></pre></td></tr></table></figure>

<h3 id="CompositeMap"><a href="#CompositeMap" class="headerlink" title="CompositeMap"></a>CompositeMap</h3><p>用于操作多map</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">CompositeMap</span><span class="params">(<span class="keyword">final</span> Map&lt;K, V&gt; one, <span class="keyword">final</span> Map&lt;K, V&gt; two, <span class="keyword">final</span> MapMutator&lt;K, V&gt; mutator)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>(<span class="keyword">new</span> Map[] &#123; one, two &#125;, mutator);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="FixedSizeMap-1"><a href="#FixedSizeMap-1" class="headerlink" title="FixedSizeMap"></a>FixedSizeMap</h3><p>只能操作固定map</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 添加</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> V <span class="title">put</span><span class="params">(<span class="keyword">final</span> K key, <span class="keyword">final</span> V value)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (map.containsKey(key) == <span class="keyword">false</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">&quot;Cannot put new key/value pair - Map is fixed size&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> map.put(key, value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="DefaultKeyValue"><a href="#DefaultKeyValue" class="headerlink" title="DefaultKeyValue"></a>DefaultKeyValue</h3><p>保存key-value</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 构造</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">DefaultKeyValue</span><span class="params">(<span class="keyword">final</span> K key, <span class="keyword">final</span> V value)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(key, value);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 设置值</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> K <span class="title">setKey</span><span class="params">(<span class="keyword">final</span> K key)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> K old = <span class="keyword">this</span>.key;       <span class="comment">// 引用隔离</span></span><br><span class="line">    <span class="keyword">this</span>.key = key;</span><br><span class="line">    <span class="keyword">return</span> old;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 获取值</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> V <span class="title">getValue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="MultiMapUtils"><a href="#MultiMapUtils" class="headerlink" title="MultiMapUtils"></a>MultiMapUtils</h2><p>操作multiMap的工具类</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">org.apache.commons.collections4.MultiMapUtils#getCollection(Map,T) // 返回value集合</span><br><span class="line">org.apache.commons.collections4.MultiMapUtils#newListValuedHashMap() // 返回集合listValue实现</span><br><span class="line">org.apache.commons.collections4.MultiMapUtils#newSetValuedHashMap()  // 返回集合SetValue实现</span><br></pre></td></tr></table></figure>

<h3 id="MultiKey"><a href="#MultiKey" class="headerlink" title="MultiKey"></a>MultiKey</h3><p>操作多key情况</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 构造</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">MultiKey</span><span class="params">(<span class="keyword">final</span> K key1, <span class="keyword">final</span> K key2)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>(newArray(key1, key2), <span class="keyword">false</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 获取</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> K <span class="title">getKey</span><span class="params">(<span class="keyword">final</span> <span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> keys[index];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="MultiSetUtils"><a href="#MultiSetUtils" class="headerlink" title="MultiSetUtils"></a>MultiSetUtils</h2><p>用于操作MulitSet的工具类</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">org.apache.commons.collections4.MultiSetUtils#unmodifiableMultiSet() // 创建不可变MulitSet</span><br><span class="line">org.apache.commons.collections4.MultiSetUtils#predicatedMultiSet(MultiSet,Predicate) // 创建MuliSet符合Predicate条件的</span><br></pre></td></tr></table></figure>

<h3 id="HashMultiSet"><a href="#HashMultiSet" class="headerlink" title="HashMultiSet"></a>HashMultiSet</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">HashMultiSet</span><span class="params">(<span class="keyword">final</span> Collection&lt;? extends E&gt; coll)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>();</span><br><span class="line">        addAll(coll);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="PredicateUtils"><a href="#PredicateUtils" class="headerlink" title="PredicateUtils"></a>PredicateUtils</h2><p>用于操作断言的工具类</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">org.apache.commons.collections4.PredicateUtils#equalPredicate(T)  // 返回断言的</span><br><span class="line">org.apache.commons.collections4.PredicateUtils#andPredicate(T,T)  // 断言全部成立的</span><br><span class="line">org.apache.commons.collections4.PredicateUtils#orPredicate(T,T)   // 至少一个成立的断言</span><br></pre></td></tr></table></figure>

<h3 id="AllPredicate"><a href="#AllPredicate" class="headerlink" title="AllPredicate"></a>AllPredicate</h3><p>用于操作多个Predicate，如果一个不成功就返回false</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 创建AllPredicate</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="function">Predicate&lt;T&gt; <span class="title">allPredicate</span><span class="params">(<span class="keyword">final</span> Predicate&lt;? <span class="keyword">super</span> T&gt;... predicates)</span> </span>&#123;</span><br><span class="line">    validate(predicates);</span><br><span class="line">    <span class="keyword">if</span> (predicates.length == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> truePredicate();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (predicates.length == <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> coerce(predicates[<span class="number">0</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">		<span class="comment">// copy predicates 的好处是【引用隔离】==&gt;【函数式接口】，避免形参引用改变对后续匿名调用产生了影响</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> AllPredicate&lt;&gt;(FunctorUtils.copy(predicates));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">evaluate</span><span class="params">(<span class="keyword">final</span> T object)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">final</span> Predicate&lt;? <span class="keyword">super</span> T&gt; iPredicate : iPredicates) &#123;</span><br><span class="line">      <span class="keyword">if</span> (!iPredicate.evaluate(object)) &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="AndPredicate"><a href="#AndPredicate" class="headerlink" title="AndPredicate"></a>AndPredicate</h3><p>合并两个predicate的和操作</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 创建AllPredicate</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="function">Predicate&lt;T&gt; <span class="title">andPredicate</span><span class="params">(<span class="keyword">final</span> Predicate&lt;? <span class="keyword">super</span> T&gt; predicate1,</span></span></span><br><span class="line"><span class="function"><span class="params">            <span class="keyword">final</span> Predicate&lt;? <span class="keyword">super</span> T&gt; predicate2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> AndPredicate&lt;&gt;(Objects.requireNonNull(predicate1, <span class="string">&quot;predicate1&quot;</span>),</span><br><span class="line">                Objects.requireNonNull(predicate2, <span class="string">&quot;predicate2&quot;</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">evaluate</span><span class="params">(<span class="keyword">final</span> T object)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> iPredicate1.evaluate(object) &amp;&amp; iPredicate2.evaluate(object);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="AnyPredicate"><a href="#AnyPredicate" class="headerlink" title="AnyPredicate"></a>AnyPredicate</h3><p>任意一个成功就可以</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 创建AnyPredicate</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="function">Predicate&lt;T&gt; <span class="title">anyPredicate</span><span class="params">(<span class="keyword">final</span> Predicate&lt;? <span class="keyword">super</span> T&gt;... predicates)</span> </span>&#123;</span><br><span class="line">        FunctorUtils.validate(predicates);</span><br><span class="line">        <span class="keyword">if</span> (predicates.length == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> FalsePredicate.&lt;T&gt;falsePredicate();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (predicates.length == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> (Predicate&lt;T&gt;) predicates[<span class="number">0</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> AnyPredicate&lt;&gt;(FunctorUtils.copy(predicates));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">evaluate</span><span class="params">(<span class="keyword">final</span> T object)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">final</span> Predicate&lt;? <span class="keyword">super</span> T&gt; iPredicate : iPredicates) &#123;</span><br><span class="line">        <span class="keyword">if</span> (iPredicate.evaluate(object)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ComparatorPredicate"><a href="#ComparatorPredicate" class="headerlink" title="ComparatorPredicate"></a>ComparatorPredicate</h3><p>用于比较的断言</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 创建</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="function">Predicate&lt;T&gt; <span class="title">comparatorPredicate</span><span class="params">(<span class="keyword">final</span> T object, <span class="keyword">final</span> Comparator&lt;T&gt; comparator)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> comparatorPredicate(object, comparator, Criterion.EQUAL);    <span class="comment">// 对象和比较器</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 调用</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">evaluate</span><span class="params">(<span class="keyword">final</span> T target)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">boolean</span> result = <span class="keyword">false</span>;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span> comparison = comparator.compare(object, target);</span><br><span class="line">    <span class="keyword">switch</span> (criterion) &#123;</span><br><span class="line">    <span class="keyword">case</span> EQUAL:</span><br><span class="line">        result = comparison == <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> GREATER:</span><br><span class="line">        result = comparison &gt; <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> LESS:</span><br><span class="line">        result = comparison &lt; <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> GREATER_OR_EQUAL:</span><br><span class="line">        result = comparison &gt;= <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> LESS_OR_EQUAL:</span><br><span class="line">        result = comparison &lt;= <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(<span class="string">&quot;The current criterion &#x27;&quot;</span> + criterion + <span class="string">&quot;&#x27; is invalid.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="TransformerUtils"><a href="#TransformerUtils" class="headerlink" title="TransformerUtils"></a>TransformerUtils</h2><p>用于操作Transformer的工具类</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 常见方法</span></span><br><span class="line">org.apache.commons.collections4.TransformerUtils#chainedTransformer(org.apache.commons.collections4.Transformer&lt;? super T,? extends T&gt;...)  // 构建多个转换</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="ChainedTransformer"><a href="#ChainedTransformer" class="headerlink" title="ChainedTransformer"></a>ChainedTransformer</h3><p>用于操作多个Transformer的执行</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 创建</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="function">Transformer&lt;T, T&gt; <span class="title">chainedTransformer</span><span class="params">(<span class="keyword">final</span> Transformer&lt;? <span class="keyword">super</span> T, ? extends T&gt;... transformers)</span> </span>&#123;</span><br><span class="line">        FunctorUtils.validate(transformers);</span><br><span class="line">        <span class="keyword">if</span> (transformers.length == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> NOPTransformer.&lt;T&gt;nopTransformer();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ChainedTransformer&lt;&gt;(transformers);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 调用</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> T <span class="title">transform</span><span class="params">(T object)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">final</span> Transformer&lt;? <span class="keyword">super</span> T, ? extends T&gt; iTransformer : iTransformers) &#123;</span><br><span class="line">        object = iTransformer.transform(object);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> object;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="CloneTransformer"><a href="#CloneTransformer" class="headerlink" title="CloneTransformer"></a>CloneTransformer</h3><p>用于clone的操作</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> T <span class="title">transform</span><span class="params">(<span class="keyword">final</span> T input)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (input == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> PrototypeFactory.prototypeFactory(input).create();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ClosureTransformer"><a href="#ClosureTransformer" class="headerlink" title="ClosureTransformer"></a>ClosureTransformer</h3><p>用于closure转换</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> T <span class="title">transform</span><span class="params">(<span class="keyword">final</span> T input)</span> </span>&#123;</span><br><span class="line">    iClosure.execute(input);</span><br><span class="line">    <span class="keyword">return</span> input;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="IfTransformer"><a href="#IfTransformer" class="headerlink" title="IfTransformer"></a>IfTransformer</h3><p>用于if…else的转换操作</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> O <span class="title">transform</span><span class="params">(<span class="keyword">final</span> I input)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (iPredicate.evaluate(input))&#123;</span><br><span class="line">        <span class="keyword">return</span> iTrueTransformer.transform(input);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> iFalseTransformer.transform(input);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>apache-common</category>
      </categories>
      <tags>
        <tag>apache-common-collections</tag>
      </tags>
  </entry>
</search>
